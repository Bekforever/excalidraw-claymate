(this["webpackJsonpexcalidraw-claymate"]=this["webpackJsonpexcalidraw-claymate"]||[]).push([[27],{23:function(e){e.exports=JSON.parse('{"labels":{"paste":"Paste","selectAll":"Select all","moveCanvas":"Move canvas","copy":"Copy","copyAsPng":"Copy to clipboard as PNG","copyAsSvg":"Copy to clipboard as SVG","bringForward":"Bring forward","sendToBack":"Send to back","bringToFront":"Bring to front","sendBackward":"Send backward","delete":"Delete","copyStyles":"Copy styles","pasteStyles":"Paste styles","stroke":"Stroke","background":"Background","fill":"Fill","strokeWidth":"Stroke width","strokeStyle":"Stroke style","strokeStyle_solid":"Solid","strokeStyle_dashed":"Dashed","strokeStyle_dotted":"Dotted","sloppiness":"Sloppiness","opacity":"Opacity","textAlign":"Text align","fontSize":"Font size","fontFamily":"Font family","onlySelected":"Only selected","withBackground":"With Background","addWatermark":"Add \\"Made with Excalidraw\\"","handDrawn":"Hand-drawn","normal":"Normal","code":"Code","small":"Small","medium":"Medium","large":"Large","veryLarge":"Very large","solid":"Solid","hachure":"Hachure","crossHatch":"Cross-hatch","thin":"Thin","bold":"Bold","left":"Left","center":"Center","right":"Right","extraBold":"Extra bold","architect":"Architect","artist":"Artist","cartoonist":"Cartoonist","fileTitle":"File title","colorPicker":"Color picker","canvasBackground":"Canvas background","drawingCanvas":"Drawing canvas","layers":"Layers","actions":"Actions","language":"Language","createRoom":"Share a live-collaboration session","duplicateSelection":"Duplicate","untitled":"Untitled","name":"Name","yourName":"Your name","madeWithExcalidraw":"Made with Excalidraw","group":"Group selection","ungroup":"Ungroup selection","collaborators":"Collaborators","toggleGridMode":"Toggle grid mode"},"buttons":{"clearReset":"Reset the canvas","export":"Export","exportToPng":"Export to PNG","exportToSvg":"Export to SVG","copyToClipboard":"Copy to clipboard","copyPngToClipboard":"Copy PNG to clipboard","save":"Save","saveAs":"Save as","load":"Load","getShareableLink":"Get shareable link","close":"Close","selectLanguage":"Select language","scrollBackToContent":"Scroll back to content","zoomIn":"Zoom in","zoomOut":"Zoom out","resetZoom":"Reset zoom","menu":"Menu","done":"Done","edit":"Edit","undo":"Undo","redo":"Redo","roomDialog":"Start live collaboration","createNewRoom":"Create new room","toggleFullScreen":"Toggle full screen","toggleZenMode":"Toggle zen mode","exitZenMode":"Exit zen mode"},"alerts":{"clearReset":"This will clear the whole canvas. Are you sure?","couldNotCreateShareableLink":"Couldn\'t create shareable link.","couldNotLoadInvalidFile":"Couldn\'t load invalid file","importBackendFailed":"Importing from backend failed.","cannotExportEmptyCanvas":"Cannot export empty canvas.","couldNotCopyToClipboard":"Couldn\'t copy to clipboard. Try using Chrome browser.","decryptFailed":"Couldn\'t decrypt data.","uploadedSecurly":"The upload has been secured with end-to-end encryption, which means that Excalidraw server and third parties can\'t read the content."},"toolBar":{"selection":"Selection","draw":"Free draw","rectangle":"Rectangle","diamond":"Diamond","ellipse":"Ellipse","arrow":"Arrow","line":"Line","text":"Text","lock":"Keep selected tool active after drawing"},"headings":{"canvasActions":"Canvas actions","selectedShapeActions":"Selected shape actions","shapes":"Shapes"},"hints":{"linearElement":"Click to start multiple points, drag for single line","freeDraw":"Click and drag, release when you\'re finished","linearElementMulti":"Click on last point or press Escape or Enter to finish","resize":"You can constrain proportions by holding SHIFT while resizing,\\nhold ALT to resize from the center","rotate":"You can constrain angles by holding SHIFT while rotating","lineEditor_info":"Double-click or press Enter to edit points","lineEditor_pointSelected":"Press Delete to remove point or drag to move","lineEditor_nothingSelected":"Select a point to move or remove, or hold Alt and click to add new points"},"errorSplash":{"headingMain_pre":"Encountered an error. Try ","headingMain_button":"reloading the page.","clearCanvasMessage":"If reloading doesn\'t work, try ","clearCanvasMessage_button":"clearing the canvas.","clearCanvasCaveat":" This will result in loss of work ","trackedToSentry_pre":"The error with identifier ","trackedToSentry_post":" was tracked on our system.","openIssueMessage_pre":"We were very cautious not to include your scene information on the error. If your scene is not private, please consider following up on our ","openIssueMessage_button":"bug tracker.","openIssueMessage_post":" Please include information below by copying and pasting into the GitHub issue.","sceneContent":"Scene content:"},"roomDialog":{"desc_intro":"You can invite people to your current scene to collaborate with you.","desc_privacy":"Don\'t worry, the session uses end-to-end encryption, so whatever you draw will stay private. Not even our server will be able to see what you come up with.","button_startSession":"Start session","button_stopSession":"Stop session","desc_inProgressIntro":"Live-collaboration session is now in progress.","desc_persistenceWarning":"Note that the scene data is shared across collaborators in a P2P fashion, and not persisted to our server. Thus, if all of you disconnect, you will lose the data unless you export it to a file or a shareable link.","desc_shareLink":"Share this link with anyone you want to collaborate with:","desc_exitSession":"Stopping the session will disconnect you from the room, but you\'ll be able to continue working with the scene, locally. Note that this won\'t affect other people, and they\'ll still be able to collaborate on their version."},"errorDialog":{"title":"Error"},"shortcutsDialog":{"title":"Keyboard shortcuts","shapes":"Shapes","or":"or","click":"click","drag":"drag","curvedArrow":"Curved arrow","curvedLine":"Curved line","editor":"Editor","view":"View","blog":"Read our blog","howto":"Follow our guides","github":"Found an issue? Submit","textNewLine":"Add new line (text)","textFinish":"Finish editing (text)","zoomToFit":"Zoom to fit all elements"},"encrypted":{"tooltip":"Your drawings are end-to-end encrypted so Excalidraw\'s servers will never see them."},"charts":{"noNumericColumn":"You pasted a spreadsheet without a numeric column.","tooManyColumns":"You pasted a spreadsheet with more than two columns."}}')},24:function(e){e.exports=JSON.parse('{"ar-SA":57,"bg-BG":81,"ca-ES":92,"de-DE":100,"el-GR":98,"en":100,"es-ES":97,"fa-IR":100,"fi-FI":100,"fr-FR":100,"he-IL":94,"hi-IN":100,"hu-HU":58,"id-ID":59,"it-IT":97,"ja-JP":77,"ko-KR":72,"nb-NO":100,"nl-NL":85,"nn-NO":100,"pl-PL":99,"pt-PT":100,"ru-RU":81,"sq-AL":42,"tr-TR":98,"uk-UA":100,"zh-CN":100,"zh-TW":100}')},33:function(e,t,n){var a={"./README.md":[97,7,39],"./ar-SA":[40,3,0],"./ar-SA.json":[40,3,0],"./bg-BG":[41,3,1],"./bg-BG.json":[41,3,1],"./ca-ES":[42,3,2],"./ca-ES.json":[42,3,2],"./de-DE":[43,3,3],"./de-DE.json":[43,3,3],"./el-GR":[44,3,4],"./el-GR.json":[44,3,4],"./en":[23,3],"./en.json":[23,3],"./es-ES":[45,3,5],"./es-ES.json":[45,3,5],"./fa-IR":[46,3,6],"./fa-IR.json":[46,3,6],"./fi-FI":[47,3,7],"./fi-FI.json":[47,3,7],"./fr-FR":[48,3,8],"./fr-FR.json":[48,3,8],"./he-IL":[49,3,9],"./he-IL.json":[49,3,9],"./hi-IN":[50,3,10],"./hi-IN.json":[50,3,10],"./hu-HU":[51,3,11],"./hu-HU.json":[51,3,11],"./id-ID":[52,3,12],"./id-ID.json":[52,3,12],"./it-IT":[53,3,13],"./it-IT.json":[53,3,13],"./ja-JP":[54,3,14],"./ja-JP.json":[54,3,14],"./ko-KR":[55,3,15],"./ko-KR.json":[55,3,15],"./nb-NO":[56,3,16],"./nb-NO.json":[56,3,16],"./nl-NL":[57,3,17],"./nl-NL.json":[57,3,17],"./nn-NO":[58,3,18],"./nn-NO.json":[58,3,18],"./percentages":[24,3],"./percentages.json":[24,3],"./pl-PL":[59,3,19],"./pl-PL.json":[59,3,19],"./pt-PT":[60,3,20],"./pt-PT.json":[60,3,20],"./ru-RU":[61,3,21],"./ru-RU.json":[61,3,21],"./sq-AL":[62,3,22],"./sq-AL.json":[62,3,22],"./tr-TR":[63,3,23],"./tr-TR.json":[63,3,23],"./uk-UA":[64,3,24],"./uk-UA.json":[64,3,24],"./zh-CN":[65,3,25],"./zh-CN.json":[65,3,25],"./zh-TW":[66,3,26],"./zh-TW.json":[66,3,26]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return Promise.all(t.slice(2).map(n.e)).then((function(){return n.t(r,t[1])}))}r.keys=function(){return Object.keys(a)},r.id=33,e.exports=r},34:function(e,t,n){},68:function(e,t,n){e.exports=n(96)},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){},83:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var a,r,o=n(0),i=n.n(o),l=n(13),c=n.n(l),s=(n(73),n(74),n(75),n(76),n(4)),u=n.n(s),d=n(5),m=n(1),p=n(3),h=n(7),f=n(8),g=n(11),v=n(12),b=n(100),y=n(2),E=function(e){return null!=e&&"text"===e.type},w=function(e){return null!=e&&("arrow"===e.type||"line"===e.type||"draw"===e.type)},k=n(9),x=(n(35),Math.PI/12),S="text",C="crosshair",O="grabbing",I="pointer",j=0,T=1,M=-1;!function(e){e.INIT="SCENE_INIT",e.UPDATE="SCENE_UPDATE"}(a||(a={})),function(e){e.COPY="copy",e.PASTE="paste",e.CUT="cut",e.KEYDOWN="keydown",e.KEYUP="keyup",e.MOUSE_MOVE="mousemove",e.RESIZE="resize",e.UNLOAD="unload",e.BLUR="blur",e.DRAG_OVER="dragover",e.DROP="drop",e.GESTURE_END="gestureend",e.BEFORE_UNLOAD="beforeunload",e.GESTURE_START="gesturestart",e.GESTURE_CHANGE="gesturechange",e.POINTER_MOVE="pointermove",e.POINTER_UP="pointerup",e.STATE_CHANGE="statechange",e.WHEEL="wheel",e.TOUCH_START="touchstart",e.TOUCH_END="touchend"}(r||(r={}));var A="test",L="development",D="server-volatile-broadcast",z="server-broadcast",P="App-menu__left",N={1:"Virgil",2:"Helvetica",3:"Cascadia"},R=["selectAll"],B=function(e,t,n,a,r,o){var i,l,c=r-n,s=o-a,u=c*c+s*s,d=-1;0!==u&&(d=((e-n)*c+(t-a)*s)/u),d<0?(i=n,l=a):d>1?(i=r,l=o):(i=n+d*c,l=a+d*s);var m=e-i,p=t-l;return Math.hypot(m,p)},H=function(e,t,n,a,r){return[(e-n)*Math.cos(r)-(t-a)*Math.sin(r)+n,(e-n)*Math.sin(r)+(t-a)*Math.cos(r)+a]},_=function(e,t,n,a,r,o,i,l){var c=Math.cos(a),s=Math.sin(a);return e.e&&e.w?t+=r+i:e.e?(t+=r*(1+c),n+=r*s,t+=i*(1-c),n+=i*-s):e.w&&(t+=r*(1-c),n+=r*-s,t+=i*(1+c),n+=i*s),e.n&&e.s?n+=o+l:e.n?(t+=o*s,n+=o*(1-c),t+=l*-s,n+=l*(1+c)):e.s&&(t+=o*-s,n+=o*(1+c),t+=l*s,n+=l*(1-c)),[t,n]},F=function(e,t,n,a){var r=n-e,o=a-t;return Math.hypot(r,o)},U=function(e){if(e.length>=3){var t=[e[0],e[e.length-1]],n=t[0],a=t[1];return F(n[0],n[1],a[0],a[1])<=10}return!1},W=function(e,t,n){return t[0]<=Math.max(e[0],n[0])&&t[0]>=Math.min(e[0],n[0])&&t[1]<=Math.max(e[1],n[1])&&t[1]>=Math.min(e[1],n[1])},Y=function(e,t,n){var a=(t[1]-e[1])*(n[0]-t[0])-(t[0]-e[0])*(n[1]-t[1]);return 0===a?0:a>0?1:2},G=function(e,t,n,a){var r=Y(e,t,n),o=Y(e,t,a),i=Y(n,a,e),l=Y(n,a,t);return r!==o&&i!==l||(!(0!==r||!W(e,n,t))||(!(0!==o||!W(e,a,t))||(!(0!==i||!W(n,e,a))||!(0!==l||!W(n,t,a)))))},X=function(e,t,n){return n?[Math.round(e/n)*n,Math.round(t/n)*n]:[e,t]},V=n(15),K=function(e,t,n){var a=n.map((function(t){return t[e]})),r=Math.max.apply(Math,Object(y.a)(a)),o=Math.min.apply(Math,Object(y.a)(a)),i=r-o,l=0===i?1:t/i,c=1/0,s=n.map((function(t){return t.map((function(t,n){if(n!==e)return t;var a=t*l;return c=Math.min(a,c),a}))}));if(2===s.length)return s;var u=o-c;return s.map((function(t){return t.map((function(t,n){return n===e?t+u:t}))}))},Z=function(e){return w(e)?Q(e):[e.x,e.y,e.x+e.width,e.y+e.height]},q=function(e){var t=Math.floor(e.width/2)+1,n=e.width,a=Math.floor(e.height/2)+1;return[t,0,n,a,t,e.height,0,a]},J=function(e){var t,n=Object(k.a)(e.sets);try{for(n.s();!(t=n.n()).done;){var a=t.value;if("path"===a.type)return a.ops}}catch(r){n.e(r)}finally{n.f()}return e.sets[0].ops},$=function(e,t){var n=[0,0],a=e.reduce((function(e,a){var r=a.op,o=a.data;if("move"===r)n=o;else if("bcurveTo"===r){var i=[o[0],o[1]],l=[o[2],o[3]],c=[o[4],o[5]],s=n;n=c;for(var u=function(e,t){return Math.pow(1-e,3)*c[t]+3*e*Math.pow(1-e,2)*l[t]+3*Math.pow(e,2)*(1-e)*i[t]+s[t]*Math.pow(e,3)},d=0;d<=1;){var p=u(d,0),h=u(d,1);if(t){var f=t(p,h),g=Object(m.a)(f,2);p=g[0],h=g[1]}e.minY=Math.min(e.minY,h),e.minX=Math.min(e.minX,p),e.maxX=Math.max(e.maxX,p),e.maxY=Math.max(e.maxY,h),d+=.1}}return e}),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return[a.minX,a.minY,a.maxX,a.maxY]},Q=function(e){if(e.points.length<2||!se(e)){var t=e.points.reduce((function(e,t){var n=Object(m.a)(t,2),a=n[0],r=n[1];return e.minY=Math.min(e.minY,r),e.minX=Math.min(e.minX,a),e.maxX=Math.max(e.maxX,a),e.maxY=Math.max(e.maxY,r),e}),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),n=t.minX,a=t.minY,r=t.maxX,o=t.maxY;return[n+e.x,a+e.y,r+e.x,o+e.y]}var i=se(e),l=J(i[0]),c=$(l),s=Object(m.a)(c,4),u=s[0],d=s[1],p=s[2],h=s[3];return[u+e.x,d+e.y,p+e.x,h+e.y]},ee=function(e){var t=Z(e),n=Object(m.a)(t,4),a=n[0],r=n[1],o=n[2],i=n[3],l=(a+o)/2,c=(r+i)/2;if(w(e))return function(e,t,n){if(e.points.length<2||!se(e)){var a=e.points.reduce((function(a,r){var o=Object(m.a)(r,2),i=o[0],l=o[1],c=H(e.x+i,e.y+l,t,n,e.angle),s=Object(m.a)(c,2);return i=s[0],l=s[1],a.minY=Math.min(a.minY,l),a.minX=Math.min(a.minX,i),a.maxX=Math.max(a.maxX,i),a.maxY=Math.max(a.maxY,l),a}),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return[a.minX,a.minY,a.maxX,a.maxY]}var r=se(e),o=J(r[0]);return $(o,(function(a,r){return H(e.x+a,e.y+r,t,n,e.angle)}))}(e,l,c);if("diamond"===e.type){var s=H(l,r,l,c,e.angle),u=Object(m.a)(s,2),d=u[0],p=u[1],h=H(l,i,l,c,e.angle),f=Object(m.a)(h,2),g=f[0],v=f[1],b=H(a,c,l,c,e.angle),y=Object(m.a)(b,2),E=y[0],k=y[1],x=H(o,c,l,c,e.angle),S=Object(m.a)(x,2),C=S[0],O=S[1];return[Math.min(d,g,E,C),Math.min(p,v,k,O),Math.max(d,g,E,C),Math.max(p,v,k,O)]}if("ellipse"===e.type){var I=(o-a)/2,j=(i-r)/2,T=Math.cos(e.angle),M=Math.sin(e.angle),A=Math.hypot(I*T,j*M),L=Math.hypot(j*T,I*M);return[l-A,c-L,l+A,c+L]}var D=H(a,r,l,c,e.angle),z=Object(m.a)(D,2),P=z[0],N=z[1],R=H(a,i,l,c,e.angle),B=Object(m.a)(R,2),_=B[0],F=B[1],U=H(o,i,l,c,e.angle),W=Object(m.a)(U,2),Y=W[0],G=W[1],X=H(o,r,l,c,e.angle),V=Object(m.a)(X,2),K=V[0],q=V[1];return[Math.min(P,_,Y,K),Math.min(N,F,G,q),Math.max(P,_,Y,K),Math.max(N,F,G,q)]},te=function(e){if(!e.length)return[0,0,0,0];var t=1/0,n=-1/0,a=1/0,r=-1/0;return e.forEach((function(e){var o=ee(e),i=Object(m.a)(o,4),l=i[0],c=i[1],s=i[2],u=i[3];t=Math.min(t,l),a=Math.min(a,c),n=Math.max(n,s),r=Math.max(r,u)})),[t,a,n,r]},ne=function(e,t,n){if(!w(e))return[e.x,e.y,e.x+t,e.y+n];var a=K(0,t,K(1,n,e.points)),r=V.a.generator().curve(a,de(e)),o=J(r),i=$(o),l=Object(m.a)(i,4),c=l[0],s=l[1],u=l[2],d=l[3];return[c+e.x,s+e.y,u+e.x,d+e.y]},ae=function(e,t){var n=V.a.generator().curve(t,de(e)),a=J(n),r=$(a),o=Object(m.a)(r,4),i=o[0],l=o[1],c=o[2],s=o[3];return[i+e.x,l+e.y,c+e.x,s+e.y]},re=[12,8],oe=[3,6],ie=function(e,t,n){switch(n.globalAlpha=e.opacity/100,e.type){case"rectangle":case"diamond":case"ellipse":t.draw(se(e));break;case"arrow":case"draw":case"line":se(e).forEach((function(e){t.draw(e)}));break;default:if(!E(e))throw new Error("Unimplemented type ".concat(e.type));var a=Hn(e.text),r=a&&!n.canvas.isConnected;r&&document.body.appendChild(n.canvas),n.canvas.setAttribute("dir",a?"rtl":"ltr");var o=n.font;n.font=Cn(e);var i=n.fillStyle;n.fillStyle=e.strokeColor;var l=n.textAlign;n.textAlign=e.textAlign;for(var c=e.text.replace(/\r\n?/g,"\n").split("\n"),s=e.height/c.length,u=e.height-e.baseline,d="center"===e.textAlign?e.width/2:"right"===e.textAlign?e.width:0,m=0;m<c.length;m++)n.fillText(c[m],d,(m+1)*s-u);n.fillStyle=i,n.font=o,n.textAlign=l,r&&n.canvas.remove()}n.globalAlpha=1},le=new WeakMap,ce=new WeakMap,se=function(e){return ce.get(e)},ue=function(e){return ce.delete(e)},de=function(e){var t={seed:e.seed,strokeLineDash:"dashed"===e.strokeStyle?re:"dotted"===e.strokeStyle?oe:void 0,disableMultiStroke:"solid"!==e.strokeStyle,strokeWidth:"solid"!==e.strokeStyle?e.strokeWidth+.5:e.strokeWidth,fillWeight:e.strokeWidth/2,hachureGap:4*e.strokeWidth,roughness:e.roughness,stroke:e.strokeColor};switch(e.type){case"rectangle":case"diamond":case"ellipse":return t.fillStyle=e.fillStyle,t.fill="transparent"===e.backgroundColor?void 0:e.backgroundColor,"ellipse"===e.type&&(t.curveFitting=1),t;case"line":case"draw":return U(e.points)&&(t.fillStyle=e.fillStyle,t.fill="transparent"===e.backgroundColor?void 0:e.backgroundColor),t;case"arrow":return t;default:throw new Error("Unimplemented type ".concat(e.type))}},me=function(e,t){var n=ce.get(e)||null;if(!n){switch(le.delete(e),e.type){case"rectangle":n=t.rectangle(0,0,e.width,e.height,de(e));break;case"diamond":var a=q(e),r=Object(m.a)(a,8),o=r[0],i=r[1],l=r[2],c=r[3],s=r[4],u=r[5],d=r[6],p=r[7];n=t.polygon([[o,i],[l,c],[s,u],[d,p]],de(e));break;case"ellipse":n=t.ellipse(e.width/2,e.height/2,e.width,e.height,de(e));break;case"line":case"draw":case"arrow":var h=de(e),f=e.points.length?e.points:[[0,0]];if(n=[t.curve(f,h)],"arrow"===e.type){var g,v=function(e,t){var n=J(t[0]),a=n[n.length-1].data,r=[a[4],a[5]],o=[a[2],a[3]],i=[a[0],a[1]],l=n[n.length-2],c=[0,0];"move"===l.op?c=l.data:"bcurveTo"===l.op&&(c=[l.data[4],l.data[5]]);var s=function(e,t){return Math.pow(1-e,3)*r[t]+3*e*Math.pow(1-e,2)*o[t]+3*Math.pow(e,2)*(1-e)*i[t]+c[t]*Math.pow(e,3)},u=r[0],d=r[1],p=[s(.3,0),s(.3,1)],h=p[0],f=p[1],g=Math.hypot(u-h,d-f),v=(u-h)/g,b=(d-f)/g,y=e.points.reduce((function(e,t,n,a){var r=Object(m.a)(t,2),o=r[0],i=r[1],l=n>0?a[n-1]:[0,0],c=Object(m.a)(l,2),s=c[0],u=c[1];return e+Math.hypot(o-s,i-u)}),0),E=Math.min(30,y/2),w=u-v*E,k=d-b*E,x=H(w,k,u,d,-20*Math.PI/180),S=Object(m.a)(x,2),C=S[0],O=S[1],I=H(w,k,u,d,20*Math.PI/180),j=Object(m.a)(I,2);return[u,d,C,O,j[0],j[1]]}(e,n),b=Object(m.a)(v,6),y=b[0],E=b[1],w=b[2],k=b[3],x=b[4],S=b[5];"dotted"===e.strokeStyle?h.strokeLineDash=[3,4]:delete h.strokeLineDash,(g=n).push.apply(g,[t.line(w,k,y,E,h),t.line(x,S,y,E,h)])}break;case"text":n=[]}ce.set(e,n)}},pe=function(e,t){var n=t?t.zoom:1,a=le.get(e),r=a&&a.canvasZoom!==n&&!(null===t||void 0===t?void 0:t.shouldCacheIgnoreZoom);if(!a||r){var o=function(e,t){var n=document.createElement("canvas"),a=n.getContext("2d"),r=0,o=0;if(w(e)){var i=Z(e),l=Object(m.a)(i,4),c=l[0],s=l[1],u=l[2],d=l[3];n.width=Mn(c,u)*window.devicePixelRatio*t+40,n.height=Mn(s,d)*window.devicePixelRatio*t+40,r=e.x>c?Math.floor(Mn(e.x,c))*window.devicePixelRatio:0,o=e.y>s?Math.floor(Mn(e.y,s))*window.devicePixelRatio:0,a.translate(r*t,o*t)}else n.width=e.width*window.devicePixelRatio*t+40,n.height=e.height*window.devicePixelRatio*t+40;a.translate(20,20),a.scale(window.devicePixelRatio*t,window.devicePixelRatio*t);var p=V.a.canvas(n);return ie(e,p,a),a.translate(-20,-20),a.scale(1/(window.devicePixelRatio*t),1/(window.devicePixelRatio*t)),{element:e,canvas:n,canvasZoom:t,canvasOffsetX:r,canvasOffsetY:o}}(e,n);return le.set(e,o),o}return a},he=function(e,t,n,a,r){var o=t.generator;switch(e.type){case"selection":n.translate(e.x+r.scrollX,e.y+r.scrollY);var i=n.fillStyle;n.fillStyle="rgba(0, 0, 255, 0.10)",n.fillRect(0,0,e.width,e.height),n.fillStyle=i,n.translate(-e.x-r.scrollX,-e.y-r.scrollY);break;case"rectangle":case"diamond":case"ellipse":case"line":case"draw":case"arrow":case"text":if(me(e,o),a){!function(e,t,n,a){var r=e.element,o=Z(r),i=Object(m.a)(o,4),l=i[0],c=i[1],s=i[2],u=i[3],d=((l+s)/2+a.scrollX)*window.devicePixelRatio,p=((c+u)/2+a.scrollY)*window.devicePixelRatio;n.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),n.translate(d,p),n.rotate(r.angle),n.drawImage(e.canvas,-(s-l)/2*window.devicePixelRatio-20/e.canvasZoom,-(u-c)/2*window.devicePixelRatio-20/e.canvasZoom,e.canvas.width/e.canvasZoom,e.canvas.height/e.canvasZoom),n.rotate(-r.angle),n.translate(-d,-p),n.scale(window.devicePixelRatio,window.devicePixelRatio)}(pe(e,r),0,n,r)}else{var l=Z(e),c=Object(m.a)(l,4),s=c[0],u=c[1],d=c[2],p=c[3],h=(s+d)/2+r.scrollX,f=(u+p)/2+r.scrollY,g=(d-s)/2-(e.x-s),v=(p-u)/2-(e.y-u);n.translate(h,f),n.rotate(e.angle),n.translate(-g,-v),ie(e,t,n),n.translate(g,v),n.rotate(-e.angle),n.translate(-h,-f)}break;default:throw new Error("Unimplemented type ".concat(e.type))}},fe=function(e,t,n,a,r){var o=Z(e),i=Object(m.a)(o,4),l=i[0],c=i[1],s=i[2],u=i[3],d=(s-l)/2-(e.x-l),p=(u-c)/2-(e.y-c),h=180*e.angle/Math.PI,f=t.generator;switch(e.type){case"selection":throw new Error("Selection rendering is not supported for SVG");case"rectangle":case"diamond":case"ellipse":me(e,f);var g=t.draw(se(e)),v=e.opacity/100;1!==v&&(g.setAttribute("stroke-opacity","".concat(v)),g.setAttribute("fill-opacity","".concat(v))),g.setAttribute("transform","translate(".concat(a||0," ").concat(r||0,") rotate(").concat(h," ").concat(d," ").concat(p,")")),n.appendChild(g);break;case"line":case"draw":case"arrow":me(e,f);var b=n.ownerDocument.createElementNS(yn,"g"),y=e.opacity/100;se(e).forEach((function(n){var o=t.draw(n);1!==y&&(o.setAttribute("stroke-opacity","".concat(y)),o.setAttribute("fill-opacity","".concat(y))),o.setAttribute("transform","translate(".concat(a||0," ").concat(r||0,") rotate(").concat(h," ").concat(d," ").concat(p,")")),"line"!==e.type&&"draw"!==e.type||!U(e.points)||"transparent"===e.backgroundColor||o.setAttribute("fill-rule","evenodd"),b.appendChild(o)})),n.appendChild(b);break;default:if(!E(e))throw new Error("Unimplemented type ".concat(e.type));var w=e.opacity/100,k=n.ownerDocument.createElementNS(yn,"g");1!==w&&(k.setAttribute("stroke-opacity","".concat(w)),k.setAttribute("fill-opacity","".concat(w))),k.setAttribute("transform","translate(".concat(a||0," ").concat(r||0,") rotate(").concat(h," ").concat(d," ").concat(p,")"));for(var x=e.text.replace(/\r\n?/g,"\n").split("\n"),S=e.height/x.length,C=e.height-e.baseline,O="center"===e.textAlign?e.width/2:"right"===e.textAlign?e.width:0,I=Hn(e.text)?"rtl":"ltr",j="center"===e.textAlign?"middle":"right"===e.textAlign||"rtl"===I?"end":"start",T=0;T<x.length;T++){var M=n.ownerDocument.createElementNS(yn,"text");M.textContent=x[T],M.setAttribute("x","".concat(O)),M.setAttribute("y","".concat((T+1)*S-C)),M.setAttribute("font-family",Sn(e)),M.setAttribute("font-size","".concat(e.fontSize,"px")),M.setAttribute("fill",e.strokeColor),M.setAttribute("text-anchor",j),M.setAttribute("style","white-space: pre;"),M.setAttribute("direction",I),k.appendChild(M)}n.appendChild(k)}},ge=n(19),ve=n(29),be=n.n(ve),ye=new ge.a(Date.now()),Ee=function(){return Math.floor(ye.next()*Math.pow(2,31))},we=function(){return be()()},ke=function(e,t){var n=!1,a=t.points;for(var r in"undefined"!==typeof a&&(t=Object(p.a)({},function(e){var t=e.map((function(e){return e[0]})),n=e.map((function(e){return e[1]}));return{width:Math.max.apply(Math,Object(y.a)(t))-Math.min.apply(Math,Object(y.a)(t)),height:Math.max.apply(Math,Object(y.a)(n))-Math.min.apply(Math,Object(y.a)(n))}}(a),{},t)),t){var o=t[r];if("undefined"!==typeof o){if(e[r]===o&&("object"!==typeof o||null===o||"groupIds"===r))continue;if("points"===r){var i=e[r],l=o;if(i.length===l.length){for(var c=!1,s=i.length;--s;){var u=i[s],d=l[s];if(u[0]!==d[0]||u[1]!==d[1]){c=!0;break}}if(!c)continue}}e[r]=o,n=!0}}n&&("undefined"===typeof t.height&&"undefined"===typeof t.width&&"undefined"===typeof a||ue(e),e.version++,e.versionNonce=Ee(),bn.informMutation())},xe=function(e,t){return Object(p.a)({},e,{},t,{version:e.version+1,versionNonce:Ee()})},Se=function(e){return w(e)?e.points.length<2:0===e.width&&0===e.height},Ce=function(e,t,n){var a=Math.abs(t),r=Math.abs(n);if("line"===e||"arrow"===e||"draw"===e){var o=Math.round(Math.atan(r/a)/x)*x;0===o?n=0:o===Math.PI/2?t=0:n=Math.round(a*Math.tan(o))*Math.sign(n)||n}else"selection"!==e&&(n=a*Math.sign(n));return{width:t,height:n}},Oe=function(e){var t={width:e.width,height:e.height,x:e.x,y:e.y};if(e.width<0){var n=Math.abs(e.width);t.width=n,t.x=e.x-n}if(e.height<0){var a=Math.abs(e.height);t.height=a,t.y=e.y-a}return t},Ie=n(14),je=n(10);function Te(e,t,n){var a=n.filter((function(t){return t.groupIds.includes(e)}));return a.length<2?t.selectedGroupIds[e]||t.editingGroupId===e?Object(p.a)({},t,{selectedGroupIds:Object(p.a)({},t.selectedGroupIds,Object(je.a)({},e,!1)),editingGroupId:null}):t:Object(p.a)({},t,{selectedGroupIds:Object(p.a)({},t.selectedGroupIds,Object(je.a)({},e,!0)),selectedElementIds:Object(p.a)({},t.selectedElementIds,{},Object.fromEntries(a.map((function(e){return[e.id,!0]}))))})}function Me(e,t){return!!t.groupIds.filter((function(t){return t!==e.editingGroupId})).find((function(t){return e.selectedGroupIds[t]}))}function Ae(e){return Object.entries(e.selectedGroupIds).filter((function(e){var t=Object(m.a)(e,2);t[0];return t[1]})).map((function(e){var t=Object(m.a)(e,2),n=t[0];t[1];return n}))}function Le(e,t){var n,a=Object(p.a)({},e),r=sn(t,e),o=Object(k.a)(r);try{for(o.s();!(n=o.n()).done;){var i=n.value.groupIds;if(e.editingGroupId){var l=i.indexOf(e.editingGroupId);l>-1&&(i=i.slice(0,l))}if(i.length>0)a=Te(i[i.length-1],a,t)}}catch(c){o.e(c)}finally{o.f()}return a}function De(e,t){return e.groupIds.includes(t)}function ze(e,t){return e.filter((function(e){return De(e,t)}))}function Pe(e,t,n){var a=Object(y.a)(e),r=n?a.indexOf(n):-1,o=r>-1?r:a.length;return a.splice(o,0,t),a}var Ne=function(e,t){var n,a,r=t.x,o=t.y,i=t.strokeColor,l=t.backgroundColor,c=t.fillStyle,s=t.strokeWidth,u=t.strokeStyle,d=t.roughness,m=t.opacity,p=t.width,h=void 0===p?0:p,f=t.height,g=void 0===f?0:f,v=t.angle,b=void 0===v?0:v,y=t.groupIds,E=void 0===y?[]:y,w=Object(Ie.a)(t,["x","y","strokeColor","backgroundColor","fillStyle","strokeWidth","strokeStyle","roughness","opacity","width","height","angle","groupIds"]);return{id:w.id||we(),type:e,x:r,y:o,width:h,height:g,angle:b,strokeColor:i,backgroundColor:l,fillStyle:c,strokeWidth:s,strokeStyle:u,roughness:d,opacity:m,groupIds:E,seed:null!==(n=w.seed)&&void 0!==n?n:Ee(),version:w.version||1,versionNonce:null!==(a=w.versionNonce)&&void 0!==a?a:0,isDeleted:!1}},Re=function(e){return Ne(e.type,e)};function Be(e,t){return{x:"center"===e.textAlign?t.width/2:"right"===e.textAlign?t.width:0,y:"middle"===e.verticalAlign?t.height/2:0}}var He=function(e){var t=On(e.text,Cn(e)),n=Be(e,t);return xe(Object(p.a)({},Ne("text",e),{text:e.text,fontSize:e.fontSize,fontFamily:e.fontFamily,textAlign:e.textAlign,verticalAlign:e.verticalAlign,x:e.x-n.x,y:e.y-n.y,width:t.width,height:t.height,baseline:t.baseline}),{})},_e=function(e,t){var n=t.text,a=t.isDeleted;return xe(e,Object(p.a)({text:n,isDeleted:null!==a&&void 0!==a?a:e.isDeleted},function(e,t){var n,a,r=On(t,Cn(e)),o=r.width,i=r.height,l=r.baseline,c=e.textAlign,s=e.verticalAlign;if("center"===c&&"middle"===s){var u=On(e.text,Cn(e)),d=Be(e,{width:o-u.width,height:i-u.height});n=e.x-d.x,a=e.y-d.y}else{var p=Z(e),h=Object(m.a)(p,4),f=h[0],g=h[1],v=h[2],b=h[3],y=ne(e,o,i),E=Object(m.a)(y,4),w=(f-E[0])/2,k=(g-E[1])/2,x=(v-E[2])/2,S=(b-E[3])/2,C=_({s:!0,e:"center"===c||"left"===c,w:"center"===c||"right"===c},e.x,e.y,e.angle,w,k,x,S),O=Object(m.a)(C,2);n=O[0],a=O[1]}return{width:o,height:i,x:Number.isFinite(n)?n:e.x,y:Number.isFinite(a)?a:e.y,baseline:l}}(e,n)))},Fe=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(null==t||"object"!==typeof t)return t;if("[object Object]"===Object.prototype.toString.call(t)){var a="function"===typeof t.constructor?Object.create(Object.getPrototypeOf(t)):{};for(var r in t)if(t.hasOwnProperty(r)){if(0===n&&("shape"===r||"canvas"===r))continue;a[r]=e(t[r],n+1)}return a}if(Array.isArray(t)){for(var o=t.length,i=new Array(o);o--;)i[o]=e(t[o],n+1);return i}return t},Ue=function(e,t,n,a){var r=Fe(n);return r.id=we(),r.seed=Ee(),r.groupIds=function(e,t,n){for(var a=Object(y.a)(e),r=t?e.indexOf(t):-1,o=r>-1?r:e.length,i=0;i<o;i++)a[i]=n(a[i]);return a}(r.groupIds,e,(function(e){return t.has(e)||t.set(e,we()),t.get(e)})),a&&(r=Object.assign(r,a)),r},We={mouse:8,pen:16,touch:28},Ye={e:!0,s:!0,n:!0,w:!0,rotation:!0},Ge={e:!0,s:!0,n:!0,w:!0},Xe={e:!0,s:!0,n:!0,w:!0,nw:!0,se:!0,rotation:!0},Ve={e:!0,s:!0,n:!0,w:!0,ne:!0,sw:!0,rotation:!0},Ke=function(e,t,n,a,r,o,i){var l=H(e+n/2,t+a/2,r,o,i),c=Object(m.a)(l,2);return[c[0]-n/2,c[1]-a/2,n,a]},Ze=function(e,t,n){var a=Object(m.a)(e,4),r=a[0],o=a[1],i=a[2],l=a[3],c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},u=We[c],d=u/n,p=u/n,h=u/n,f=u/n,g=i-r,v=l-o,b=(r+i)/2,y=(o+l)/2,E=4/n,w=(u-8)/(2*n),k={nw:s.nw?void 0:Ke(r-E-h+w,o-E-f+w,d,p,b,y,t),ne:s.ne?void 0:Ke(i+E-w,o-E-f+w,d,p,b,y,t),sw:s.sw?void 0:Ke(r-E-h+w,l+E-w,d,p,b,y,t),se:s.se?void 0:Ke(i+E-w,l+E-w,d,p,b,y,t),rotation:s.rotation?void 0:Ke(r+g/2-d/2,o-E-f+w-16/n,d,p,b,y,t)},x=5*u/n;return Math.abs(g)>x&&(s.n||(k.n=Ke(r+g/2-d/2,o-E-f+w,d,p,b,y,t)),s.s||(k.s=Ke(r+g/2-d/2,l+E-w,d,p,b,y,t))),Math.abs(v)>x&&(s.w||(k.w=Ke(r-E-h+w,o+v/2-p/2,d,p,b,y,t)),s.e||(k.e=Ke(i+E-w,o+v/2-p/2,d,p,b,y,t))),k},qe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse",a={};if("arrow"===e.type||"line"===e.type||"draw"===e.type){if(2===e.points.length){var r=Object(m.a)(e.points,2),o=r[1];0===o[0]||0===o[1]?a=Ve:o[0]>0&&o[1]<0?a=Xe:o[0]>0&&o[1]>0?a=Ve:o[0]<0&&o[1]>0?a=Xe:o[0]<0&&o[1]<0&&(a=Ve)}}else"text"===e.type&&(a=Ge);return Ze(Z(e),e.angle,t,n,a)},Je=n(16),$e=function(e,t){if("arrow"===e.type)return!1;var n="transparent"!==e.backgroundColor||t.selectedElementIds[e.id];return"line"===e.type||"draw"===e.type?n&&U(e.points):n},Qe=function(e,t,n,a,r){var o=10/r,i=Z(e),l=Object(m.a)(i,4),c=l[0],s=l[1],u=l[2],d=l[3],p=H(n,a,(c+u)/2,(s+d)/2,-e.angle),h=Object(m.a)(p,2);if(n=h[0],a=h[1],"ellipse"===e.type){var f=Math.abs(n-e.x-e.width/2),g=Math.abs(a-e.y-e.height/2),v=.707,b=.707,y=Math.abs(e.width)/2,E=Math.abs(e.height)/2;return[0,1,2,3].forEach((function(e){var t=y*v,n=E*b,a=(y*y-E*E)*Math.pow(v,3)/y,r=(E*E-y*y)*Math.pow(b,3)/E,o=t-a,i=n-r,l=f-a,c=g-r,s=Math.hypot(i,o),u=Math.hypot(c,l);v=Math.min(1,Math.max(0,(l*s/u+a)/y)),b=Math.min(1,Math.max(0,(c*s/u+r)/E));var d=Math.hypot(b,v);v/=d,b/=d})),$e(e,t)?y*v-(f-o)>=0&&E*b-(g-o)>=0:Math.hypot(y*v-f,E*b-g)<o}if("rectangle"===e.type)return $e(e,t)?n>c-o&&n<u+o&&a>s-o&&a<d+o:B(n,a,c,s,u,s)<o||B(n,a,u,s,u,d)<o||B(n,a,u,d,c,d)<o||B(n,a,c,d,c,s)<o;if("diamond"===e.type){n-=e.x,a-=e.y;var k=q(e),x=Object(m.a)(k,8),S=x[0],C=x[1],O=x[2],I=x[3],j=x[4],T=x[5],M=x[6],A=x[7];if($e(e,t)){if(C>T){var L=[C,T];T=L[0],C=L[1]}if(O<M){var D=[O,M];M=D[0],O=D[1]}return T+=o,O+=o,((M-=o)-S)*(a-A)-(M-n)*((C-=o)-A)<=0&&(S-O)*(a-I)-(n-O)*(C-I)<=0&&(O-j)*(a-T)-(n-j)*(I-T)<=0&&(j-M)*(a-A)-(n-M)*(T-A)<=0}return B(n,a,S,C,O,I)<o||B(n,a,O,I,j,T)<o||B(n,a,j,T,M,A)<o||B(n,a,M,A,S,C)<o}if(w(e)){if(!se(e))return!1;var z=se(e);if(n<c-o||a<s-o||n>u+o||a>d+o)return!1;var P=n-e.x,N=a-e.y;if($e(e,t))if(z.some((function(e){return et(e,P,N,o)})))return!0;return z.some((function(e){return tt(e,P,N,o)}))}if("text"===e.type)return n>=c&&n<=u&&a>=s&&a<=d;if("selection"===e.type)return console.warn("This should not happen, we need to investigate why it does."),!1;throw new Error("Unimplemented type ".concat(e.type))},et=function(e,t,n,a){var r,o=J(e),i=[],l=Object(k.a)(o);try{for(l.s();!(r=l.n()).done;){var c=r.value;if("move"===c.op){if(i.length)break;i.push([c.data[0],c.data[1]])}else"bcurveTo"===c.op&&(i.push([c.data[0],c.data[1]]),i.push([c.data[2],c.data[3]]),i.push([c.data[4],c.data[5]]))}}catch(s){l.e(s)}finally{l.f()}return i.length>=4&&function(e,t,n){var a=e.length;if(a<3)return!1;for(var r=[Number.MAX_SAFE_INTEGER,n],o=[t,n],i=0,l=0;l<a;l++){var c=e[l],s=e[(l+1)%a];if(G(c,s,o,r)){if(0===Y(c,o,s))return W(c,o,s);i++}}return i%2===1}(Object(Je.a)(i,10,5),t,n)},tt=function(e,t,n,a){var r=J(e),o=[0,0];return r.some((function(e,r){var i=e.op,l=e.data;if("move"===i)o=l;else if("bcurveTo"===i){var c=[l[0],l[1]],s=[l[2],l[3]],u=[l[4],l[5]],d=o;return o=u,function(e,t,n,a,r,o){for(var i=Object(m.a)(r,2),l=i[0],c=i[1],s=function(r,o){return Math.pow(1-r,3)*a[o]+3*r*Math.pow(1-r,2)*n[o]+3*Math.pow(r,2)*(1-r)*t[o]+e[o]*Math.pow(r,3)},u=0;u<=1;){var d=s(u,0),p=s(u,1);if(Math.sqrt(Math.pow(d-l,2)+Math.pow(p-c,2))<o)return!0;u+=.01}return!1}(d,c,s,u,[t,n],a)}return!1}))},nt=function(e,t,n){return t>=e[0]&&t<=e[0]+e[2]&&n>=e[1]&&n<=e[1]+e[3]},at=function(e,t,n,a,r,o){return e.reduce((function(e,i){if(e)return e;var l=function(e,t,n,a,r,o){if(!t.selectedElementIds[e.id])return!1;var i=qe(e,r,o),l=i.rotation,c=Object(Ie.a)(i,["rotation"]);if(l&&nt(l,n,a))return"rotation";var s=Object.keys(c).filter((function(e){var t=c[e];return!!t&&nt(t,n,a)}));return s.length>0&&s[0]}(i,t,n,a,r,o);return l?{element:i,resizeHandle:l}:null}),null)},rt=function(e,t,n,a,r){var o=Object(m.a)(e,4),i=o[0],l=o[1],c=o[2],s=o[3],u=Ze([i,l,c,s],0,a,r,Ye);return Object.keys(u).find((function(e){var a=u[e];return a&&nt(a,t,n)}))||!1},ot=["ns","nesw","ew","nwse"],it=function(e){var t=e.element,n=e.resizeHandle,a=t&&Math.sign(t.height)*Math.sign(t.width)===-1,r=null;switch(n){case"n":case"s":r="ns";break;case"w":case"e":r="ew";break;case"nw":case"se":r=a?"nesw":"nwse";break;case"ne":case"sw":r=a?"nwse":"nesw";break;case"rotation":return"grab"}return r&&t&&(r=function(e,t){var n=ot.indexOf(e);if(n>=0){var a=Math.round(t/(Math.PI/4));e=ot[(n+a)%ot.length]}return e}(r,t.angle)),r?"".concat(r,"-resize"):""},lt=function(e,t,n,a){var r=Z(e),o=Object(m.a)(r,4),i=o[0],l=o[1],c=(i+o[2])/2,s=(l+o[3])/2,u=5*Math.PI/2+Math.atan2(n-s,t-c);a&&(u+=x/2,u-=u%x),u>=2*Math.PI&&(u-=2*Math.PI),ke(e,{angle:u})},ct=function(e,t,n,a,r){var o=e.points[0],i=e.points[1];if("end"===t)if(n){var l=Ce(e.type,a-e.x,r-e.y),c=l.width,s=l.height;ke(e,{points:[o,[c,s]]})}else ke(e,{points:[o,[a-o[0]-e.x,r-o[1]-e.y]]});else if(n){var u=Ce(e.type,e.x+i[0]-o[0]-a,e.y+i[1]-o[1]-r),d=u.width,m=u.height;ke(e,{x:e.x+i[0]-o[0]-d,y:e.y+i[1]-o[1]-m,points:[o,[d,m]]})}else ke(e,{x:a,y:r,points:[o,[i[0]-(a-o[0]-e.x),i[1]-(r-o[1]-e.y)]]})},st=function(e,t,n){return w(e)?{points:K(0,t,K(1,n,e.points))}:{}},ut=function(e,t,n){var a=Math.min(t/e.width,n/e.height),r=e.fontSize*a,o=On(e.text,Cn({fontSize:r,fontFamily:e.fontFamily}));return o.width-t<1&&o.height-n<1?{size:r,baseline:o.baseline}:(a=Math.min(Math.min(t,o.width)/e.width,Math.min(n,o.height)/e.height),r=e.fontSize*a,(o=On(e.text,Cn({fontSize:r,fontFamily:e.fontFamily}))).width-t<1&&o.height-n<1?{size:r,baseline:o.baseline}:(a*=.99,r=e.fontSize*a,(o=On(e.text,Cn({fontSize:r,fontFamily:e.fontFamily}))).width-t<1&&o.height-n<1?{size:r,baseline:o.baseline}:null))},dt=function(e,t){return{n:/^(n|ne|nw)$/.test(e)||t&&/^(s|se|sw)$/.test(e),s:/^(s|se|sw)$/.test(e)||t&&/^(n|ne|nw)$/.test(e),w:/^(w|nw|sw)$/.test(e)||t&&/^(e|ne|se)$/.test(e),e:/^(e|ne|se)$/.test(e)||t&&/^(w|nw|sw)$/.test(e)}},mt=function(e,t,n,a,r){var o,i=Z(e),l=Object(m.a)(i,4),c=l[0],s=l[1],u=l[2],d=l[3],p=H(a,r,(c+u)/2,(s+d)/2,-e.angle),h=Object(m.a)(p,2),f=h[0],g=h[1];switch(t){case"se":o=Math.max((f-c)/(u-c),(g-s)/(d-s));break;case"nw":o=Math.max((u-f)/(u-c),(d-g)/(d-s));break;case"ne":o=Math.max((f-c)/(u-c),(d-g)/(d-s));break;case"sw":o=Math.max((u-f)/(u-c),(g-s)/(d-s))}if(o>0){var v=e.width*o,b=e.height*o,y=ut(e,v,b);if(null===y)return;var E=ne(e,v,b),w=Object(m.a)(E,4),k=(c-w[0])/2,x=(s-w[1])/2,S=(u-w[2])/2,C=(d-w[3])/2,O=_(dt(t,n),e.x,e.y,e.angle,k,x,S,C),I=Object(m.a)(O,2),j=I[0],T=I[1];ke(e,{fontSize:y.size,width:v,height:b,baseline:y.baseline,x:j,y:T})}},pt=function(e,t,n,a,r,o){var i=Z(e),l=Object(m.a)(i,4),c=l[0],s=l[1],u=l[2],d=l[3],h=H(r,o,(c+u)/2,(s+d)/2,-e.angle),f=Object(m.a)(h,2),g=f[0],v=f[1],b=1,y=1;"e"!==t&&"ne"!==t&&"se"!==t||(b=(g-c)/(u-c)),"s"!==t&&"sw"!==t&&"se"!==t||(y=(v-s)/(d-s)),"w"!==t&&"nw"!==t&&"sw"!==t||(b=(u-g)/(u-c)),"n"!==t&&"nw"!==t&&"ne"!==t||(y=(d-v)/(d-s));var E=e.width*b,k=e.height*y;n&&(E=k=Math.max(E,k));var x=ne(e,E,k),S=Object(m.a)(x,4),C=S[0],O=S[1],I=S[2],j=S[3],T=(c-C)/2,M=(s-O)/2,A=(u-I)/2,L=(d-j)/2,D=st(e,E,k),z=ne(Object(p.a)({},e,{},D),Math.abs(E),Math.abs(k)),P=Object(m.a)(z,4),N=function(e,t,n,a,r,o,i,l,c,s,u,d,m){var p=Math.cos(m),h=Math.sin(m),f=0,g=0;return t<0&&("e"!==e&&"ne"!==e&&"se"!==e||(d?(f+=(s-a)*p,g+=(s-a)*h):f+=s-a),"w"!==e&&"nw"!==e&&"sw"!==e||(d?(f+=(l-o)*p,g+=(l-o)*h):f+=l-o)),n<0&&("s"!==e&&"se"!==e&&"sw"!==e||(d?(g+=(u-r)*p,f+=(u-r)*-h):g+=u-r),"n"!==e&&"ne"!==e&&"nw"!==e||(d?(g+=(c-i)*p,f+=(c-i)*-h):g+=c-i)),[f,g]}(t,E,k,C,O,I,j,P[0],P[1],P[2],P[3],w(e),e.angle),R=Object(m.a)(N,2),B=R[0],F=R[1],U=_(dt(t,a),e.x-B,e.y-F,e.angle,T,M,A,L),W=Object(m.a)(U,2),Y=W[0],G=W[1];0!==E&&0!==k&&Number.isFinite(Y)&&Number.isFinite(G)&&ke(e,Object(p.a)({width:E,height:k,x:Y,y:G},D))},ht=function(e,t,n,a){var r,o,i=te(e),l=Object(m.a)(i,4),c=l[0],s=l[1],u=l[2],d=l[3];switch(t){case"se":r=Math.max((n-c)/(u-c),(a-s)/(d-s)),o=function(e,t,n){var a=Object(m.a)(t,2),o=a[0],i=a[1],l=Object(m.a)(n,2),u=l[0],d=l[1];return{x:e.x+(o-c)*(r-1)+o-u,y:e.y+(i-s)*(r-1)+i-d}};break;case"nw":r=Math.max((u-n)/(u-c),(d-a)/(d-s)),o=function(e,t,n){var a=Object(m.a)(t,4),o=a[2],i=a[3],l=Object(m.a)(n,4),c=l[2],s=l[3];return{x:e.x-(u-o)*(r-1)+o-c,y:e.y-(d-i)*(r-1)+i-s}};break;case"ne":r=Math.max((n-c)/(u-c),(d-a)/(d-s)),o=function(e,t,n){var a=Object(m.a)(t,4),o=a[0],i=a[3],l=Object(m.a)(n,4),s=l[0],u=l[3];return{x:e.x+(o-c)*(r-1)+o-s,y:e.y-(d-i)*(r-1)+i-u}};break;case"sw":r=Math.max((u-n)/(u-c),(a-s)/(d-s)),o=function(e,t,n){var a=Object(m.a)(t,3),o=a[1],i=a[2],l=Object(m.a)(n,3),c=l[1],d=l[2];return{x:e.x-(u-i)*(r-1)+i-d,y:e.y+(o-s)*(r-1)+o-c}}}if(r>0){var h=e.reduce((function(e,t){if(!e)return e;var n=t.width*r,a=t.height*r,i={};if("text"===t.type){var l=ut(t,n,a);if(null===l)return null;i={fontSize:l.size,baseline:l.baseline}}var c=Z(t),s=st(t,n,a),u=ne(Object(p.a)({},t,{},s),n,a),d=o(t,c,u),m=d.x,h=d.y;return[].concat(Object(y.a)(e),[Object(p.a)({width:n,height:a,x:m,y:h},s,{},i)])}),[]);h&&e.forEach((function(e,t){ke(e,h[t])}))}},ft=function(e,t,n,a,r,o,i,l,c,s){if(c){var u=Ce(t,i,o<a?-l:l);i=u.width,(l=u.height)<0&&(l=-l)}var d=r<n?n-i:n,m=o<a?a-l:a;s&&(d=n-(i+=i)/2,m=a-(l+=l)/2),0!==i&&0!==l&&ke(e,{x:d,y:m,width:i,height:l})},gt=/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),vt="ArrowLeft",bt="ArrowRight",yt="ArrowDown",Et="ArrowUp",wt="Enter",kt="Escape",xt="Delete",St="Backspace",Ct=gt?"metaKey":"ctrlKey",Ot="Tab",It=" ",jt="?",Tt=70,Mt=18,At=90,Lt=222,Dt=71,zt=function(e){return e===vt||e===bt||e===yt||e===Et},Pt=function(e){return e.altKey||e.which===Mt},Nt=function(e){return e.shiftKey},Rt=function(e){return e.shiftKey},Bt=function(e){return e.replace(/\t/g,"        ").replace(/\r?\n|\r/g,"\n")},Ht=function(e,t,n,a){var r=180*n/Math.PI;return"translate(".concat(e*(a-1)/2,"px, ").concat(t*(a-1)/2,"px) scale(").concat(a,") rotate(").concat(r,"deg)")},_t=function(e){var t=On(e.text,Cn(e));ke(e,{width:t.width,height:t.height,baseline:t.baseline})},Ft=function(e,t){return Boolean(e.editingElement||sn(t,e).length||"selection"!==e.elementType)},Ut=function(e){return e.reduce((function(e,t){return e[t.id]=t,e}),{})},Wt=function(e){return e.reduce((function(e,t){return e+t.version}),0)},Yt=function(e){return e.filter((function(e){return!e.isDeleted}))},Gt=function(e){return!e.isDeleted},Xt=n(38),Vt=n(23),Kt=n(24),Zt=[{lng:"en",label:"English",data:"en.json"}].concat([{lng:"bg-BG",label:"\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438",data:"bg-BG.json"},{lng:"de-DE",label:"Deutsch",data:"de-DE.json"},{lng:"es-ES",label:"Espa\xf1ol",data:"es-ES.json"},{lng:"ca-ES",label:"Catalan",data:"ca-ES.json"},{lng:"el-GR",label:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",data:"el-GR.json"},{lng:"fr-FR",label:"Fran\xe7ais",data:"fr-FR.json"},{lng:"id-ID",label:"Bahasa Indonesia",data:"id-ID.json"},{lng:"it-IT",label:"Italiano",data:"it-IT.json"},{lng:"hu-HU",label:"Magyar",data:"hu-HU.json"},{lng:"nl-NL",label:"Nederlands",data:"nl-NL.json"},{lng:"nb-NO",label:"Norsk bokm\xe5l",data:"nb-NO.json"},{lng:"nn-NO",label:"Norsk nynorsk",data:"nn-NO.json"},{lng:"pl-PL",label:"Polski",data:"pl-PL.json"},{lng:"pt-PT",label:"Portugu\xeas",data:"pt-PT.json"},{lng:"ru-RU",label:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439",data:"ru-RU.json"},{lng:"uk-UA",label:"\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430",data:"uk-UA.json"},{lng:"fi-FI",label:"Suomi",data:"fi-FI.json"},{lng:"tr-TR",label:"T\xfcrk\xe7e",data:"tr-TR.json"},{lng:"ja-JP",label:"\u65e5\u672c\u8a9e",data:"ja-JP.json"},{lng:"ko-KR",label:"\ud55c\uad6d\uc5b4",data:"ko-KR.json"},{lng:"zh-TW",label:"\u7e41\u9ad4\u4e2d\u6587",data:"zh-TW.json"},{lng:"zh-CN",label:"\u7b80\u4f53\u4e2d\u6587",data:"zh-CN.json"},{lng:"ar-SA",label:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",data:"ar-SA.json",rtl:!0},{lng:"he-IL",label:"\u05e2\u05d1\u05e8\u05d9\u05ea",data:"he-IL.json",rtl:!0},{lng:"hi-IN",label:"\u0939\u093f\u0928\u094d\u0926\u0940",data:"hi-IN.json"}].sort((function(e,t){return e.label>t.label?1:-1}))).filter((function(e){return Kt[e.lng]>85})),qt=Zt[0],Jt={},$t=Zt[0],Qt=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return qt=Zt.find((function(e){return e.lng===t}))||$t,document.documentElement.dir=qt.rtl?"rtl":"ltr",e.next=4,n(33)("./".concat(qt.data));case 4:Jt=e.sent,rn.cacheUserLanguage(qt.lng);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),en=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=rn.detect(),qt=Zt.find((function(e){return e.lng===t}))||$t,document.documentElement.dir=qt.rtl?"rtl":"ltr",e.next=5,n(33)("./".concat(qt.data));case 5:Jt=e.sent,rn.cacheUserLanguage(qt.lng);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),tn=function(){return qt},nn=function(e,t){for(var n=0;n<t.length;++n){var a=t[n];if(void 0===e[a])return;e=e[a]}if("string"===typeof e)return e},an=function(e,t){var n=e.split("."),a=nn(Jt,n)||nn(Vt,n);if(void 0===a)throw new Error("Can't find translation for ".concat(e));if(t)for(var r in t)a=a.replace("{{".concat(r,"}}"),t[r]);return a},rn=new Xt.a;rn.init({languageUtils:{formatLanguageCode:function(e){return e},isWhitelisted:function(){return!0}},checkWhitelist:!1});var on=function(e,t,n,a){var r=a.scrollX,o=a.scrollY,i=a.zoom,l=te(e),c=Object(m.a)(l,4),s=c[0],u=c[1],d=c[2],p=c[3],h=t/i,f=n/i,g=t-h,v=n-f,b={top:parseInt(Rn("sat")),bottom:parseInt(Rn("sab")),left:parseInt(Rn("sal")),right:parseInt(Rn("sar"))},y=tn().rtl,E=g/2-r+b.left,w=v/2-o+b.top,k=E+h-b.right,x=w+f-b.bottom,S=Math.min(s,E),C=Math.min(u,w),O=Math.max(d,k),I=Math.max(p,x);return{horizontal:E===S&&k===O?null:{x:Math.max(b.left,4)+(E-S)/(O-S)*t,y:n-6-Math.max(4,b.bottom),width:(k-E)/(O-S)*t-Math.max(8,b.left+b.right),height:6},vertical:w===C&&x===I?null:{x:y?Math.max(b.left,4):t-6-Math.max(b.right,4),y:(w-C)/(I-C)*n+Math.max(b.top,4),width:6,height:(x-w)/(I-C)*n-Math.max(8,b.top+b.bottom)}}},ln=function(e,t,n){var a=[e.horizontal,e.vertical].map((function(e){return e&&e.x<=t&&t<=e.x+e.width&&e.y<=n&&n<=e.y+e.height})),r=Object(m.a)(a,2);return{isOverHorizontalScrollBar:r[0],isOverVerticalScrollBar:r[1]}},cn=function(e,t){return e.some((function(e){return t.selectedElementIds[e.id]}))},sn=function(e,t){return e.filter((function(e){return t.selectedElementIds[e.id]}))},un=function(e){return Math.floor(e)};var dn=function(e,t,n){if(!e.length)return{scrollX:un(0),scrollY:un(0)};var a=window.devicePixelRatio,r=te(e),o=Object(m.a)(r,4),i=o[0],l=o[1],c=o[2],s=o[3];if(function(e,t,n){var a=Object(m.a)(n,4),r=a[0],o=a[1],i=a[2],l=a[3],c=Nn({sceneX:r,sceneY:o},e,t,window.devicePixelRatio),s=c.x,u=c.y,d=Nn({sceneX:i,sceneY:l},e,t,window.devicePixelRatio),p=d.x,h=d.y;return p-s>window.innerWidth||h-u>window.innerHeight}(t,n,[i,l,c,s])){var u=function(e,t){if(!e.length)return[0,0,0,0];var n=1/0,a=e[0];return e.forEach((function(e){var r=ee(e),o=Object(m.a)(r,4),i=o[0],l=o[1],c=o[2],s=o[3],u=F((i+c)/2,(l+s)/2,t.x,t.y);u<n&&(n=u,a=e)})),ee(a)}(e,Pn({clientX:t.scrollX,clientY:t.scrollY},t,n,a)),d=Object(m.a)(u,4);i=d[0],l=d[1],c=d[2],s=d[3]}var p=(i+c)/2,h=(l+s)/2;return{scrollX:un(window.innerWidth/2-p),scrollY:un(window.innerHeight/2-h)}},mn=function(e){return"rectangle"===e||"ellipse"===e||"diamond"===e||"draw"===e||"line"===e},pn=function(e){return"rectangle"===e||"ellipse"===e||"diamond"===e||"arrow"===e||"draw"===e||"line"===e},hn=function(e){return"text"===e},fn=function(e,t,n,a,r){for(var o=null,i=e.length-1;i>=0;--i)if(!e[i].isDeleted&&Qe(e[i],t,n,a,r)){o=e[i];break}return o},gn=function(e,t){return null===e||null===e.getContext("2d")?{x:0,y:0}:{x:e.width/t/2,y:e.height/t/2}},vn=function(e){var t=parseFloat(e.toFixed(2));return Math.max(.1,Math.min(t,2))},bn=new(function(){function e(){Object(h.a)(this,e),this.callbacks=new Set,this.nonDeletedElements=[],this.elements=[],this.elementsMap={}}return Object(f.a)(e,[{key:"getElementsIncludingDeleted",value:function(){return this.elements}},{key:"getElements",value:function(){return this.nonDeletedElements}},{key:"getElement",value:function(e){return this.elementsMap[e]||null}},{key:"getNonDeletedElement",value:function(e){var t=this.getElement(e);return t&&Gt(t)?t:null}},{key:"replaceAllElements",value:function(e){this.elements=e,this.elementsMap=Ut(e),this.nonDeletedElements=Yt(this.elements),this.informMutation()}},{key:"informMutation",value:function(){for(var e=0,t=Array.from(this.callbacks);e<t.length;e++){(0,t[e])()}}},{key:"addCallback",value:function(e){var t=this;if(this.callbacks.has(e))throw new Error;return this.callbacks.add(e),function(){if(!t.callbacks.has(e))throw new Error;t.callbacks.delete(e)}}}]),e}()),yn="http://www.w3.org/2000/svg",En=null,wn=function(){if(En)return En;var e=new Date,t=e.getFullYear(),n="".concat(e.getMonth()+1).padStart(2,"0"),a="".concat(e.getDate()).padStart(2,"0"),r="".concat(e.getHours()).padStart(2,"0"),o="".concat(e.getMinutes()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a,"-").concat(r).concat(o)},kn=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},xn=function(e){return e instanceof HTMLElement&&"wysiwyg"===e.dataset.type||e instanceof HTMLBRElement||e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement&&("text"===e.type||"number"===e.type)},Sn=function(e){var t=e.fontFamily;return N[t]},Cn=function(e){var t=e.fontSize,n=e.fontFamily;return"".concat(t,"px ").concat(Sn({fontFamily:n}))},On=function(e,t){var n=document.createElement("div"),a=document.body;n.style.position="absolute",n.style.whiteSpace="pre",n.style.font=t,a.appendChild(n),n.innerText=e.split("\n").map((function(e){return e||" "})).join("\n");var r=n.offsetWidth,o=n.offsetHeight,i=document.createElement("span");i.style.display="inline-block",i.style.overflow="hidden",i.style.width="1px",i.style.height="1px",n.appendChild(i);var l=i.offsetTop+i.offsetHeight;return document.body.removeChild(n),{width:r,height:o,baseline:l}},In=function(e,t){var n,a=0,r=function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];n=o,clearTimeout(a),a=window.setTimeout((function(){return e.apply(void 0,o)}),t)};return r.flush=function(){clearTimeout(a),e.apply(void 0,Object(y.a)(n))},r},jn=function(e){var t=window.getSelection();if(t){var n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}},Tn=function(){var e=window.getSelection();e&&e.removeAllRanges()},Mn=function(e,t){return Math.abs(e-t)},An=function(){document.documentElement.style.cursor=""},Ln=function(e){"selection"===e?An():document.documentElement.style.cursor=C},Dn=function(){var e;return"HTML"===(null===(e=document.fullscreenElement)||void 0===e?void 0:e.nodeName)},zn=function(e){var t=/Mac|iPod|iPhone|iPad/.test(window.navigator.platform);return"".concat(t?e.replace(/\bCtrlOrCmd\b/i,"Cmd").replace(/\bAlt\b/i,"Option").replace(/\bDel\b/i,"Delete").replace(/\b(Enter|Return)\b/i,"Enter"):e.replace(/\bCtrlOrCmd\b/i,"Ctrl"))},Pn=function(e,t,n,a){var r=e.clientX,o=e.clientY,i=t.scrollX,l=t.scrollY,c=t.zoom,s=gn(n,a);return{x:s.x+(r-s.x)/c-i,y:s.y+(o-s.y)/c-l}},Nn=function(e,t,n,a){var r=e.sceneX,o=e.sceneY,i=t.scrollX,l=t.scrollY,c=t.zoom,s=gn(n,a);return{x:s.x-(s.x-r-i)*c,y:s.y-(s.y-o-l)*c}},Rn=function(e){return getComputedStyle(document.documentElement).getPropertyValue("--".concat(e))},Bn=new RegExp("^[^".concat("A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02b8\u0300-\u0590\u0800-\u1fff\u2c00-\ufb1c\ufdfe-\ufe6f\ufefd-\uffff","]*[").concat("\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc","]")),Hn=function(e){return Bn.test(e)},_n=function(e){Object(v.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(h.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={hasError:!1,sentryEventId:"",localStorage:""},e}return Object(f.a)(a,[{key:"render",value:function(){return this.state.hasError?this.errorSplash():this.props.children}},{key:"componentDidCatch",value:function(e,t){var n=this;An();for(var a={},r=0,o=Object.entries(Object(p.a)({},localStorage));r<o.length;r++){var i=Object(m.a)(o[r],2),l=i[0],c=i[1];try{a[l]=JSON.parse(c)}catch(e){a[l]=c}}b.b((function(r){r.setExtras(t);var o=b.a(e);n.setState((function(e){return{hasError:!0,sentryEventId:o,localStorage:JSON.stringify(a)}}))}))}},{key:"selectTextArea",value:function(e){e.target!==document.activeElement&&(e.preventDefault(),e.target.select())}},{key:"createGithubIssue",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.prev=1,e.next=4,n.e(32).then(n.bind(null,159));case 4:a=e.sent.default,t=encodeURIComponent(a(this.state.sentryEventId)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:window.open("https://github.com/excalidraw/excalidraw/issues/new?body=".concat(t));case 12:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"errorSplash",value:function(){var e=this;return i.a.createElement("div",{className:"ErrorSplash"},i.a.createElement("div",{className:"ErrorSplash-messageContainer"},i.a.createElement("div",{className:"ErrorSplash-paragraph bigger align-center"},an("errorSplash.headingMain_pre"),i.a.createElement("button",{onClick:function(){return window.location.reload()}},an("errorSplash.headingMain_button"))),i.a.createElement("div",{className:"ErrorSplash-paragraph align-center"},an("errorSplash.clearCanvasMessage"),i.a.createElement("button",{onClick:function(){try{localStorage.clear(),window.location.reload()}catch(e){console.error(e)}}},an("errorSplash.clearCanvasMessage_button")),i.a.createElement("br",null),i.a.createElement("div",{className:"smaller"},i.a.createElement("span",{role:"img","aria-label":"warning"},"\u26a0\ufe0f"),an("errorSplash.clearCanvasCaveat"),i.a.createElement("span",{role:"img","aria-hidden":"true"},"\u26a0\ufe0f"))),i.a.createElement("div",null,i.a.createElement("div",{className:"ErrorSplash-paragraph"},an("errorSplash.trackedToSentry_pre"),this.state.sentryEventId,an("errorSplash.trackedToSentry_post")),i.a.createElement("div",{className:"ErrorSplash-paragraph"},an("errorSplash.openIssueMessage_pre"),i.a.createElement("button",{onClick:function(){return e.createGithubIssue()}},an("errorSplash.openIssueMessage_button")),an("errorSplash.openIssueMessage_post")),i.a.createElement("div",{className:"ErrorSplash-paragraph"},i.a.createElement("div",{className:"ErrorSplash-details"},i.a.createElement("label",null,an("errorSplash.sceneContent")),i.a.createElement("textarea",{rows:5,onPointerDown:this.selectTextArea,readOnly:!0,value:this.state.localStorage}))))))}}]),a}(i.a.Component),Fn=function(){return i.a.createElement("div",{className:"LoadingMessage"},i.a.createElement("span",null,"Loading scene..."))},Un=function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isLoading:!0},e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en();case 2:this.setState({isLoading:!1});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.isLoading?i.a.createElement(Fn,null):this.props.children}}]),n}(i.a.Component),Wn=i.a.createContext(!1),Yn=function(e){var t=e.children,n=Object(o.useRef)();n.current||(n.current=window.matchMedia?window.matchMedia("(max-width: 640px), (max-height: 500px) and (max-width: 1000px)"):{matches:!1,addListener:function(){},removeListener:function(){}});var a=Object(o.useState)(n.current.matches),r=Object(m.a)(a,2),l=r[0],c=r[1];return Object(o.useEffect)((function(){var e=function(){return c(n.current.matches)};return n.current.addListener(e),function(){return n.current.removeListener(e)}}),[]),i.a.createElement(Wn.Provider,{value:l},t)};function Gn(){return Object(o.useContext)(Wn)}var Xn=n(27),Vn=n(6),Kn=function(){return{isLoading:!1,errorMessage:null,draggingElement:null,resizingElement:null,multiElement:null,editingElement:null,editingLinearElement:null,elementType:"selection",elementLocked:!1,exportBackground:!0,shouldAddWatermark:!1,currentItemStrokeColor:Vn.black,currentItemBackgroundColor:"transparent",currentItemFillStyle:"hachure",currentItemStrokeWidth:1,currentItemStrokeStyle:"solid",currentItemRoughness:1,currentItemOpacity:100,currentItemFontSize:20,currentItemFontFamily:1,currentItemTextAlign:"left",viewBackgroundColor:Vn.white,scrollX:0,scrollY:0,cursorX:0,cursorY:0,cursorButton:"up",scrolledOutside:!1,name:"".concat(an("labels.untitled"),"-").concat(wn()),username:"",isCollaborating:!1,isResizing:!1,isRotating:!1,selectionElement:null,zoom:1,openMenu:null,lastPointerDownWith:"mouse",selectedElementIds:{},previousSelectedElementIds:{},collaborators:new Map,shouldCacheIgnoreZoom:!1,showShortcutsDialog:!1,zenModeEnabled:!1,gridSize:null,editingGroupId:null,selectedGroupIds:{}}},Zn=function(e){return{viewBackgroundColor:e.viewBackgroundColor,gridSize:e.gridSize}},qn=function(e,t,n,a,r,o){e.beginPath(),e.moveTo(t+o,n),e.lineTo(t+a-o,n),e.quadraticCurveTo(t+a,n,t+a,n+o),e.lineTo(t+a,n+r-o),e.quadraticCurveTo(t+a,n+r,t+a-o,n+r),e.lineTo(t+o,n+r),e.quadraticCurveTo(t,n+r,t,n+r-o),e.lineTo(t,n+o),e.quadraticCurveTo(t,n,t+o,n),e.closePath(),e.fill(),e.stroke()},Jn=function(e){return[Vn.red[e],Vn.pink[e],Vn.grape[e],Vn.violet[e],Vn.indigo[e],Vn.blue[e],Vn.cyan[e],Vn.teal[e],Vn.green[e],Vn.lime[e],Vn.yellow[e],Vn.orange[e]]},$n={canvasBackground:[Vn.white,Vn.gray[0],Vn.gray[1]].concat(Object(y.a)(Jn(0))),elementBackground:["transparent",Vn.gray[4],Vn.gray[6]].concat(Object(y.a)(Jn(6))),elementStroke:[Vn.black,Vn.gray[8],Vn.gray[7]].concat(Object(y.a)(Jn(9)))},Qn=function(e){var t=e.split("").reduce((function(e,t){return e+t.charCodeAt(0)}),0),n=$n.elementBackground.slice(1),a=$n.elementStroke.slice(1);return{background:n[t%n.length],stroke:a[t%a.length]}},ea=function(){function e(t){Object(h.a)(this,e),this.elementId=void 0,this.activePointIndex=void 0,this.draggingElementPointIndex=void 0,this.lastUncommittedPoint=void 0,e.normalizePoints(t),this.elementId=t.id,this.activePointIndex=null,this.lastUncommittedPoint=null,this.draggingElementPointIndex=null}return Object(f.a)(e,null,[{key:"getElement",value:function(e){var t=bn.getNonDeletedElement(e);return t||null}},{key:"handlePointDragging",value:function(t,n,a,r,o,i){var l,c;if(!t.editingLinearElement)return!1;var s=t.editingLinearElement,u=s.draggingElementPointIndex,d=s.elementId,h=e.getElement(d);if(!h)return!1;var f=null!==(l=u)&&void 0!==l?l:e.getPointIndexUnderCursor(h,t.zoom,a,r);if((u=null!==(c=u)&&void 0!==c?c:f)>-1){s.draggingElementPointIndex===u&&s.activePointIndex===f||n({editingLinearElement:Object(p.a)({},s,{draggingElementPointIndex:u,activePointIndex:f})});var g=H(a-o,r-i,0,0,-h.angle),v=Object(m.a)(g,2),b=v[0],y=v[1],E=h.points[f];return e.movePoint(h,f,[E[0]+b,E[1]+y]),!0}return!1}},{key:"handlePointerUp",value:function(t){var n=t.elementId,a=t.draggingElementPointIndex,r=e.getElement(n);return r?(null===a||0!==a&&a!==r.points.length-1||!U(r.points)||e.movePoint(r,a,0===a?r.points[r.points.length-1]:r.points[0]),null!==a?Object(p.a)({},t,{draggingElementPointIndex:null}):t):t}},{key:"handlePointerDown",value:function(t,n,a,r,o,i){var l={didAddPoint:!1,hitElement:null};if(!n.editingLinearElement)return l;var c=n.editingLinearElement.elementId,s=e.getElement(c);if(!s)return l;if(t.altKey)return n.editingLinearElement.lastUncommittedPoint||ke(s,{points:[].concat(Object(y.a)(s.points),[e.createPointAt(s,o,i)])}),r.resumeRecording(),a({editingLinearElement:Object(p.a)({},n.editingLinearElement,{activePointIndex:s.points.length-1,lastUncommittedPoint:null})}),l.didAddPoint=!0,l;var u=e.getPointIndexUnderCursor(s,n.zoom,o,i);return u>-1&&(l.hitElement=s),a({editingLinearElement:Object(p.a)({},n.editingLinearElement,{activePointIndex:u>-1?u:null})}),l}},{key:"handlePointerMove",value:function(t,n,a,r){var o=r.elementId,i=r.lastUncommittedPoint,l=e.getElement(o);if(!l)return r;var c=l.points,s=c[c.length-1];if(!t.altKey)return s===i&&e.movePoint(l,c.length-1,"delete"),r;var u=e.createPointAt(l,n,a);return s===i?e.movePoint(l,l.points.length-1,u):e.movePoint(l,"new",u),Object(p.a)({},r,{lastUncommittedPoint:l.points[l.points.length-1]})}},{key:"getPointsGlobalCoordinates",value:function(e){var t=Z(e),n=Object(m.a)(t,4),a=n[0],r=n[1],o=n[2],i=n[3],l=(a+o)/2,c=(r+i)/2;return e.points.map((function(t){var n=e.x,a=e.y,r=H(n+t[0],a+t[1],l,c,e.angle),o=Object(m.a)(r,2);return[n=o[0],a=o[1]]}))}},{key:"getPointIndexUnderCursor",value:function(e,t,n,a){for(var r=this.getPointsGlobalCoordinates(e),o=r.length;--o>-1;){var i=r[o];if(F(n,a,i[0],i[1])*t<this.POINT_HANDLE_SIZE/2+1)return o}return-1}},{key:"createPointAt",value:function(e,t,n){var a=Z(e),r=Object(m.a)(a,4),o=r[0],i=r[1],l=r[2],c=r[3],s=H(t,n,(o+l)/2,(i+c)/2,-e.angle),u=Object(m.a)(s,2),d=u[0],p=u[1];return[d-e.x,p-e.y]}},{key:"normalizePoints",value:function(e){var t=e.points,n=t[0][0],a=t[0][1];ke(e,{points:t.map((function(e,t){return[e[0]-n,e[1]-a]})),x:e.x+n,y:e.y+a})}},{key:"movePoint",value:function(e,t,n){var a,r=e.points,o=0,i=0;if("delete"===n){if("new"===t)throw new Error("invalid args in movePoint");(a=r.slice()).splice(t,1),0===t&&(o=a[0][0],i=a[0][1],a=a.map((function(e,t){return 0===t?[0,0]:[e[0]-o,e[1]-i]})))}else if("new"===t)a=[].concat(Object(y.a)(r),[n]);else{var l=n[0]-r[t][0],c=n[1]-r[t][1];a=r.map((function(e,n){return n===t?0===n?(o=l,i=c,e):(o=0,i=0,[e[0]+l,e[1]+c]):o||i?[e[0]-o,e[1]-i]:e}))}var s=ae(e,a),u=ae(e,r),d=(s[0]+s[2])/2,m=(s[1]+s[3])/2,p=(u[0]+u[2])/2,h=(u[1]+u[3])/2,f=H(o,i,p-d,h-m,e.angle);ke(e,{points:a,x:e.x+f[0],y:e.y+f[1]})}}]),e}();ea.POINT_HANDLE_SIZE=20;var ta=function(e,t,n,a,r,o,i,l,c){e.translate(o,i),e.rotate(l),c&&e.fillRect(t-o,n-i,a,r),e.strokeRect(t-o,n-i,a,r),e.rotate(-l),e.translate(-o,-i)},na=function(e,t,n,a,r){e.beginPath(),e.arc(t+a/2,n+r/2,a/2,0,2*Math.PI),e.fill(),e.stroke()},aa=function(e,t,n,a,r,o){var i=e.strokeStyle;e.strokeStyle="rgba(0,0,0,0.1)",e.beginPath();for(var l=n;l<n+r+2*t;l+=t)e.moveTo(l,a-t),e.lineTo(l,a+o+2*t);for(var c=a;c<a+o+2*t;c+=t)e.moveTo(n-t,c),e.lineTo(n+r+2*t,c);e.stroke(),e.strokeStyle=i},ra=function(e,t,n,a){e.translate(n.scrollX,n.scrollY);var r=e.strokeStyle,o=e.lineWidth;e.lineWidth=1/n.zoom,ea.getPointsGlobalCoordinates(a).forEach((function(a,r){var o;e.strokeStyle="red",e.setLineDash([]),e.fillStyle=(null===(o=t.editingLinearElement)||void 0===o?void 0:o.activePointIndex)===r?"rgba(255, 127, 127, 0.9)":"rgba(255, 255, 255, 0.9)";var i=ea.POINT_HANDLE_SIZE;na(e,a[0]-i/2/n.zoom,a[1]-i/2/n.zoom,i/n.zoom,i/n.zoom)})),e.setLineDash([]),e.lineWidth=o,e.translate(-n.scrollX,-n.scrollY),e.strokeStyle=r},oa=function(e,t,n,a,r,o,i){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},c=l.renderScrollbars,s=void 0===c||c,u=l.renderSelection,d=void 0===u||u,p=l.renderOptimizations,h=void 0!==p&&p,f=l.renderGrid,g=void 0===f||f;if(!o)return{atLeastOneVisibleElement:!1};var v=o.getContext("2d");v.scale(a,a);var b=o.width/a,E=o.height/a;if("string"===typeof i.viewBackgroundColor){var x="transparent"===i.viewBackgroundColor||5===i.viewBackgroundColor.length||9===i.viewBackgroundColor.length||/(hsla|rgba)\(/.test(i.viewBackgroundColor);x&&v.clearRect(0,0,b,E);var S=v.fillStyle;v.fillStyle=i.viewBackgroundColor,v.fillRect(0,0,b,E),v.fillStyle=S}else v.clearRect(0,0,b,E);var C=-b*(i.zoom-1)/2,O=-E*(i.zoom-1)/2;v.translate(C,O),v.scale(i.zoom,i.zoom),g&&t.gridSize&&aa(v,t.gridSize,-Math.ceil(C/i.zoom/t.gridSize)*t.gridSize+i.scrollX%t.gridSize,-Math.ceil(O/i.zoom/t.gridSize)*t.gridSize+i.scrollY%t.gridSize,b/i.zoom,E/i.zoom);var I,j=e.filter((function(e){return ia(e,b,E,i)}));if(j.forEach((function(e){he(e,r,v,h,i),w(e)&&t.editingLinearElement&&t.editingLinearElement.elementId===e.id&&ra(v,t,i,e)})),n&&he(n,r,v,h,i),d&&!t.multiElement&&!t.editingLinearElement){v.translate(i.scrollX,i.scrollY);var T=e.reduce((function(e,n){var a=[];if(t.selectedElementIds[n.id]&&!Me(t,n)&&a.push(Vn.black),i.remoteSelectedElementIds[n.id]&&a.push.apply(a,Object(y.a)(i.remoteSelectedElementIds[n.id].map((function(e){return Qn(e).background})))),a.length){var r=Z(n),o=Object(m.a)(r,4),l=o[0],c=o[1],s=o[2],u=o[3];e.push({angle:n.angle,elementX1:l,elementY1:c,elementX2:s,elementY2:u,selectionColors:a})}return e}),[]);function M(t){var n=ze(e,t),a=te(n),r=Object(m.a)(a,4),o=r[0],i=r[1],l=r[2],c=r[3];T.push({angle:0,elementX1:o,elementX2:l,elementY1:i,elementY2:c,selectionColors:[Vn.black]})}var A,L=Object(k.a)(Ae(t));try{for(L.s();!(A=L.n()).done;){var D=A.value;M(D)}}catch(ve){L.e(ve)}finally{L.f()}t.editingGroupId&&M(t.editingGroupId),T.forEach((function(e){var t=e.angle,n=e.elementX1,a=e.elementY1,r=e.elementX2,o=e.elementY2,l=e.selectionColors,c=r-n,s=o-a,u=v.getLineDash(),d=v.lineWidth,m=v.lineDashOffset,p=v.strokeStyle,h=4/i.zoom,f=8/i.zoom,g=4/i.zoom;v.lineWidth=1/i.zoom;for(var b=l.length,y=0;y<b;++y)v.strokeStyle=l[y],v.setLineDash([f,g+(f+g)*(b-1)]),v.lineDashOffset=(f+g)*y,ta(v,n-h,a-h,c+2*h,s+2*h,n+c/2,a+s/2,t);v.lineDashOffset=m,v.strokeStyle=p,v.lineWidth=d,v.setLineDash(u)})),v.translate(-i.scrollX,-i.scrollY);var z=sn(e,t);if(1===z.length){v.translate(i.scrollX,i.scrollY),v.fillStyle=Vn.white;var P=qe(z[0],i.zoom);Object.keys(P).forEach((function(e){var t=P[e];if(void 0!==t){var n=v.lineWidth;v.lineWidth=1/i.zoom,"rotation"===e?na(v,t[0],t[1],t[2],t[3]):ta(v,t[0],t[1],t[2],t[3],t[0]+t[2]/2,t[1]+t[3]/2,z[0].angle,!0),v.lineWidth=n}})),v.translate(-i.scrollX,-i.scrollY)}else if(z.length>1){var N=4/i.zoom;v.translate(i.scrollX,i.scrollY),v.fillStyle=Vn.white;var R=te(z),B=Object(m.a)(R,4),H=B[0],_=B[1],F=B[2],U=B[3],W=v.getLineDash();v.setLineDash([2/i.zoom]);var Y=v.lineWidth;v.lineWidth=1/i.zoom,ta(v,H-N,_-N,F-H+2*N,U-_+2*N,(H+F)/2,(_+U)/2,0),v.lineWidth=Y,v.setLineDash(W);var G=Ze([H,_,F,U],0,i.zoom,void 0,Ye);Object.keys(G).forEach((function(e){var t=G[e];if(void 0!==t){var n=v.lineWidth;v.lineWidth=1/i.zoom,ta(v,t[0],t[1],t[2],t[3],t[0]+t[2]/2,t[1]+t[3]/2,0,!0),v.lineWidth=n}})),v.translate(-i.scrollX,-i.scrollY)}}for(var X in v.scale(1/i.zoom,1/i.zoom),v.translate(-C,-O),i.remotePointerViewportCoords){var V=i.remotePointerViewportCoords[X],K=V.x,q=V.y,J=i.remotePointerUsernames[X],$=9,Q=14,ee=K<0||K>b-$||q<0||q>E-Q;K=Math.max(K,0),K=Math.min(K,b-$),q=Math.max(q,0),q=Math.min(q,E-Q);var ne=Qn(X),ae=ne.background,re=ne.stroke,oe=v.strokeStyle,ie=v.fillStyle,le=v.globalAlpha;if(v.strokeStyle=re,v.fillStyle=ae,ee&&(v.globalAlpha=.2),i.remotePointerButton&&"down"===i.remotePointerButton[X]&&(v.beginPath(),v.arc(K,q,15,0,2*Math.PI,!1),v.lineWidth=3,v.strokeStyle="#ffffff88",v.stroke(),v.closePath(),v.beginPath(),v.arc(K,q,15,0,2*Math.PI,!1),v.lineWidth=1,v.strokeStyle=re,v.stroke(),v.closePath()),v.beginPath(),v.moveTo(K,q),v.lineTo(K+1,q+14),v.lineTo(K+4,q+9),v.lineTo(K+9,q+10),v.lineTo(K,q),v.fill(),v.stroke(),!ee&&J){var ce=K+$,se=q+Q,ue=4,de=4,me=v.measureText(J),pe=me.actualBoundingBoxDescent+me.actualBoundingBoxAscent;v.fillStyle=re,v.globalAlpha=le,v.fillRect(ce-1,se-1,me.width+2*ue+2,pe+2*de+2),v.fillStyle=ae,v.fillRect(ce,se,me.width+2*ue,pe+2*de),v.fillStyle=Vn.white,v.fillText(J,ce+ue,se+de+me.actualBoundingBoxAscent)}v.strokeStyle=oe,v.fillStyle=ie,v.globalAlpha=le,v.closePath()}if(s){I=on(e,b,E,i);var fe=v.fillStyle,ge=v.strokeStyle;v.fillStyle="rgba(0,0,0,0.3)",v.strokeStyle="rgba(255,255,255,0.8)",[I.horizontal,I.vertical].forEach((function(e){e&&qn(v,e.x,e.y,e.width,e.height,3)})),v.fillStyle=fe,v.strokeStyle=ge}return v.scale(1/a,1/a),{atLeastOneVisibleElement:j.length>0,scrollBars:I}},ia=function(e,t,n,a){var r=a.scrollX,o=a.scrollY,i=a.zoom,l=ee(e),c=Object(m.a)(l,4),s=c[0],u=c[1],d=c[2],p=c[3],h=t/i,f=n/i,g=t-h,v=n-f;return d+r-g/2>=0&&s+r-g/2<=h&&p+o-v/2>=0&&u+o-v/2<=f},la=function(e,t,n){var a=n.exportBackground,r=n.exportPadding,o=void 0===r?10:r,i=n.viewBackgroundColor,l=n.scale,c=void 0===l?1:l,s=n.shouldAddWatermark,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e,t){var n=document.createElement("canvas");return n.width=e*c,n.height=t*c,n};return function(){var n=e;if(s){var r=te(e),l=Object(m.a)(r,4),d=l[2],p=l[3];n=[].concat(Object(y.a)(n),[sa(d,p)])}var h=te(n),f=Object(m.a)(h,4),g=f[0],v=f[1],b=f[2],E=f[3],w=Mn(g,b)+2*o,k=Mn(v,E)+o+(s?0:o),x=u(w,k);return oa(n,t,null,c,V.a.canvas(x),x,{viewBackgroundColor:a?i:null,scrollX:un(-g+o),scrollY:un(-v+o),zoom:1,remotePointerViewportCoords:{},remoteSelectedElementIds:{},shouldCacheIgnoreZoom:!1,remotePointerUsernames:{}},{renderScrollbars:!1,renderSelection:!1,renderOptimizations:!1,renderGrid:!1}),x}()},ca=function(e,t){var n=t.exportBackground,a=t.exportPadding,r=void 0===a?10:a,o=t.viewBackgroundColor,i=t.shouldAddWatermark,l=e;if(i){var c=te(e),s=Object(m.a)(c,4),u=s[2],d=s[3];l=[].concat(Object(y.a)(l),[sa(u,d)])}var p=te(l),h=Object(m.a)(p,4),f=h[0],g=h[1],v=h[2],b=h[3],E=Mn(f,v)+2*r,w=Mn(g,b)+r+(i?0:r),k=document.createElementNS(yn,"svg");if(k.setAttribute("version","1.1"),k.setAttribute("xmlns",yn),k.setAttribute("viewBox","0 0 ".concat(E," ").concat(w)),k.innerHTML="\n  ".concat("\x3c!-- svg-source:excalidraw --\x3e",'\n  <defs>\n    <style>\n      @font-face {\n        font-family: "Virgil";\n        src: url("https://excalidraw.com/FG_Virgil.woff2");\n      }\n      @font-face {\n        font-family: "Cascadia";\n        src: url("https://excalidraw.com/Cascadia.woff2");\n      }\n    </style>\n  </defs>\n  '),n&&o){var x=k.ownerDocument.createElementNS(yn,"rect");x.setAttribute("x","0"),x.setAttribute("y","0"),x.setAttribute("width","".concat(E)),x.setAttribute("height","".concat(w)),x.setAttribute("fill",o),k.appendChild(x)}return function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=a.offsetX,o=void 0===r?0:r,i=a.offsetY,l=void 0===i?0:i;n&&e.forEach((function(e){e.isDeleted||fe(e,t,n,e.x+o,e.y+l)}))}(l,V.a.svg(k),k,{offsetX:-f+r,offsetY:-g+r}),k},sa=function(e,t){return He({text:an("labels.madeWithExcalidraw"),fontSize:16,fontFamily:1,textAlign:"right",verticalAlign:"top",x:e,y:t+16,strokeColor:Vn.gray[5],backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,opacity:100})},ua=n(18);function da(e){var t=/^[$\u20ac\xa3\xa5\u20a9]?([0-9]+(\.[0-9]+)?)$/.exec(e);return t?parseFloat(t[1]):null}function ma(e,t){return e.slice(1).every((function(e){return null!==da(e[t])}))}function pa(e){var t=e[0].length;if(t>2)return{type:"malformed spreadsheet",error:an("charts.tooManyColumns")};if(1===t){if(!ma(e,0))return{type:"not a spreadsheet"};var n=null===da(e[0][0]),a=(n?e.slice(1):e).map((function(e){return da(e[0])}));return a.length<2?{type:"not a spreadsheet"}:{type:"spreadsheet",spreadsheet:{yAxisLabel:n?e[0][0]:null,labels:null,values:a}}}var r=ma(e,0)?0:1;if(!ma(e,r))return{type:"malformed spreadsheet",error:an("charts.noNumericColumn")};var o=(r+1)%2,i=null===da(e[0][r]),l=i?e.slice(1):e;return l.length<2?{type:"not a spreadsheet"}:{type:"spreadsheet",spreadsheet:{yAxisLabel:i?e[0][r]:null,labels:l.map((function(e){return e[o]})),values:l.map((function(e){return da(e[r])}))}}}function ha(e){var t=e.trim().split("\n").map((function(e){return e.trim().split("\t")}));if(0===t.length)return{type:"not a spreadsheet"};var n=t[0].length;if(!t.every((function(e){return e.length===n})))return{type:"not a spreadsheet"};var a=pa(t);if("spreadsheet"!==a.type){var r=pa(function(e){for(var t=[],n=0;n<e[0].length;n++){for(var a=[],r=0;r<e.length;r++)a.push(e[r][n]);t.push(a)}return t}(t));if("spreadsheet"===r.type)return r}return a}function fa(e,t,n,a){var r,o=Math.max.apply(Math,Object(y.a)(t.values)),i=Math.min.apply(Math,[0].concat(Object(y.a)(t.values))),l=o-i,c=He({x:n,y:a+192,strokeColor:e.currentItemStrokeColor,backgroundColor:e.currentItemBackgroundColor,fillStyle:e.currentItemFillStyle,strokeWidth:e.currentItemStrokeWidth,strokeStyle:e.currentItemStrokeStyle,roughness:e.currentItemRoughness,opacity:e.currentItemOpacity,text:i.toLocaleString(),fontSize:16,fontFamily:e.currentItemFontFamily,textAlign:e.currentItemTextAlign,verticalAlign:"top"}),s=He({x:n,y:a,strokeColor:e.currentItemStrokeColor,backgroundColor:e.currentItemBackgroundColor,fillStyle:e.currentItemFillStyle,strokeWidth:e.currentItemStrokeWidth,strokeStyle:e.currentItemStrokeStyle,roughness:e.currentItemRoughness,opacity:e.currentItemOpacity,text:o.toLocaleString(),fontSize:16,fontFamily:e.currentItemFontFamily,textAlign:e.currentItemTextAlign,verticalAlign:"top"}),u=t.values.map((function(t,r){var o=192*((t-i)/l);return Re({type:"rectangle",x:44*r+36+n,y:192-o+a,width:32,height:o,strokeColor:e.currentItemStrokeColor,backgroundColor:e.currentItemBackgroundColor,fillStyle:e.currentItemFillStyle,strokeWidth:e.currentItemStrokeWidth,strokeStyle:e.currentItemStrokeStyle,roughness:e.currentItemRoughness,opacity:e.currentItemOpacity})})),d=(null===(r=t.labels)||void 0===r?void 0:r.map((function(t,r){var o=44*r+36+12;return He({text:t.length>8?"".concat(t.slice(0,5),"..."):t,x:n+o,y:a+204,strokeColor:e.currentItemStrokeColor,backgroundColor:e.currentItemBackgroundColor,fillStyle:e.currentItemFillStyle,strokeWidth:e.currentItemStrokeWidth,strokeStyle:e.currentItemStrokeStyle,roughness:e.currentItemRoughness,opacity:e.currentItemOpacity,fontSize:16,fontFamily:e.currentItemFontFamily,textAlign:"center",verticalAlign:"top",width:32,angle:5.87})})))||[],m=t.yAxisLabel?He({text:t.yAxisLabel,x:n-36,y:a+96-10,strokeColor:e.currentItemStrokeColor,backgroundColor:e.currentItemBackgroundColor,fillStyle:e.currentItemFillStyle,strokeWidth:e.currentItemStrokeWidth,strokeStyle:e.currentItemStrokeStyle,roughness:e.currentItemRoughness,opacity:e.currentItemOpacity,fontSize:20,fontFamily:e.currentItemFontFamily,textAlign:"center",verticalAlign:"top",width:32,angle:5.87}):null;return[].concat(Object(y.a)(u),[m,c,s],Object(y.a)(d)).filter((function(e){return null!==e}))}var ga="",va=!1,ba="clipboard"in navigator&&"readText"in navigator.clipboard,ya="clipboard"in navigator&&"writeText"in navigator.clipboard,Ea="clipboard"in navigator&&"write"in navigator.clipboard&&"ClipboardItem"in window&&"toBlob"in HTMLCanvasElement.prototype,wa=function(){var e=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ga=JSON.stringify(sn(t,n)),e.prev=1,e.next=4,Oa(null);case 4:va=!1,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),va=!0;case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}(),ka=function(){if(!ga)return{};try{var e=JSON.parse(ga);if(Array.isArray(e)&&e.length>0&&e[0].type)return{elements:e}}catch(t){console.error(t)}return{}},xa=function(){var e=Object(d.a)(u.a.mark((function e(t,n,a,r){var o,i,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!r){e.next=5;break}e.t0=null===(o=r.clipboardData)||void 0===o?void 0:o.getData("text/plain").trim(),e.next=11;break;case 5:if(e.t1=ba,!e.t1){e.next=10;break}return e.next=9,navigator.clipboard.readText();case 9:e.t1=e.sent;case 10:e.t0=e.t1;case 11:if(!(i=e.t0)||va||i.includes("\x3c!-- svg-source:excalidraw --\x3e")){e.next=21;break}if("spreadsheet"!==(l=ha(i)).type){e.next=18;break}return e.abrupt("return",{elements:fa(t,l.spreadsheet,n,a)});case 18:if("malformed spreadsheet"!==l.type){e.next=20;break}return e.abrupt("return",{error:l.error});case 20:return e.abrupt("return",{text:i});case 21:e.next=26;break;case 23:e.prev=23,e.t2=e.catch(0),console.error(e.t2);case 26:return e.abrupt("return",ka());case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t,n,a,r){return e.apply(this,arguments)}}(),Sa=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){try{t.toBlob(function(){var t=Object(d.a)(u.a.mark((function t(a){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.clipboard.write([new window.ClipboardItem({"image/png":a})]);case 3:e(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),n(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}())}catch(a){n(a)}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ca=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(t.outerHTML);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),Oa=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!1,!ya){e.next=11;break}return e.prev=2,e.next=5,navigator.clipboard.writeText(t||"");case 5:n=!0,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0);case 11:if(n||Ia(t||" ")){e.next=13;break}throw new Error("couldn't copy");case 13:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),Ia=function(e){var t="rtl"===document.documentElement.getAttribute("dir"),n=document.createElement("textarea");n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[t?"right":"left"]="-9999px";var a=window.pageYOffset||document.documentElement.scrollTop;n.style.top="".concat(a,"px"),n.style.fontSize="12pt",n.setAttribute("readonly",""),n.value=e,document.body.appendChild(n);var r=!1;try{n.select(),n.setSelectionRange(0,n.value.length),r=document.execCommand("copy")}catch(o){console.error(o)}return n.remove(),r};function ja(e,t){var n,a,r,o,i={type:e.type,version:e.version||1,versionNonce:null!==(n=e.versionNonce)&&void 0!==n?n:0,isDeleted:!1,id:e.id||we(),fillStyle:e.fillStyle||"hachure",strokeWidth:e.strokeWidth||1,strokeStyle:null!==(a=e.strokeStyle)&&void 0!==a?a:"solid",roughness:null!==(r=e.roughness)&&void 0!==r?r:1,opacity:null==e.opacity?100:e.opacity,angle:e.angle||0,x:e.x||0,y:e.y||0,strokeColor:e.strokeColor,backgroundColor:e.backgroundColor,width:e.width||0,height:e.height||0,seed:null!==(o=e.seed)&&void 0!==o?o:1,groupIds:e.groupIds||[]};return Object(p.a)({},i,{},Oe(i),{},t)}var Ta=function(e){var t;switch(e.type){case"text":var n=e.fontSize,a=e.fontFamily;if("font"in e){var r=e.font.split(" "),o=Object(m.a)(r,2),i=o[0],l=o[1];n=parseInt(i,10),a=function(e){for(var t=0,n=Object.entries(N);t<n.length;t++){var a=Object(m.a)(n[t],2),r=a[0];if(a[1].includes(e))return parseInt(r)}return 1}(l)}return ja(e,{fontSize:n,fontFamily:a,text:null!==(t=e.text)&&void 0!==t?t:"",baseline:e.baseline,textAlign:e.textAlign||"left",verticalAlign:e.verticalAlign||"top"});case"draw":case"line":case"arrow":return ja(e,{points:!Array.isArray(e.points)||e.points.length<2?[[0,0],[e.width,e.height]]:e.points});case"ellipse":case"rectangle":case"diamond":return ja(e,{})}},Ma=function(e,t,n){var a=e.reduce((function(e,t){if("selection"!==t.type&&!Se(t)){var n=Ta(t);n&&e.push(n)}return e}),[]);return(null===n||void 0===n?void 0:n.scrollToContent)&&t&&(t=Object(p.a)({},t,{},dn(a,t,null))),{elements:a,appState:t}},Aa=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(e){var t=Kn(),n=[],a=t;try{var r=JSON.parse(e);if("excalidraw"!==r.type)throw new Error(an("alerts.couldNotLoadInvalidFile"));n=r.elements||[],a=Object(p.a)({},t,{},r.appState)}catch(o){throw new Error(an("alerts.couldNotLoadInvalidFile"))}return{elements:n,appState:a}},t.handle&&(window.handle=t.handle),!("text"in Blob)){e.next=8;break}return e.next=5,t.text();case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,new Promise((function(e){var n=new FileReader;n.readAsText(t,"utf8"),n.onloadend=function(){n.readyState===FileReader.DONE&&e(n.result)}}));case 10:a=e.sent;case 11:return r=n(a),o=r.elements,i=r.appState,e.abrupt("return",Ma(o,i,{scrollToContent:!0}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),La=function(e,t){return JSON.stringify({type:"excalidraw",version:2,source:window.location.origin,elements:e.filter((function(e){return!e.isDeleted})),appState:Zn(t)},null,2)},Da=function(){var e=Object(d.a)(u.a.mark((function e(t,n,a){var r,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=La(t,n),o=new Blob([r],{type:"application/json"}),i="".concat(n.name,".excalidraw"),e.next=5,Object(ua.b)(o,{fileName:i,description:"Excalidraw file",extensions:["excalidraw"]},a||null);case 5:window.handle=e.sent;case 6:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),za=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ua.a)({description:"Excalidraw files",extensions:["json","excalidraw"],mimeTypes:["application/json"]});case 2:return t=e.sent,e.abrupt("return",Aa(t));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pa=function(e,t){try{localStorage.setItem("excalidraw",JSON.stringify(e.filter((function(e){return!e.isDeleted})))),localStorage.setItem("excalidraw-state",JSON.stringify(function(e){e.draggingElement,e.resizingElement,e.multiElement,e.editingElement,e.selectionElement,e.isResizing,e.isRotating,e.collaborators,e.isCollaborating,e.isLoading,e.errorMessage,e.showShortcutsDialog,e.editingLinearElement;return Object(Ie.a)(e,["draggingElement","resizingElement","multiElement","editingElement","selectionElement","isResizing","isRotating","collaborators","isCollaborating","isLoading","errorMessage","showShortcutsDialog","editingLinearElement"])}(t)))}catch(n){console.error(n)}},Na=function(){var e=null,t=null;try{e=localStorage.getItem("excalidraw"),t=localStorage.getItem("excalidraw-state")}catch(r){console.error(r)}var n=[];if(e)try{n=JSON.parse(e)}catch(o){}var a=null;if(t)try{(a=JSON.parse(t)).isCollaborating=!1,a.collaborators=new Map}catch(i){}return Ma(n,a)};window.handle=null;var Ra,Ba=function(e){return"0".concat(e.toString(16)).slice(-2)},Ha=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Uint8Array(10),window.crypto.getRandomValues(t),e.abrupt("return",Array.from(t,Ba).join(""));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_a=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.generateKey({name:"AES-GCM",length:128},!0,["encrypt","decrypt"]);case 2:return t=e.sent,e.next=5,window.crypto.subtle.exportKey("jwk",t);case 5:return e.abrupt("return",e.sent.k);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Fa=function(){var e=new Uint8Array(12);return window.crypto.getRandomValues(e)},Ua=function(e){if(0!==e.length)return new URL(e).hash.match(/^#room=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/)},Wa=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ha();case 2:return t=e.sent,e.next=5,_a();case 5:return n=e.sent,e.abrupt("return","".concat(window.location.origin).concat(window.location.pathname,"#room=").concat(t,",").concat(n));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ya=function(e,t){return window.crypto.subtle.importKey("jwk",{alg:"A128GCM",ext:!0,k:e,key_ops:["encrypt","decrypt"],kty:"oct"},{name:"AES-GCM",length:128},!1,[t])},Ga=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ya(n,"encrypt");case 2:return a=e.sent,r=Fa(),e.next=6,window.crypto.subtle.encrypt({name:"AES-GCM",iv:r},a,t);case 6:return e.t0=e.sent,e.t1=r,e.abrupt("return",{data:e.t0,iv:e.t1});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Xa=function(){var e=Object(d.a)(u.a.mark((function e(t,n,a){var r,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ya(n,"decrypt");case 3:return r=e.sent,e.next=6,window.crypto.subtle.decrypt({name:"AES-GCM",iv:a},r,t);case 6:return o=e.sent,i=new TextDecoder("utf-8").decode(new Uint8Array(o)),e.abrupt("return",JSON.parse(i));case 11:e.prev=11,e.t0=e.catch(0),window.alert(an("alerts.decryptFailed")),console.error(e.t0);case 15:return e.abrupt("return",{type:"INVALID_RESPONSE"});case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n,a){return e.apply(this,arguments)}}(),Va=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var a,r,o,i,l,c,s,d,m,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=La(t,n),r=(new TextEncoder).encode(a),e.next=4,window.crypto.subtle.generateKey({name:"AES-GCM",length:128},!0,["encrypt","decrypt"]);case 4:return o=e.sent,i=new Uint8Array(12),e.next=8,window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},o,r);case 8:return l=e.sent,e.next=11,window.crypto.subtle.exportKey("jwk",o);case 11:return c=e.sent,e.prev=12,e.next=15,fetch("https://json.excalidraw.com/api/v2/post/",{method:"POST",body:l});case 15:return s=e.sent,e.next=18,s.json();case 18:(d=e.sent).id?((m=new URL(window.location.href)).hash="json=".concat(d.id,",").concat(c.k),p=m.toString(),window.prompt("\ud83d\udd12".concat(an("alerts.uploadedSecurly")),p)):window.alert(an("alerts.couldNotCreateShareableLink")),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(12),console.error(e.t0),window.alert(an("alerts.couldNotCreateShareableLink"));case 26:case"end":return e.stop()}}),e,null,[[12,22]])})));return function(t,n){return e.apply(this,arguments)}}(),Ka=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var a,r,o,i,l,c,s,d,m;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],r=Kn(),e.prev=2,e.next=5,fetch(n?"".concat("https://json.excalidraw.com/api/v2/").concat(t):"".concat("https://json.excalidraw.com/api/v1/").concat(t,".json"));case 5:if((o=e.sent).ok){e.next=9;break}return window.alert(an("alerts.importBackendFailed")),e.abrupt("return",Ma(a,r,{scrollToContent:!0}));case 9:if(!n){e.next=24;break}return e.next=12,o.arrayBuffer();case 12:return l=e.sent,e.next=15,Ya(n,"decrypt");case 15:return c=e.sent,s=new Uint8Array(12),e.next=19,window.crypto.subtle.decrypt({name:"AES-GCM",iv:s},c,l);case 19:d=e.sent,m=new window.TextDecoder("utf-8").decode(new Uint8Array(d)),i=JSON.parse(m),e.next=27;break;case 24:return e.next=26,o.json();case 26:i=e.sent;case 27:a=i.elements||a,r=Object(p.a)({},r,{},i.appState),e.next=35;break;case 31:e.prev=31,e.t0=e.catch(2),window.alert(an("alerts.importBackendFailed")),console.error(e.t0);case 35:return e.prev=35,e.abrupt("return",Ma(a,r,{scrollToContent:!0}));case 38:case"end":return e.stop()}}),e,null,[[2,31,35,38]])})));return function(t,n){return e.apply(this,arguments)}}(),Za=function(){var e=Object(d.a)(u.a.mark((function e(t,n,a,r,o){var i,l,c,s,m,p,h,f,g,v,b,y;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=o.exportBackground,l=o.exportPadding,c=void 0===l?10:l,s=o.viewBackgroundColor,m=o.name,p=o.scale,h=void 0===p?1:p,f=o.shouldAddWatermark,0!==n.length){e.next=3;break}return e.abrupt("return",window.alert(an("alerts.cannotExportEmptyCanvas")));case 3:if("svg"!==t&&"clipboard-svg"!==t){e.next=14;break}if(g=ca(n,{exportBackground:i,viewBackgroundColor:s,exportPadding:c,shouldAddWatermark:f}),"svg"!==t){e.next=11;break}return e.next=8,Object(ua.b)(new Blob([g.outerHTML],{type:"image/svg+xml"}),{fileName:"".concat(m,".svg")});case 8:return e.abrupt("return");case 11:if("clipboard-svg"!==t){e.next=14;break}return Ca(g),e.abrupt("return");case 14:if((v=la(n,a,{exportBackground:i,viewBackgroundColor:s,exportPadding:c,scale:h,shouldAddWatermark:f})).style.display="none",document.body.appendChild(v),"png"===t)b="".concat(m,".png"),v.toBlob(function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,Object(ua.b)(t,{fileName:b});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());else if("clipboard"===t)try{Sa(v)}catch(E){window.alert(an("alerts.couldNotCopyToClipboard"))}else"backend"===t&&(y=Kn(),i&&(y.viewBackgroundColor=s),Va(n,y));v!==r&&v.remove();case 19:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),qa=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t){e.next=7;break}return e.next=3,Ka(t,n);case 3:a=e.sent,window.history.replaceState({},"Excalidraw",window.location.origin),e.next=8;break;case 7:a=Na();case 8:return e.abrupt("return",{elements:a.elements,appState:a.appState&&Object(p.a)({},a.appState),commitToHistory:!1});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ja=function(){function e(t){Object(h.a)(this,e),this.app=void 0,this.socket=null,this.socketInitialized=!1,this.roomID=null,this.roomKey=null,this.app=t}return Object(f.a)(e,[{key:"open",value:function(e,t,n){var r=this;this.socket=e,this.roomID=t,this.roomKey=n,this.socket.on("init-room",(function(){r.socket&&(r.socket.emit("join-room",r.roomID),r.app.restoreUserName())})),this.socket.on("new-user",function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.app.broadcastScene(a.INIT,!0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.socket.on("room-user-change",(function(e){r.app.setCollaborators(e)}))}},{key:"close",value:function(){this.socket&&(this.socket.close(),this.socket=null,this.roomID=null,this.roomKey=null)}},{key:"isOpen",value:function(){return!!(this.socketInitialized&&this.socket&&this.roomID&&this.roomKey)}},{key:"_broadcastSocketData",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r,o,i=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],!this.isOpen()){e.next=8;break}return a=JSON.stringify(t),r=(new TextEncoder).encode(a),e.next=6,Ga(r,this.roomKey);case 6:o=e.sent,this.socket.emit(n?D:z,this.roomID,o.data,o.iv);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),$a=[{icon:i.a.createElement("svg",{viewBox:"0 0 320 512",className:""},i.a.createElement("path",{d:"M302.189 329.126H196.105l55.831 135.993c3.889 9.428-.555 19.999-9.444 23.999l-49.165 21.427c-9.165 4-19.443-.571-23.332-9.714l-53.053-129.136-86.664 89.138C18.729 472.71 0 463.554 0 447.977V18.299C0 1.899 19.921-6.096 30.277 5.443l284.412 292.542c11.472 11.179 3.007 31.141-12.5 31.141z"})),value:"selection",key:"s"},{icon:i.a.createElement("svg",{viewBox:"0 0 448 512"},i.a.createElement("path",{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"})),value:"rectangle",key:"r"},{icon:i.a.createElement("svg",{viewBox:"0 0 223.646 223.646"},i.a.createElement("path",{d:"M111.823 0L16.622 111.823 111.823 223.646 207.025 111.823z"})),value:"diamond",key:"d"},{icon:i.a.createElement("svg",{viewBox:"0 0 512 512"},i.a.createElement("path",{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"})),value:"ellipse",key:"e"},{icon:i.a.createElement("svg",{viewBox:"0 0 448 512",className:"rtl-mirror"},i.a.createElement("path",{d:"M313.941 216H12c-6.627 0-12 5.373-12 12v56c0 6.627 5.373 12 12 12h301.941v46.059c0 21.382 25.851 32.09 40.971 16.971l86.059-86.059c9.373-9.373 9.373-24.569 0-33.941l-86.059-86.059c-15.119-15.119-40.971-4.411-40.971 16.971V216z"})),value:"arrow",key:"a"},{icon:i.a.createElement("svg",{viewBox:"0 0 6 6"},i.a.createElement("line",{x1:"0",y1:"3",x2:"6",y2:"3",stroke:Vn.black,strokeLinecap:"round"})),value:"line",key:"l"},{icon:i.a.createElement("svg",{viewBox:"0 0 512 512"},i.a.createElement("path",{fill:"currentColor",d:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z"})),value:"draw",key:"x"},{icon:i.a.createElement("svg",{viewBox:"0 0 448 512"},i.a.createElement("path",{d:"M432 416h-23.41L277.88 53.69A32 32 0 0 0 247.58 32h-47.16a32 32 0 0 0-30.3 21.69L39.41 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-19.58l23.3-64h152.56l23.3 64H304a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM176.85 272L224 142.51 271.15 272z"})),value:"text",key:"t"}],Qa=$a.map((function(e,t){return[e.key,(t+1).toString()]})).flat(1),er=function(e){return{selectedElementIds:e.selectedElementIds,viewBackgroundColor:e.viewBackgroundColor,editingLinearElement:e.editingLinearElement,editingGroupId:e.editingGroupId,name:e.name}},tr=function(){function e(){var t=this;Object(h.a)(this,e),this.elementCache=new Map,this.recording=!0,this.stateHistory=[],this.redoStack=[],this.lastEntry=null,this.generateEntry=function(e,n){return t.dehydrateHistoryEntry({appState:er(e),elements:n.reduce((function(t,n){if(w(n)&&e.multiElement&&e.multiElement.id===n.id){if(e.multiElement&&e.multiElement.id===n.id&&n.points.length<2)return t;t.push(Object(p.a)({},n,{points:n.lastCommittedPoint!==n.points[n.points.length-1]?n.points.slice(0,-1):n.points}))}else t.push(n);return t}),[])})}}return Object(f.a)(e,[{key:"hydrateHistoryEntry",value:function(e){var t=this,n=e.appState,a=e.elements;return{appState:JSON.parse(n),elements:a.map((function(e){var n,a=null===(n=t.elementCache.get(e.id))||void 0===n?void 0:n.get(e.versionNonce);if(!a)throw new Error("Element not found: ".concat(e.id,":").concat(e.versionNonce));return a}))}}},{key:"dehydrateHistoryEntry",value:function(e){var t=this,n=e.appState,a=e.elements;return{appState:JSON.stringify(n),elements:a.map((function(e){t.elementCache.has(e.id)||t.elementCache.set(e.id,new Map);var n=t.elementCache.get(e.id);return n.has(e.versionNonce)||n.set(e.versionNonce,Fe(e)),{id:e.id,versionNonce:e.versionNonce}}))}}},{key:"getSnapshotForTest",value:function(){var e=this;return{recording:this.recording,stateHistory:this.stateHistory.map((function(t){return e.hydrateHistoryEntry(t)})),redoStack:this.redoStack.map((function(t){return e.hydrateHistoryEntry(t)}))}}},{key:"clear",value:function(){this.stateHistory.length=0,this.redoStack.length=0,this.lastEntry=null,this.elementCache.clear()}},{key:"shouldCreateEntry",value:function(e){var t,n=this.lastEntry;if(!n)return!0;if(e.elements.length!==n.elements.length)return!0;for(var a=e.elements.length-1;a>-1;a--){var r=e.elements[a],o=n.elements[a];if(!r||!o||r.id!==o.id||r.versionNonce!==o.versionNonce)return!0}for(t in e.appState){var i,l;if("editingLinearElement"===t)if((null===(i=e.appState[t])||void 0===i?void 0:i.elementId)===(null===(l=n.appState[t])||void 0===l?void 0:l.elementId))continue;if("selectedElementIds"!==t&&e.appState[t]!==n.appState[t])return!0}return!1}},{key:"pushEntry",value:function(e,t){var n=this.generateEntry(e,t),a=this.hydrateHistoryEntry(n);if(a){if(!this.shouldCreateEntry(a))return;this.stateHistory.push(n),this.lastEntry=a,this.clearRedoStack()}}},{key:"clearRedoStack",value:function(){this.redoStack.splice(0,this.redoStack.length)}},{key:"redoOnce",value:function(){if(0===this.redoStack.length)return null;var e=this.redoStack.pop();return void 0!==e?(this.stateHistory.push(e),this.hydrateHistoryEntry(e)):null}},{key:"undoOnce",value:function(){if(1===this.stateHistory.length)return null;var e=this.stateHistory.pop(),t=this.stateHistory[this.stateHistory.length-1];return void 0!==e?(this.redoStack.push(e),this.hydrateHistoryEntry(t)):null}},{key:"setCurrentState",value:function(e,t){this.lastEntry=this.hydrateHistoryEntry(this.generateEntry(e,t))}},{key:"resumeRecording",value:function(){this.recording=!0}},{key:"record",value:function(e,t){this.recording&&(this.pushEntry(e,t),this.recording=!1)}}]),e}(),nr=(n(79),function(e){var t=e.children,n=e.left,a=e.top,r=e.onCloseRequest,c=e.fitInViewport,s=void 0!==c&&c,u=Object(o.useRef)(null);return Object(o.useLayoutEffect)((function(){if(s&&u.current){var e=u.current,t=e.getBoundingClientRect(),n=t.x,a=t.y,r=t.width,o=t.height,i=window.innerWidth;n+r>i&&(e.style.left="".concat(i-r,"px"));var l=window.innerHeight;a+o>l&&(e.style.top="".concat(l-o,"px"))}}),[s]),Object(o.useEffect)((function(){if(r){var e=function(e){var t;(null===(t=u.current)||void 0===t?void 0:t.contains(e.target))||Object(l.unstable_batchedUpdates)((function(){return r(e)}))};return document.addEventListener("pointerdown",e,!1),function(){return document.removeEventListener("pointerdown",e,!1)}}}),[r]),i.a.createElement("div",{className:"popover",style:{top:a,left:n},ref:u},t)}),ar=(n(80),function(e){var t=e.options,n=e.onCloseRequest,a=e.top,r=e.left;return i.a.createElement(nr,{onCloseRequest:n,top:a,left:r,fitInViewport:!0},i.a.createElement("ul",{className:"context-menu",onContextMenu:function(e){return e.preventDefault()}},t.map((function(e,t){return i.a.createElement("li",{key:t,onClick:n},i.a.createElement(rr,e))}))))}),rr=function(e){var t=e.label,n=e.action;return i.a.createElement("button",{className:"context-menu-option",onClick:n},t)},or=function(){if(Ra)return Ra;var e=document.createElement("div");return document.body.appendChild(e),Ra=e},ir=function(){Object(l.unmountComponentAtNode)(or())},lr=function(e){var t=Array.of();e.options.forEach((function(e){e&&t.push(e)})),t.length&&Object(l.render)(i.a.createElement(ar,{top:e.top,left:e.left,options:t,onCloseRequest:ir}),or())},cr=function(){function e(t,n,a){var r=this;Object(h.a)(this,e),this.actions={},this.updater=void 0,this.getAppState=void 0,this.getElementsIncludingDeleted=void 0,this.renderAction=function(e,t){if(r.actions[e]&&"PanelComponent"in r.actions[e]){var n=r.actions[e],a=n.PanelComponent;return i.a.createElement(a,{elements:r.getElementsIncludingDeleted(),appState:r.getAppState(),updateData:function(e){r.updater(n.perform(r.getElementsIncludingDeleted(),r.getAppState(),e))},id:t})}return null},this.updater=t,this.getAppState=n,this.getElementsIncludingDeleted=a}return Object(f.a)(e,[{key:"registerAction",value:function(e){this.actions[e.name]=e}},{key:"registerAll",value:function(e){var t=this;e.forEach((function(e){return t.registerAction(e)}))}},{key:"handleKeyDown",value:function(e){var t=this,n=Object.values(this.actions).sort((function(e,t){return(t.keyPriority||0)-(e.keyPriority||0)})).filter((function(n){return n.keyTest&&n.keyTest(e,t.getAppState(),t.getElementsIncludingDeleted())}));return 0!==n.length&&(e.preventDefault(),this.updater(n[0].perform(this.getElementsIncludingDeleted(),this.getAppState(),null)),!0)}},{key:"executeAction",value:function(e){this.updater(e.perform(this.getElementsIncludingDeleted(),this.getAppState(),null))}},{key:"getContextMenuItems",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return Object.values(this.actions).filter(t).filter((function(e){return"contextItemLabel"in e})).sort((function(e,t){return(void 0!==e.contextMenuOrder?e.contextMenuOrder:999)-(void 0!==t.contextMenuOrder?t.contextMenuOrder:999)})).map((function(t){return{label:t.contextItemLabel?an(t.contextItemLabel):"",action:function(){e.updater(t.perform(e.getElementsIncludingDeleted(),e.getAppState(),null))}}}))}}]),e}(),sr=(n(34),i.a.forwardRef((function(e,t){var n=i.a.useRef(null);i.a.useImperativeHandle(t,(function(){return n.current}));var a="ToolIcon_size_".concat(e.size||"m");return"button"===e.type?i.a.createElement("button",{className:"ToolIcon_type_button ".concat(e.hidden?"":"ToolIcon"," ").concat(a).concat(e.selected?" ToolIcon--selected":""," ").concat(e.className," ").concat(e.visible&&!e.hidden?"ToolIcon_type_button--show":"ToolIcon_type_button--hide"),hidden:e.hidden,title:e.title,"aria-label":e["aria-label"],type:"button",onClick:e.onClick,ref:n},i.a.createElement("div",{className:"ToolIcon__icon","aria-hidden":"true"},e.icon||e.label),e.showAriaLabel&&i.a.createElement("div",{className:"ToolIcon__label"},e["aria-label"]),e.children):i.a.createElement("label",{className:"ToolIcon",title:e.title},i.a.createElement("input",{className:"ToolIcon_type_radio ".concat(a),type:"radio",name:e.name,"aria-label":e["aria-label"],"aria-keyshortcuts":e["aria-keyshortcuts"],"data-testid":e["data-testid"],id:e.id,onChange:e.onChange,checked:e.checked,ref:n}),i.a.createElement("div",{className:"ToolIcon__icon"},e.icon,e.keyBindingLabel&&i.a.createElement("span",{className:"ToolIcon__keybinding"},e.keyBindingLabel)))})));sr.defaultProps={visible:!0,className:""};var ur=Vn.orange[4],dr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:512,n="number"===typeof t?{width:t}:t,a=n.width,r=void 0===a?512:a,o=n.height,l=void 0===o?r:o,c=n.mirror,s=n.style;return i.a.createElement("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 ".concat(r," ").concat(l),className:c&&"rtl-mirror",style:s},"string"===typeof e?i.a.createElement("path",{fill:"currentColor",d:e}):e)},mr=dr("M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z",{mirror:!0}),pr=dr("M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z",{width:448,height:512}),hr=dr("M252 54L203 8a28 27 0 00-20-8H28C12 0 0 12 0 27v195c0 15 12 26 28 26h204c15 0 28-11 28-26V73a28 27 0 00-8-19zM130 213c-21 0-37-16-37-36 0-19 16-35 37-35 20 0 37 16 37 35 0 20-17 36-37 36zm56-169v56c0 4-4 6-7 6H44c-4 0-7-2-7-6V42c0-4 3-7 7-7h133l4 2 3 2a7 7 0 012 5z M296 201l87 95-188 205-78 9c-10 1-19-8-18-20l9-84zm141-14l-41-44a31 31 0 00-46 0l-38 41 87 95 38-42c13-14 13-36 0-50z",{width:448,height:512}),fr=dr("M572.694 292.093L500.27 416.248A63.997 63.997 0 0 1 444.989 448H45.025c-18.523 0-30.064-20.093-20.731-36.093l72.424-124.155A64 64 0 0 1 152 256h399.964c18.523 0 30.064 20.093 20.73 36.093zM152 224h328v-48c0-26.51-21.49-48-48-48H272l-64-64H48C21.49 64 0 85.49 0 112v278.046l69.077-118.418C86.214 242.25 117.989 224 152 224z",{width:576,height:512,mirror:!0}),gr=dr("M384 112v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h80c0-35.29 28.71-64 64-64s64 28.71 64 64h80c26.51 0 48 21.49 48 48zM192 40c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24m96 114v-20a6 6 0 0 0-6-6H102a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h180a6 6 0 0 0 6-6z",{width:384,height:512}),vr=dr("M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z",{width:448,height:512}),br=dr("M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"),yr=dr("M384 121.9c0-6.3-2.5-12.4-7-16.9L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128zM571 308l-95.7-96.4c-10.1-10.1-27.4-3-27.4 11.3V288h-64v64h64v65.2c0 14.3 17.3 21.4 27.4 11.3L571 332c6.6-6.6 6.6-17.4 0-24zm-379 28v-32c0-8.8 7.2-16 16-16h176V160H248c-13.2 0-24-10.8-24-24V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V352H208c-8.8 0-16-7.2-16-16z",{width:576,height:512,mirror:!0}),Er=dr("M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512}),wr=dr("M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512}),kr=dr("M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z",{mirror:!0}),xr=dr("M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"),Sr=dr("M255.545 8c-66.269.119-126.438 26.233-170.86 68.685L48.971 40.971C33.851 25.851 8 36.559 8 57.941V192c0 13.255 10.745 24 24 24h134.059c21.382 0 32.09-25.851 16.971-40.971l-41.75-41.75c30.864-28.899 70.801-44.907 113.23-45.273 92.398-.798 170.283 73.977 169.484 169.442C423.236 348.009 349.816 424 256 424c-41.127 0-79.997-14.678-110.63-41.556-4.743-4.161-11.906-3.908-16.368.553L89.34 422.659c-4.872 4.872-4.631 12.815.482 17.433C133.798 479.813 192.074 504 256 504c136.966 0 247.999-111.033 248-247.998C504.001 119.193 392.354 7.755 255.545 8z",{mirror:!0}),Cr=dr("M256.455 8c66.269.119 126.437 26.233 170.859 68.685l35.715-35.715C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.75c-30.864-28.899-70.801-44.907-113.23-45.273-92.398-.798-170.283 73.977-169.484 169.442C88.764 348.009 162.184 424 256 424c41.127 0 79.997-14.678 110.629-41.556 4.743-4.161 11.906-3.908 16.368.553l39.662 39.662c4.872 4.872 4.631 12.815-.482 17.433C378.202 479.813 319.926 504 256 504 119.034 504 8.001 392.967 8 256.002 7.999 119.193 119.646 7.755 256.455 8z",{mirror:!0}),Or=dr(i.a.createElement("path",{stroke:"currentColor",strokeWidth:"40",fill:"currentColor",d:"M148 560a318 318 0 0 0 522 110 316 316 0 0 0 0-450 316 316 0 0 0-450 0c-11 11-21 22-30 34v4h47c25 0 46 21 46 46s-21 45-46 45H90c-13 0-25-6-33-14-9-9-14-20-14-33V156c0-25 20-45 45-45s45 20 45 45v32l1 1a401 401 0 0 1 623 509l212 212a42 42 0 0 1-59 59L698 757A401 401 0 0 1 65 570a42 42 0 0 1 83-10z"}),{width:1024}),Ir=dr(i.a.createElement(i.a.Fragment,null,i.a.createElement("path",{d:"M22 9.556C22 8.696 21.303 8 20.444 8H16v8H8v4.444C8 21.304 8.697 22 9.556 22h10.888c.86 0 1.556-.697 1.556-1.556V9.556z",stroke:Vn.black,strokeWidth:"2"}),i.a.createElement("path",{d:"M16 3.556C16 2.696 15.303 2 14.444 2H3.556C2.696 2 2 2.697 2 3.556v10.888C2 15.304 2.697 16 3.556 16h10.888c.86 0 1.556-.697 1.556-1.556V3.556z",fill:ur,stroke:ur,strokeWidth:"2"})),{width:24}),jr=dr(i.a.createElement(i.a.Fragment,null,i.a.createElement("path",{d:"M16 3.556C16 2.696 15.303 2 14.444 2H3.556C2.696 2 2 2.697 2 3.556v10.888C2 15.304 2.697 16 3.556 16h10.888c.86 0 1.556-.697 1.556-1.556V3.556z",fill:ur,stroke:ur,strokeWidth:"2"}),i.a.createElement("path",{d:"M22 9.556C22 8.696 21.303 8 20.444 8H9.556C8.696 8 8 8.697 8 9.556v10.888C8 21.304 8.697 22 9.556 22h10.888c.86 0 1.556-.697 1.556-1.556V9.556z",stroke:Vn.black,strokeWidth:"2"})),{width:24}),Tr=dr(i.a.createElement(i.a.Fragment,null,i.a.createElement("path",{d:"M13 21a1 1 0 001 1h7a1 1 0 001-1v-7a1 1 0 00-1-1h-3v5h-5v3zM11 3a1 1 0 00-1-1H3a1 1 0 00-1 1v7a1 1 0 001 1h3V6h5V3z",stroke:Vn.black,strokeWidth:"2"}),i.a.createElement("path",{d:"M18 7.333C18 6.597 17.403 6 16.667 6H7.333C6.597 6 6 6.597 6 7.333v9.334C6 17.403 6.597 18 7.333 18h9.334c.736 0 1.333-.597 1.333-1.333V7.333z",fill:ur,stroke:ur,strokeWidth:"2"})),{width:24}),Mr=dr(i.a.createElement(i.a.Fragment,null,i.a.createElement("path",{d:"M18 7.333C18 6.597 17.403 6 16.667 6H7.333C6.597 6 6 6.597 6 7.333v9.334C6 17.403 6.597 18 7.333 18h9.334c.736 0 1.333-.597 1.333-1.333V7.333z",fill:ur,stroke:ur,strokeLinejoin:"round",strokeWidth:"2"}),i.a.createElement("path",{d:"M11 3a1 1 0 00-1-1H3a1 1 0 00-1 1v7a1 1 0 001 1h8V3zM22 14a1 1 0 00-1-1h-7a1 1 0 00-1 1v7a1 1 0 001 1h8v-8z",stroke:Vn.black,strokeLinejoin:"round",strokeWidth:"2"})),{width:24}),Ar=dr("M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z",{width:640,height:512,mirror:!0}),Lr=dr("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z"),Dr=dr("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm96 328c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h160c8.8 0 16 7.2 16 16v160z"),zr=dr("M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z",{width:352,height:512}),Pr=dr("M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z",{width:320,height:512,style:{marginLeft:"-0.2rem"},mirror:!0}),Nr=dr("M464 0c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48H176c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h288M176 416c-44.112 0-80-35.888-80-80V128H48c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48v-48H176z",{mirror:!0}),Rr=dr("M11.553 22.894a.998.998 0 00.894 0s3.037-1.516 5.465-4.097C19.616 16.987 21 14.663 21 12V5a1 1 0 00-.649-.936l-8-3a.998.998 0 00-.702 0l-8 3A1 1 0 003 5v7c0 2.663 1.384 4.987 3.088 6.797 2.428 2.581 5.465 4.097 5.465 4.097zm-1.303-8.481l6.644-6.644a.856.856 0 111.212 1.212l-7.25 7.25a.856.856 0 01-1.212 0l-3.75-3.75a.856.856 0 111.212-1.212l3.144 3.144z",{width:24}),Br=[],Hr=function(e){return Br=Br.concat(e),e};function _r(e,t){if(e.editingGroupId){var n=ze(Yt(t),e.editingGroupId);if(n.length)return Object(p.a)({},e,{selectedElementIds:Object(je.a)({},n[0].id,!0)})}return e}var Fr=Hr({name:"deleteSelectedElements",perform:function(e,t){var n,a;if(null!=(null===(n=t.editingLinearElement)||void 0===n?void 0:n.activePointIndex)&&(null===(a=t.editingLinearElement)||void 0===a?void 0:a.activePointIndex)>-1){var r=t.editingLinearElement.elementId,o=ea.getElement(r);if(o){if(o.points.length<2){var i=e.filter((function(e){return e.id!==o.id})),l=_r(t,i);return{elements:i,appState:Object(p.a)({},l,{editingLinearElement:null}),commitToHistory:!1}}return ea.movePoint(o,t.editingLinearElement.activePointIndex,"delete"),{elements:e,appState:Object(p.a)({},t,{editingLinearElement:Object(p.a)({},t.editingLinearElement,{activePointIndex:t.editingLinearElement.activePointIndex>0?t.editingLinearElement.activePointIndex-1:0})}),commitToHistory:!0}}}var c=function(e,t){return{elements:e.map((function(e){return t.selectedElementIds[e.id]?xe(e,{isDeleted:!0}):e})),appState:Object(p.a)({},t,{selectedElementIds:{}})}}(e,t),s=c.elements,u=c.appState;return u=_r(u,s),{elements:s,appState:Object(p.a)({},u,{elementType:"selection",multiElement:null}),commitToHistory:cn(Yt(e),t)}},contextItemLabel:"labels.delete",contextMenuOrder:3,keyTest:function(e){return e.key===St||e.key===xt},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement(sr,{type:"button",icon:vr,title:an("labels.delete"),"aria-label":an("labels.delete"),onClick:function(){return a(null)},visible:cn(Yt(t),n)})}}),Ur=function(e,t,n){var a=e[t];e[t]=e[n],e[n]=a},Wr=function(e,t){t.sort((function(e,t){return e-t}));var n=!0;return t.forEach((function(t,a){(n=n&&t===a)||Ur(e,t-1,t)})),e},Yr=function(e,t){var n=t.sort((function(e,t){return t-e})),a=!0;return n.forEach((function(t,n){(a=a&&t===e.length-n-1)||Ur(e,t+1,t)})),e},Gr=function(e,t){t.sort((function(e,t){return e-t}));var n=t.map((function(t){return e[t]})),a=t.reverse().concat([0]);return a.forEach((function(t,n){if(0!==n)for(var r=a[n-1]-1;r>=t;--r)e[r+n]=e[r]})),n.forEach((function(t,n){e[n]=t})),e},Xr=function(e,t){var n=t.sort((function(e,t){return t-e})),a=n.map((function(t){return e[t]}));return(t=n.reverse().concat([e.length])).forEach((function(n,a){if(0!==a)for(var r=t[a-1]+1;r<n;++r)e[r-a]=e[r]})),a.forEach((function(t,n){e[e.length-n-1]=t})),e},Vr=function(e,t,n){var a=t.slice();return e(a,function(e,t,n){var a=[],r=[],o=function(e,t){e.isDeleted?r.push(t):(n.selectedElementIds[e.id]&&a.push.apply(a,Object(y.a)(r).concat([t])),r=[])};if("left"===e)for(var i=-1,l=t.length;++i<l;)o(t[i],i);else for(var c=t.length;--c>-1;)o(t[c],c);return a.sort()}(e===Wr||e===Gr?"left":"right",a,n))},Kr=(Hr({name:"sendBackward",perform:function(e,t){return{elements:Vr(Wr,e,t),appState:t,commitToHistory:!0}},contextItemLabel:"labels.sendBackward",keyPriority:40,keyTest:function(e){return e[Ct]&&!e.shiftKey&&"BracketLeft"===e.code},PanelComponent:function(e){var t=e.updateData;return i.a.createElement("button",{type:"button",className:"zIndexButton",onClick:function(){return t(null)},title:"".concat(an("labels.sendBackward")," \u2014 ").concat(zn("CtrlOrCmd+["))},jr)}}),Hr({name:"bringForward",perform:function(e,t){return{elements:Vr(Yr,e,t),appState:t,commitToHistory:!0}},contextItemLabel:"labels.bringForward",keyPriority:40,keyTest:function(e){return e[Ct]&&!e.shiftKey&&"BracketRight"===e.code},PanelComponent:function(e){var t=e.updateData;return i.a.createElement("button",{type:"button",className:"zIndexButton",onClick:function(){return t(null)},title:"".concat(an("labels.bringForward")," \u2014 ").concat(zn("CtrlOrCmd+]"))},Ir)}}),Hr({name:"sendToBack",perform:function(e,t){return{elements:Vr(Gr,e,t),appState:t,commitToHistory:!0}},contextItemLabel:"labels.sendToBack",keyTest:function(e){return gt?e[Ct]&&e.altKey&&"BracketLeft"===e.code:e[Ct]&&e.shiftKey&&"BracketLeft"===e.code},PanelComponent:function(e){var t=e.updateData;return i.a.createElement("button",{type:"button",className:"zIndexButton",onClick:function(){return t(null)},title:"".concat(an("labels.sendToBack")," \u2014 ").concat(zn(gt?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+["))},Mr)}}),Hr({name:"bringToFront",perform:function(e,t){return{elements:Vr(Xr,e,t),appState:t,commitToHistory:!0}},contextItemLabel:"labels.bringToFront",keyTest:function(e){return gt?e[Ct]&&e.altKey&&"BracketRight"===e.code:e[Ct]&&e.shiftKey&&"BracketRight"===e.code},PanelComponent:function(e){var t=e.updateData;return i.a.createElement("button",{type:"button",className:"zIndexButton",onClick:function(e){return t(null)},title:"".concat(an("labels.bringToFront")," \u2014 ").concat(zn(gt?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]"))},Tr)}}),Hr({name:"selectAll",perform:function(e,t){return{appState:Le(Object(p.a)({},t,{editingGroupId:null,selectedElementIds:e.reduce((function(e,t){return t.isDeleted||(e[t.id]=!0),e}),{})}),Yt(e)),commitToHistory:!0}},contextItemLabel:"labels.selectAll",keyTest:function(e){return e[Ct]&&"a"===e.key}}),Hr({name:"duplicateSelection",perform:function(e,t){var n=new Map;return{appState:t,elements:e.reduce((function(e,a){if(t.selectedElementIds[a.id]){var r=Ue(t.editingGroupId,n,a,{x:a.x+10,y:a.y+10});return t.selectedElementIds[r.id]=!0,delete t.selectedElementIds[a.id],e.concat([a,r])}return e.concat(a)}),[]),commitToHistory:!0}},contextItemLabel:"labels.duplicateSelection",keyTest:function(e){return e[Ct]&&"d"===e.key},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement(sr,{type:"button",icon:Nr,title:"".concat(an("labels.duplicateSelection")," \u2014 ").concat(zn("CtrlOrCmd+D")),"aria-label":an("labels.duplicateSelection"),onClick:function(){return a(null)},visible:cn(Yt(t),n)})}}),function(e){var t=e.options,n=e.value,a=e.onChange,r=e.group;return i.a.createElement("div",{className:"buttonList"},t.map((function(e){return i.a.createElement("label",{key:e.text,className:n===e.value?"active":""},i.a.createElement("input",{type:"radio",name:r,onChange:function(){return a(e.value)},checked:n===e.value}),e.text)})))}),Zr=(n(81),function(e){var t=(new Option).style;return t.color=e,!!t.color}),qr=[["1","2","3","4","5"],["q","w","e","r","t"],["a","s","d","f","g"]].flat(),Jr=function(e){var t=e.colors,n=e.color,a=e.onChange,r=e.onClose,o=e.label,l=e.showInput,c=void 0===l||l,s=i.a.useRef(),u=i.a.useRef(),d=i.a.useRef(),m=i.a.useRef();i.a.useEffect((function(){u.current?u.current.focus():m.current&&m.current.focus()}),[]);return i.a.createElement("div",{className:"color-picker",role:"dialog","aria-modal":"true","aria-label":an("labels.colorPicker"),onKeyDown:function(e){if(e.key===Ot){var t,n,a=document.activeElement;if(e.shiftKey){if(a===s.current)null===(t=m.current)||void 0===t||t.focus(),e.preventDefault()}else if(a===m.current)null===(n=s.current)||void 0===n||n.focus(),e.preventDefault()}else if(e.key===bt||e.key===vt||e.key===Et||e.key===yt){var o=document.activeElement,i=tn().rtl,l=Array.prototype.indexOf.call(d.current.children,o);if(-1!==l){var u=d.current.children.length-(c?1:0),p=e.key===(i?vt:bt)?(l+1)%u:e.key===(i?bt:vt)?(u+l-1)%u:e.key===yt?(l+5)%u:e.key===Et?(u+l-5)%u:l;d.current.children[p].focus()}e.preventDefault()}else if(qr.includes(e.key.toLowerCase())&&!xn(e.target)){var h=qr.indexOf(e.key.toLowerCase());d.current.children[h].focus(),e.preventDefault()}else e.key!==kt&&e.key!==wt||(e.preventDefault(),r());e.nativeEvent.stopImmediatePropagation()}},i.a.createElement("div",{className:"color-picker-triangle color-picker-triangle-shadow"}),i.a.createElement("div",{className:"color-picker-triangle"}),i.a.createElement("div",{className:"color-picker-content",ref:function(e){e&&(d.current=e)}},t.map((function(e,t){return i.a.createElement("button",{className:"color-picker-swatch",onClick:function(t){t.currentTarget.focus(),a(e)},title:"".concat(e," \u2014 ").concat(qr[t].toUpperCase()),"aria-label":e,"aria-keyshortcuts":qr[t],style:{color:e},key:e,ref:function(a){a&&0===t&&(s.current=a),a&&e===n&&(u.current=a)},onFocus:function(){a(e)}},"transparent"===e?i.a.createElement("div",{className:"color-picker-transparent"}):void 0,i.a.createElement("span",{className:"color-picker-keybinding"},qr[t]))})),c&&i.a.createElement($r,{color:n,label:o,onChange:function(e){a(e)},ref:m})))},$r=i.a.forwardRef((function(e,t){var n=e.color,a=e.onChange,r=e.label,o=i.a.useState(n),l=Object(m.a)(o,2),c=l[0],s=l[1],u=i.a.useRef(null);i.a.useEffect((function(){s(n)}),[n]),i.a.useImperativeHandle(t,(function(){return u.current}));var d=i.a.useCallback((function(e){var t=e.toLowerCase(),n=function(e){return"transparent"===e||Zr(e)?e:Zr("#".concat(e))?"#".concat(e):null}(t);n&&a(n),s(t)}),[a]);return i.a.createElement("label",{className:"color-input-container"},i.a.createElement("div",{className:"color-picker-hash"},"#"),i.a.createElement("input",{spellCheck:!1,className:"color-picker-input","aria-label":r,onChange:function(e){return d(e.target.value)},value:(c||"").replace(/^#/,""),onBlur:function(){return s(n)},ref:u}))})),Qr=function(e){var t=e.type,n=e.color,a=e.onChange,r=e.label,o=i.a.useState(!1),l=Object(m.a)(o,2),c=l[0],s=l[1],u=i.a.useRef(null);return i.a.createElement("div",null,i.a.createElement("div",{className:"color-picker-control-container"},i.a.createElement("button",{className:"color-picker-label-swatch","aria-label":r,style:n?{"--swatch-color":n}:void 0,onClick:function(){return s(!c)},ref:u}),i.a.createElement($r,{color:n,label:r,onChange:function(e){a(e)}})),i.a.createElement(i.a.Suspense,{fallback:""},c?i.a.createElement(nr,{onCloseRequest:function(e){return e.target!==u.current&&s(!1)}},i.a.createElement(Jr,{colors:$n[t],color:n||null,onChange:function(e){a(e)},onClose:function(){var e;s(!1),null===(e=u.current)||void 0===e||e.focus()},label:r,showInput:!1})):null))},eo=function(e,t,n){return e.map((function(e){var a;return t.selectedElementIds[e.id]||e.id===(null===(a=t.editingElement)||void 0===a?void 0:a.id)?n(e):e}))},to=function(e,t,n,a){var r,o,i=t.editingElement,l=Yt(e);return null!==(r=null!==(o=i&&n(i))&&void 0!==o?o:cn(l,t)?function(e,t,n){var a=Array.from(new Set(sn(e,t).map((function(e){return n(e)}))));return 1===a.length?a[0]:null}(l,t,n):a)&&void 0!==r?r:null},no=(Hr({name:"changeStrokeColor",perform:function(e,t,n){return{elements:eo(e,t,(function(e){return xe(e,{strokeColor:n})})),appState:Object(p.a)({},t,{currentItemStrokeColor:n}),commitToHistory:!0}},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement(i.a.Fragment,null,i.a.createElement("h3",{"aria-hidden":"true"},an("labels.stroke")),i.a.createElement(Qr,{type:"elementStroke",label:an("labels.stroke"),color:to(t,n,(function(e){return e.strokeColor}),n.currentItemStrokeColor),onChange:a}))}}),Hr({name:"changeBackgroundColor",perform:function(e,t,n){return{elements:eo(e,t,(function(e){return xe(e,{backgroundColor:n})})),appState:Object(p.a)({},t,{currentItemBackgroundColor:n}),commitToHistory:!0}},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement(i.a.Fragment,null,i.a.createElement("h3",{"aria-hidden":"true"},an("labels.background")),i.a.createElement(Qr,{type:"elementBackground",label:an("labels.background"),color:to(t,n,(function(e){return e.backgroundColor}),n.currentItemBackgroundColor),onChange:a}))}}),Hr({name:"changeFillStyle",perform:function(e,t,n){return{elements:eo(e,t,(function(e){return xe(e,{fillStyle:n})})),appState:Object(p.a)({},t,{currentItemFillStyle:n}),commitToHistory:!0}},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.fill")),i.a.createElement(Kr,{options:[{value:"hachure",text:an("labels.hachure")},{value:"cross-hatch",text:an("labels.crossHatch")},{value:"solid",text:an("labels.solid")}],group:"fill",value:to(t,n,(function(e){return e.fillStyle}),n.currentItemFillStyle),onChange:function(e){a(e)}}))}}),Hr({name:"changeStrokeWidth",perform:function(e,t,n){return{elements:eo(e,t,(function(e){return xe(e,{strokeWidth:n})})),appState:Object(p.a)({},t,{currentItemStrokeWidth:n}),commitToHistory:!0}},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.strokeWidth")),i.a.createElement(Kr,{group:"stroke-width",options:[{value:1,text:an("labels.thin")},{value:2,text:an("labels.bold")},{value:4,text:an("labels.extraBold")}],value:to(t,n,(function(e){return e.strokeWidth}),n.currentItemStrokeWidth),onChange:function(e){return a(e)}}))}}),Hr({name:"changeSloppiness",perform:function(e,t,n){return{elements:eo(e,t,(function(e){return xe(e,{roughness:n})})),appState:Object(p.a)({},t,{currentItemRoughness:n}),commitToHistory:!0}},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.sloppiness")),i.a.createElement(Kr,{group:"sloppiness",options:[{value:0,text:an("labels.architect")},{value:1,text:an("labels.artist")},{value:2,text:an("labels.cartoonist")}],value:to(t,n,(function(e){return e.roughness}),n.currentItemRoughness),onChange:function(e){return a(e)}}))}}),Hr({name:"changeStrokeStyle",perform:function(e,t,n){return{elements:eo(e,t,(function(e){return xe(e,{strokeStyle:n})})),appState:Object(p.a)({},t,{currentItemStrokeStyle:n}),commitToHistory:!0}},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.strokeStyle")),i.a.createElement(Kr,{group:"strokeStyle",options:[{value:"solid",text:an("labels.strokeStyle_solid")},{value:"dashed",text:an("labels.strokeStyle_dashed")},{value:"dotted",text:an("labels.strokeStyle_dotted")}],value:to(t,n,(function(e){return e.strokeStyle}),n.currentItemStrokeStyle),onChange:function(e){return a(e)}}))}}),Hr({name:"changeOpacity",perform:function(e,t,n){return{elements:eo(e,t,(function(e){return xe(e,{opacity:n})})),appState:Object(p.a)({},t,{currentItemOpacity:n}),commitToHistory:!0}},PanelComponent:function(e){var t,n=e.elements,a=e.appState,r=e.updateData;return i.a.createElement("label",{className:"control-label"},an("labels.opacity"),i.a.createElement("input",{type:"range",min:"0",max:"100",step:"10",onChange:function(e){return r(+e.target.value)},onWheel:function(e){e.stopPropagation();var t=+e.target.value;e.deltaY<0&&t<100?r(t+10):e.deltaY>0&&t>0&&r(t-10)},value:null!==(t=to(n,a,(function(e){return e.opacity}),a.currentItemOpacity))&&void 0!==t?t:void 0}))}}),Hr({name:"changeFontSize",perform:function(e,t,n){return{elements:eo(e,t,(function(e){if(E(e)){var t=xe(e,{fontSize:n});return _t(t),t}return e})),appState:Object(p.a)({},t,{currentItemFontSize:n}),commitToHistory:!0}},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.fontSize")),i.a.createElement(Kr,{group:"font-size",options:[{value:16,text:an("labels.small")},{value:20,text:an("labels.medium")},{value:28,text:an("labels.large")},{value:36,text:an("labels.veryLarge")}],value:to(t,n,(function(e){return E(e)&&e.fontSize}),n.currentItemFontSize||20),onChange:function(e){return a(e)}}))}}),Hr({name:"changeFontFamily",perform:function(e,t,n){return{elements:eo(e,t,(function(e){if(E(e)){var t=xe(e,{fontFamily:n});return _t(t),t}return e})),appState:Object(p.a)({},t,{currentItemFontFamily:n}),commitToHistory:!0}},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData,r=[{value:1,text:an("labels.handDrawn")},{value:2,text:an("labels.normal")},{value:3,text:an("labels.code")}];return i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.fontFamily")),i.a.createElement(Kr,{group:"font-family",options:r,value:to(t,n,(function(e){return E(e)&&e.fontFamily}),n.currentItemFontFamily||1),onChange:function(e){return a(e)}}))}}),Hr({name:"changeTextAlign",perform:function(e,t,n){return{elements:eo(e,t,(function(e){if(E(e)){var t=xe(e,{textAlign:n});return _t(t),t}return e})),appState:Object(p.a)({},t,{currentItemTextAlign:n}),commitToHistory:!0}},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.textAlign")),i.a.createElement(Kr,{group:"text-align",options:[{value:"left",text:an("labels.left")},{value:"center",text:an("labels.center")},{value:"right",text:an("labels.right")}],value:to(t,n,(function(e){return E(e)&&e.textAlign}),n.currentItemTextAlign),onChange:function(e){return a(e)}}))}}),Hr({name:"changeViewBackgroundColor",perform:function(e,t,n){return{appState:Object(p.a)({},t,{viewBackgroundColor:n}),commitToHistory:!0}},PanelComponent:function(e){var t=e.appState,n=e.updateData;return i.a.createElement("div",{style:{position:"relative"}},i.a.createElement(Qr,{label:an("labels.canvasBackground"),type:"canvasBackground",color:t.viewBackgroundColor,onChange:function(e){return n(e)}}))}}),Hr({name:"clearCanvas",perform:function(e,t){return{elements:e.map((function(e){return xe(e,{isDeleted:!0})})),appState:Object(p.a)({},Kn(),{username:t.username}),commitToHistory:!0}},PanelComponent:function(e){var t=e.updateData;return i.a.createElement(sr,{type:"button",icon:vr,title:an("buttons.clearReset"),"aria-label":an("buttons.clearReset"),showAriaLabel:Gn(),onClick:function(){window.confirm(an("alerts.clearReset"))&&(window.handle=null,t(null))}})}}),"Minus"),ao="Equal",ro="Digit1",oo="Digit0",io="NumpadSubtract",lo="NumpadAdd",co="Numpad0",so=(Hr({name:"zoomIn",perform:function(e,t){return{appState:Object(p.a)({},t,{zoom:vn(t.zoom+.1)}),commitToHistory:!1}},PanelComponent:function(e){var t=e.updateData;return i.a.createElement(sr,{type:"button",icon:Er,title:"".concat(an("buttons.zoomIn")," \u2014 ").concat(zn("CtrlOrCmd++")),"aria-label":an("buttons.zoomIn"),onClick:function(){t(null)}})},keyTest:function(e){return(e.code===ao||e.code===lo)&&(e[Ct]||e.shiftKey)}}),Hr({name:"zoomOut",perform:function(e,t){return{appState:Object(p.a)({},t,{zoom:vn(t.zoom-.1)}),commitToHistory:!1}},PanelComponent:function(e){var t=e.updateData;return i.a.createElement(sr,{type:"button",icon:wr,title:"".concat(an("buttons.zoomOut")," \u2014 ").concat(zn("CtrlOrCmd+-")),"aria-label":an("buttons.zoomOut"),onClick:function(){t(null)}})},keyTest:function(e){return(e.code===no||e.code===io)&&(e[Ct]||e.shiftKey)}}),Hr({name:"resetZoom",perform:function(e,t){return{appState:Object(p.a)({},t,{zoom:1}),commitToHistory:!1}},PanelComponent:function(e){var t=e.updateData;return i.a.createElement(sr,{type:"button",icon:Or,title:an("buttons.resetZoom"),"aria-label":an("buttons.resetZoom"),onClick:function(){t(null)}})},keyTest:function(e){return(e.code===oo||e.code===co)&&(e[Ct]||e.shiftKey)}}),Hr({name:"zoomToFit",perform:function(e,t){var n=e.filter((function(e){return!e.isDeleted})),a=te(n),r=Object(m.a)(a,4),o=r[0],i=r[1],l=(o+r[2])/2,c=(i+r[3])/2,s=un(window.innerWidth/2-l),u=un(window.innerHeight/2-c),d=function(e,t,n){var a,r=n.scrollX,o=n.scrollY,i=window,l=i.innerWidth,c=i.innerHeight,s=Object(m.a)(e,2),u=-l/(2*r+2*s[0]-l),d=-c/(2*o+2*s[1]-c);return(a=u<d?u-.01:d<=u?d-.01:t)<=.1?.1:a>=1?1:a}(a,t.zoom,{scrollX:s,scrollY:u});return{appState:Object(p.a)({},t,{scrollX:s,scrollY:u,zoom:d}),commitToHistory:!1}},keyTest:function(e){return e.code===ro&&e.shiftKey&&!e.altKey&&!e[Ct]}}),Hr({name:"finalize",perform:function(e,t){var n;if(t.editingLinearElement){var a=t.editingLinearElement.elementId,r=ea.getElement(a);if(r)return{elements:r.points.length<2||Se(r)?e.filter((function(e){return e.id!==r.id})):void 0,appState:Object(p.a)({},t,{editingLinearElement:null}),commitToHistory:!0}}var o=e;window.document.activeElement instanceof HTMLElement&&window.document.activeElement.blur();var i=t.multiElement?t.multiElement:"draw"===(null===(n=t.editingElement)||void 0===n?void 0:n.type)?t.editingElement:null;if(i){if("draw"!==i.type&&"touch"!==t.lastPointerDownWith){var l=i.points,c=i.lastCommittedPoint;c&&l[l.length-1]===c||ke(i,{points:i.points.slice(0,-1)})}if(Se(i)&&(o=o.slice(0,-1)),("line"===i.type||"draw"===i.type)&&U(i.points)){var s=i.points,u=s[0];ke(i,{points:s.map((function(e,t){return t===s.length-1?[u[0],u[1]]:e}))})}t.elementLocked||(t.selectedElementIds[i.id]=!0)}return t.elementLocked&&i||An(),{elements:o,appState:Object(p.a)({},t,{elementType:t.elementLocked&&i?t.elementType:"selection",draggingElement:null,multiElement:null,editingElement:null,selectedElementIds:i&&!t.elementLocked?Object(p.a)({},t.selectedElementIds,Object(je.a)({},i.id,!0)):t.selectedElementIds}),commitToHistory:"draw"===t.elementType}},keyTest:function(e,t){return e.key===kt&&(null!==t.editingLinearElement||!t.draggingElement&&null===t.multiElement)||(e.key===kt||e.key===wt)&&null!==t.multiElement},PanelComponent:function(e){var t=e.appState,n=e.updateData;return i.a.createElement(sr,{type:"button",icon:kr,title:an("buttons.done"),"aria-label":an("buttons.done"),onClick:n,visible:null!=t.multiElement})}})),uo=(n(82),function(e){Object(v.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleFocus=function(e){jn(e.currentTarget)},e.handleBlur=function(t){var n=t.currentTarget.innerText.trim();n!==e.props.value&&e.props.onChange(n),Tn()},e.handleKeyDown=function(e){if("Enter"===e.key){if(e.preventDefault(),e.nativeEvent.isComposing||229===e.keyCode)return;e.currentTarget.blur()}},e.makeEditable=function(e){if(e)try{e.contentEditable="plaintext-only"}catch(t){e.contentEditable="true"}},e}return Object(f.a)(n,[{key:"render",value:function(){return i.a.createElement("span",{suppressContentEditableWarning:!0,ref:this.makeEditable,"data-type":"wysiwyg",className:"TextInput",role:"textbox","aria-label":this.props.label,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onFocus:this.handleFocus},this.props.value)}}]),n}(o.Component)),mo=(Hr({name:"changeProjectName",perform:function(e,t,n){return{appState:Object(p.a)({},t,{name:n}),commitToHistory:!1}},PanelComponent:function(e){var t=e.appState,n=e.updateData;return i.a.createElement(uo,{label:an("labels.fileTitle"),value:t.name||"Unnamed",onChange:function(e){return n(e)}})}}),Hr({name:"changeExportBackground",perform:function(e,t,n){return{appState:Object(p.a)({},t,{exportBackground:n}),commitToHistory:!1}},PanelComponent:function(e){var t=e.appState,n=e.updateData;return i.a.createElement("label",null,i.a.createElement("input",{type:"checkbox",checked:t.exportBackground,onChange:function(e){return n(e.target.checked)}})," ",an("labels.withBackground"))}}),Hr({name:"changeShouldAddWatermark",perform:function(e,t,n){return{appState:Object(p.a)({},t,{shouldAddWatermark:n}),commitToHistory:!1}},PanelComponent:function(e){var t=e.appState,n=e.updateData;return i.a.createElement("label",null,i.a.createElement("input",{type:"checkbox",checked:t.shouldAddWatermark,onChange:function(e){return n(e.target.checked)}})," ",an("labels.addWatermark"))}}),Hr({name:"saveScene",perform:function(e,t,n){return Da(e,t,window.handle).catch((function(e){return console.error(e)})),{commitToHistory:!1}},keyTest:function(e){return"s"===e.key&&e[Ct]&&!e.shiftKey},PanelComponent:function(e){var t=e.updateData;return i.a.createElement(sr,{type:"button",icon:pr,title:an("buttons.save"),"aria-label":an("buttons.save"),showAriaLabel:Gn(),onClick:function(){return t(null)}})}}),Hr({name:"saveAsScene",perform:function(e,t,n){return Da(e,t,null).catch((function(e){return console.error(e)})),{commitToHistory:!1}},keyTest:function(e){return"s"===e.key&&e.shiftKey&&e[Ct]},PanelComponent:function(e){var t=e.updateData;return i.a.createElement(sr,{type:"button",icon:hr,title:an("buttons.saveAs"),"aria-label":an("buttons.saveAs"),showAriaLabel:Gn(),hidden:!("chooseFileSystemEntries"in window),onClick:function(){return t(null)}})}}),Hr({name:"loadScene",perform:function(e,t,n){var a=n.elements,r=n.appState,o=n.error;return{elements:a,appState:Object(p.a)({},r,{errorMessage:o}),commitToHistory:!1}},PanelComponent:function(e){var t=e.updateData;return i.a.createElement(sr,{type:"button",icon:fr,title:an("buttons.load"),"aria-label":an("buttons.load"),showAriaLabel:Gn(),onClick:function(){za().then((function(e){var n=e.elements,a=e.appState;t({elements:n,appState:a})})).catch((function(e){"AbortError"!==e.name&&t({error:e.message})}))}})}}),"{}"),po=(Hr({name:"copyStyles",perform:function(e,t){var n=e.find((function(e){return t.selectedElementIds[e.id]}));return n&&(mo=JSON.stringify(n)),{commitToHistory:!1}},contextItemLabel:"labels.copyStyles",keyTest:function(e){return e[Ct]&&e.shiftKey&&"C"===e.key},contextMenuOrder:0}),Hr({name:"pasteStyles",perform:function(e,t){var n,a=JSON.parse(mo);return"text"!==(null===(n=a)||void 0===n?void 0:n.type)&&"diamond"!==(null===n||void 0===n?void 0:n.type)&&"rectangle"!==(null===n||void 0===n?void 0:n.type)&&"ellipse"!==(null===n||void 0===n?void 0:n.type)&&"arrow"!==(null===n||void 0===n?void 0:n.type)&&"draw"!==(null===n||void 0===n?void 0:n.type)&&"line"!==(null===n||void 0===n?void 0:n.type)?{elements:e,commitToHistory:!1}:{elements:e.map((function(e){if(t.selectedElementIds[e.id]){var n=xe(e,{backgroundColor:null===a||void 0===a?void 0:a.backgroundColor,strokeWidth:null===a||void 0===a?void 0:a.strokeWidth,strokeColor:null===a||void 0===a?void 0:a.strokeColor,strokeStyle:null===a||void 0===a?void 0:a.strokeStyle,fillStyle:null===a||void 0===a?void 0:a.fillStyle,opacity:null===a||void 0===a?void 0:a.opacity,roughness:null===a||void 0===a?void 0:a.roughness});return E(n)&&(ke(n,{fontSize:(null===a||void 0===a?void 0:a.fontSize)||20,fontFamily:(null===a||void 0===a?void 0:a.fontFamily)||1,textAlign:(null===a||void 0===a?void 0:a.textAlign)||"left"}),_t(n)),n}return e})),commitToHistory:!0}},contextItemLabel:"labels.pasteStyles",keyTest:function(e){return e[Ct]&&e.shiftKey&&"V"===e.key},contextMenuOrder:1}),i.a.createElement("svg",{width:"30",height:"22",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("path",{d:"M528 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h480c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM128 180v-40c0-6.627-5.373-12-12-12H76c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm-336 96v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm-336 96v-40c0-6.627-5.373-12-12-12H76c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12zm288 0v-40c0-6.627-5.373-12-12-12H172c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h232c6.627 0 12-5.373 12-12zm96 0v-40c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v40c0 6.627 5.373 12 12 12h40c6.627 0 12-5.373 12-12z"}))),ho=function(e){return i.a.createElement("label",{title:"".concat(e.title," \u2014 ?"),className:"help-icon"},i.a.createElement("div",{onClick:e.onClick},po))},fo=(Hr({name:"toggleCanvasMenu",perform:function(e,t){return{appState:Object(p.a)({},t,{openMenu:"canvas"===t.openMenu?null:"canvas"}),commitToHistory:!1}},PanelComponent:function(e){var t=e.appState,n=e.updateData;return i.a.createElement(sr,{type:"button",icon:xr,"aria-label":an("buttons.menu"),onClick:n,selected:"canvas"===t.openMenu})}}),Hr({name:"toggleEditMenu",perform:function(e,t){return{appState:Object(p.a)({},t,{openMenu:"shape"===t.openMenu?null:"shape"}),commitToHistory:!1}},PanelComponent:function(e){var t=e.elements,n=e.appState,a=e.updateData;return i.a.createElement(sr,{visible:Ft(n,Yt(t)),type:"button",icon:br,"aria-label":an("buttons.edit"),onClick:a,selected:"shape"===n.openMenu})}}),Hr({name:"toggleFullScreen",perform:function(){return Dn()||document.documentElement.requestFullscreen(),Dn()&&document.exitFullscreen(),{commitToHistory:!1}},keyTest:function(e){return e.keyCode===Tt}}),Hr({name:"toggleShortcuts",perform:function(e,t){return{appState:Object(p.a)({},t,{showShortcutsDialog:!0}),commitToHistory:!1}},PanelComponent:function(e){var t=e.updateData;return i.a.createElement(ho,{title:an("shortcutsDialog.title"),onClick:t})},keyTest:function(e){return e.key===jt}}),Hr({name:"group",perform:function(e,t){var n=sn(Yt(e),t);if(n.length<2)return{appState:t,elements:e,commitToHistory:!1};var a=Ae(t);if(1===a.length){var r=a[0],o=new Set(ze(e,r).map((function(e){return e.id}))),i=new Set(n.map((function(e){return e.id})));if(new Set([].concat(Object(y.a)(Array.from(o)),Object(y.a)(Array.from(i)))).size===o.size)return{appState:t,elements:e,commitToHistory:!1}}var l=we(),c=e.map((function(e){return t.selectedElementIds[e.id]?xe(e,{groupIds:Pe(e.groupIds,l,t.editingGroupId)}):e})),s=ze(c,l),u=s[s.length-1],d=c.lastIndexOf(u),m=c.slice(d+1),h=c.slice(0,d).filter((function(e){return!De(e,l)})),f=[].concat(Object(y.a)(h),Object(y.a)(s),Object(y.a)(m));return{appState:Te(l,Object(p.a)({},t,{selectedGroupIds:{}}),Yt(f)),elements:f,commitToHistory:!0}},contextMenuOrder:4,contextItemLabel:"labels.group",keyTest:function(e){return!e.shiftKey&&e[Ct]&&e.keyCode===Dt}}),Hr({name:"ungroup",perform:function(e,t){if(0===Ae(t).length)return{appState:t,elements:e,commitToHistory:!1};var n=e.map((function(e){var n=function(e,t){return e.filter((function(e){return!t[e]}))}(e.groupIds,t.selectedGroupIds);return n.length===e.groupIds.length?e:xe(e,{groupIds:n})}));return{appState:Le(Object(p.a)({},t,{selectedGroupIds:{}}),Yt(n)),elements:n,commitToHistory:!0}},keyTest:function(e){return e.shiftKey&&e[Ct]&&e.keyCode===Dt},contextMenuOrder:5,contextItemLabel:"labels.ungroup"}),n(83),function(e){var t=e.children,n=e.className,a=e.color,r=e.onClick;return i.a.createElement("div",{className:"Avatar ".concat(n),style:{background:a},onClick:r},t)}),go=(Hr({name:"goToCollaborator",perform:function(e,t,n){var a=n;return a?{appState:Object(p.a)({},t,{scrollX:un(window.innerWidth/2-a.x),scrollY:un(window.innerHeight/2-a.y),openMenu:"canvas"===t.openMenu?null:t.openMenu}),commitToHistory:!1}:{appState:t,commitToHistory:!1}},PanelComponent:function(e){var t=e.appState,n=e.updateData,a=e.id;if(!a)return null;var r=t.collaborators.get(a);if(!r)return null;var o=Qn(a).background,l=function(e){if(!e)return"?";var t=e.trim().split(" ");if(t.length<2)return t[0].substring(0,2).toUpperCase();var n=t[0],a=t[t.length-1];return(n[0]+a[0]).toUpperCase()}(r.username);return i.a.createElement(fo,{color:o,onClick:function(){return n(r.pointer)}},l)}}),function(e){var t=Array.from(e.values());return{x:un(bo(t,(function(e){return e.x}))/t.length),y:un(bo(t,(function(e){return e.y}))/t.length)}}),vo=function(e){var t=Object(m.a)(e,2),n=t[0],a=t[1];return Math.hypot(n.x-a.x,n.y-a.y)},bo=function(e,t){return e.reduce((function(e,n){return e+t(n)}),0)},yo=function(e,t,n){if(!t.multiElement&&!t.resizingElement&&!t.editingElement&&!t.draggingElement){var a=n();if(null===a)return{commitToHistory:!1};var r=Ut(e),o=a.elements,i=Ut(o);return{elements:o.map((function(e){return xe(r[e.id]||e,e)})).concat(e.filter((function(e){return!i.hasOwnProperty(e.id)})).map((function(e){return xe(e,{isDeleted:!0})}))),appState:Object(p.a)({},t,{},a.appState),commitToHistory:!1,syncHistory:!0}}return{commitToHistory:!1}},Eo=function(e){return function(t){return t[Ct]&&/z/i.test(t.key)&&t.shiftKey===e}},wo=(n(84),i.a.forwardRef((function(e,t){var n=e.children,a=e.padding,r=e.className,o=e.style;return i.a.createElement("div",{className:"".concat(null!==r&&void 0!==r?r:""," Island"),style:Object(p.a)({"--padding":a},o),ref:t},n)}))),ko=(n(85),function(e){var t=e.children,n=e.gap,a=e.align,r=e.justifyContent,o=e.className;return i.a.createElement("div",{className:"Stack Stack_horizontal ".concat(o||""),style:{"--gap":n,alignItems:a,justifyContent:r}},t)}),xo=function(e){var t=e.children,n=e.gap,a=e.align,r=e.justifyContent,o=e.className;return i.a.createElement("div",{className:"Stack Stack_vertical ".concat(o||""),style:{"--gap":n,justifyItems:a,justifyContent:r}},t)},So=(n(86),function(e){var t=e.children,n=e.side,a=e.className;return i.a.createElement("div",{className:"FixedSideContainer FixedSideContainer_side_".concat(n," ").concat(a)},t)}),Co=(n(87),function(e){var t=e.children,n=e.className,a=e.mobile,r="UserList";return n&&(r+=" ".concat(n)),a&&(r+=" UserList_mobile"),i.a.createElement("div",{className:r},t)}),Oo={CHECKED:i.a.createElement("svg",{width:"1792",height:"1792",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("path",{d:"M640 768h512v-192q0-106-75-181t-181-75-181 75-75 181v192zm832 96v576q0 40-28 68t-68 28h-960q-40 0-68-28t-28-68v-576q0-40 28-68t68-28h32v-192q0-184 132-316t316-132 316 132 132 316v192h32q40 0 68 28t28 68z"})),UNCHECKED:i.a.createElement("svg",{width:"1792",height:"1792",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg",className:"unlocked-icon rtl-mirror"},i.a.createElement("path",{d:"M1728 576v256q0 26-19 45t-45 19h-64q-26 0-45-19t-19-45v-256q0-106-75-181t-181-75-181 75-75 181v192h96q40 0 68 28t28 68v576q0 40-28 68t-68 28h-960q-40 0-68-28t-28-68v-576q0-40 28-68t68-28h672v-192q0-185 131.5-316.5t316.5-131.5 316.5 131.5 131.5 316.5z"}))},Io=function(e){var t="ToolIcon_size_".concat(e.size||"m");return i.a.createElement("label",{className:"ToolIcon ToolIcon__lock ToolIcon_type_floating ".concat(t," zen-mode-visibility ").concat(e.zenModeEnabled&&"zen-mode-visibility--hidden"),title:"".concat(e.title," \u2014 Q")},i.a.createElement("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,id:e.id,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),i.a.createElement("div",{className:"ToolIcon__icon"},e.checked?Oo.CHECKED:Oo.UNCHECKED))},jo=(n(88),n(89),function(e){var t,n=To();return Object(l.createPortal)(i.a.createElement("div",{className:"Modal ".concat(null!==(t=e.className)&&void 0!==t?t:""),role:"dialog","aria-modal":"true",onKeyDown:function(t){t.key===kt&&(t.nativeEvent.stopImmediatePropagation(),e.onCloseRequest())},"aria-labelledby":e.labelledBy},i.a.createElement("div",{className:"Modal__background",onClick:e.onCloseRequest}),i.a.createElement("div",{className:"Modal__content",style:{"--max-width":"".concat(e.maxWidth,"px"),maxHeight:"100%",overflowY:"scroll"}},e.children)),n)}),To=function(){var e=Object(o.useState)((function(){var e=document.createElement("div");return document.body.appendChild(e),e})),t=Object(m.a)(e,1)[0];return Object(o.useEffect)((function(){return function(){document.body.removeChild(t)}}),[t]),t},Mo=(n(90),function(e){var t,n=Object(o.useRef)(null);Object(o.useEffect)((function(){var e=a();e.length>0&&(e[1]||e[0]).focus()}),[]),Object(o.useEffect)((function(){if(n.current){var e=function(e){if(e.key===Ot){var t=a(),n=document.activeElement,r=t.findIndex((function(e){return e===n}));0===r&&e.shiftKey?(t[t.length-1].focus(),e.preventDefault()):r!==t.length-1||e.shiftKey||(t[0].focus(),e.preventDefault())}},t=n.current;return t.addEventListener("keydown",e),function(){return t.removeEventListener("keydown",e)}}}),[]);var a=function(){var e,t=null===(e=n.current)||void 0===e?void 0:e.querySelectorAll("button, a, input, select, textarea, div[tabindex]");return t?Array.from(t):[]};return i.a.createElement(jo,{className:"".concat(null!==(t=e.className)&&void 0!==t?t:""," Dialog"),labelledBy:"dialog-title",maxWidth:e.maxWidth,onCloseRequest:e.onCloseRequest},i.a.createElement(wo,{padding:4,ref:n},i.a.createElement("h2",{id:"dialog-title",className:"Dialog__title"},i.a.createElement("span",{className:"Dialog__titleContent"},e.title),i.a.createElement("button",{className:"Modal__close",onClick:e.onCloseRequest,"aria-label":an("buttons.close")},Gn()?Pr:zr)),e.children))}),Ao=[1,2,3],Lo=Ao.includes(devicePixelRatio)?devicePixelRatio:1,Do=function(e){var t=e.elements,n=e.appState,a=e.exportPadding,r=void 0===a?10:a,l=e.actionManager,c=e.onExportToPng,s=e.onExportToSvg,u=e.onExportToClipboard,d=e.onExportToBackend,p=cn(t,n),h=Object(o.useState)(Lo),f=Object(m.a)(h,2),g=f[0],v=f[1],b=Object(o.useState)(p),y=Object(m.a)(b,2),E=y[0],w=y[1],k=Object(o.useRef)(null),x=n.exportBackground,S=n.viewBackgroundColor,C=n.shouldAddWatermark,O=E?sn(t,n):t;return Object(o.useEffect)((function(){w(p)}),[p]),Object(o.useEffect)((function(){var e=k.current,t=la(O,n,{exportBackground:x,viewBackgroundColor:S,exportPadding:r,scale:g,shouldAddWatermark:C});return null===e||void 0===e||e.appendChild(t),function(){null===e||void 0===e||e.removeChild(t)}}),[n,O,x,r,S,g,C]),i.a.createElement("div",{className:"ExportDialog"},i.a.createElement("div",{className:"ExportDialog__preview",ref:k}),i.a.createElement(xo,{gap:2,align:"center"},i.a.createElement("div",{className:"ExportDialog__actions"},i.a.createElement(ko,{gap:2},i.a.createElement(sr,{type:"button",label:"PNG",title:an("buttons.exportToPng"),"aria-label":an("buttons.exportToPng"),onClick:function(){return c(O,g)}}),i.a.createElement(sr,{type:"button",label:"SVG",title:an("buttons.exportToSvg"),"aria-label":an("buttons.exportToSvg"),onClick:function(){return s(O,g)}}),Ea&&i.a.createElement(sr,{type:"button",icon:gr,title:an("buttons.copyPngToClipboard"),"aria-label":an("buttons.copyPngToClipboard"),onClick:function(){return u(O,g)}}),i.a.createElement(sr,{type:"button",icon:mr,title:an("buttons.getShareableLink"),"aria-label":an("buttons.getShareableLink"),onClick:function(){return d(O)}})),i.a.createElement("div",{className:"ExportDialog__name"},l.renderAction("changeProjectName")),i.a.createElement(ko,{gap:2},Ao.map((function(e){return i.a.createElement(sr,{key:e,size:"s",type:"radio",icon:"x".concat(e),name:"export-canvas-scale","aria-label":"Scale ".concat(e," x"),id:"export-canvas-scale",checked:e===g,onChange:function(){return v(e)}})})))),l.renderAction("changeExportBackground"),p&&i.a.createElement("div",null,i.a.createElement("label",null,i.a.createElement("input",{type:"checkbox",checked:E,onChange:function(e){return w(e.currentTarget.checked)}})," ",an("labels.onlySelected"))),l.renderAction("changeShouldAddWatermark")))},zo=function(e){var t=e.elements,n=e.appState,a=e.exportPadding,r=void 0===a?10:a,l=e.actionManager,c=e.onExportToPng,s=e.onExportToSvg,u=e.onExportToClipboard,d=e.onExportToBackend,p=Object(o.useState)(!1),h=Object(m.a)(p,2),f=h[0],g=h[1],v=Object(o.useRef)(null),b=i.a.useCallback((function(){var e;g(!1),null===(e=v.current)||void 0===e||e.focus()}),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(sr,{onClick:function(){return g(!0)},icon:yr,type:"button","aria-label":an("buttons.export"),showAriaLabel:Gn(),title:an("buttons.export"),ref:v}),f&&i.a.createElement(Mo,{maxWidth:800,onCloseRequest:b,title:an("buttons.export")},i.a.createElement(Do,{elements:t,appState:n,exportPadding:r,actionManager:l,onExportToPng:c,onExportToSvg:s,onExportToClipboard:u,onExportToBackend:d,onCloseRequest:b})))},Po=function(e){var t=e.onChange,n=e.languages,a=void 0===n?Zt:n,r=e.currentLanguage,o=void 0===r?tn().lng:r,l=e.floating;return i.a.createElement(i.a.Fragment,null,i.a.createElement("select",{className:"dropdown-select dropdown-select__language".concat(l?" dropdown-select--floating":""),onChange:function(e){var n=e.target;return t(n.value)},value:o,"aria-label":an("buttons.selectLanguage")},a.map((function(e){return i.a.createElement("option",{key:e.lng,value:e.lng},e.label)}))))},No=(n(91),function(e){var t=function(e){var t=e.appState,n=e.elements,a=t.elementType,r=t.isResizing,o=t.isRotating,i=t.lastPointerDownWith,l=null!==t.multiElement;if("arrow"===a||"line"===a)return an(l?"hints.linearElementMulti":"hints.linearElement");if("draw"===a)return an("hints.freeDraw");var c=sn(n,t);if(r&&"mouse"===i&&1===c.length){var s=c[0];return w(s)&&s.points.length>2?null:an("hints.resize")}return o&&"mouse"===i?an("hints.rotate"):1===c.length&&w(c[0])?t.editingLinearElement?t.editingLinearElement.activePointIndex?an("hints.lineEditor_pointSelected"):an("hints.lineEditor_nothingSelected"):an("hints.lineEditor_info"):null}({appState:e.appState,elements:e.elements});return t?(t=zn(t),i.a.createElement("div",{className:"HintViewer"},i.a.createElement("span",null,t))):null}),Ro=function(e){var t=e.appState,n=e.elements,a=e.renderAction,r=e.elementType,o=function(e,t){return t.editingElement?[t.editingElement]:sn(e,t)}(Yt(n),t),l=Boolean(t.editingElement),c=Gn();return i.a.createElement("div",{className:"panelColumn"},a("changeStrokeColor"),(mn(r)||o.some((function(e){return mn(e.type)})))&&i.a.createElement(i.a.Fragment,null,a("changeBackgroundColor"),a("changeFillStyle")),(pn(r)||o.some((function(e){return pn(e.type)})))&&i.a.createElement(i.a.Fragment,null,a("changeStrokeWidth"),a("changeStrokeStyle"),a("changeSloppiness")),(hn(r)||o.some((function(e){return hn(e.type)})))&&i.a.createElement(i.a.Fragment,null,a("changeFontSize"),a("changeFontFamily"),a("changeTextAlign")),a("changeOpacity"),i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.layers")),i.a.createElement("div",{className:"buttonList"},a("sendToBack"),a("sendBackward"),a("bringToFront"),a("bringForward"))),!c&&!l&&o.length>0&&i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.actions")),i.a.createElement("div",{className:"buttonList"},a("duplicateSelection"),a("deleteSelectedElements"))))},Bo=function(e){var t=e.elementType,n=e.setAppState;return i.a.createElement(i.a.Fragment,null,$a.map((function(e,a){var r=e.value,o=e.icon,l=e.key,c=an("toolBar.".concat(r)),s="".concat(kn(l)," ").concat(an("shortcutsDialog.or")," ").concat(a+1);return i.a.createElement(sr,{key:r,type:"radio",icon:o,checked:t===r,name:"editor-current-shape",title:"".concat(kn(c)," \u2014 ").concat(s),keyBindingLabel:"".concat(a+1),"aria-label":kn(c),"aria-keyshortcuts":"".concat(l," ").concat(a+1),"data-testid":r,onChange:function(){n({elementType:r,multiElement:null,selectedElementIds:{}}),Ln(r),n({})}})})))},Ho=function(e){var t=e.renderAction,n=e.zoom;return i.a.createElement(xo,{gap:1},i.a.createElement(ko,{gap:1,align:"center"},t("zoomIn"),t("zoomOut"),t("resetZoom"),i.a.createElement("div",{style:{marginInlineStart:4}},(100*n).toFixed(0),"%")))},_o=function(e){var t=e.heading,n=e.children,a=Object(Ie.a)(e,["heading","children"]),r=i.a.createElement("h2",{className:"visually-hidden",id:"".concat(t,"-title")},an("headings.".concat(t)));return i.a.createElement("section",Object.assign({},a,{"aria-labelledby":"".concat(t,"-title")}),"function"===typeof n?n(r):i.a.createElement(i.a.Fragment,null,r,n))},Fo=(n(92),function(e){var t=e.activeRoomLink,n=e.username,a=e.onUsernameChange,r=e.onRoomCreate,l=e.onRoomDestroy,c=e.onPressingEnter,s=Object(o.useRef)(null);return i.a.createElement("div",{className:"RoomDialog-modal"},!t&&i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,an("roomDialog.desc_intro")),i.a.createElement("p",null,"\ud83d\udd12 ".concat(an("roomDialog.desc_privacy"))),i.a.createElement("div",{className:"RoomDialog-sessionStartButtonContainer"},i.a.createElement(sr,{className:"RoomDialog-startSession",type:"button",icon:Lr,title:an("roomDialog.button_startSession"),"aria-label":an("roomDialog.button_startSession"),showAriaLabel:!0,onClick:r}))),t&&i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,an("roomDialog.desc_inProgressIntro")),i.a.createElement("p",null,an("roomDialog.desc_shareLink")),i.a.createElement("div",{className:"RoomDialog-linkContainer"},i.a.createElement(sr,{type:"button",icon:gr,title:an("labels.copy"),"aria-label":an("labels.copy"),onClick:function(){Oa(t),s.current&&s.current.select()}}),i.a.createElement("input",{value:t,readOnly:!0,className:"RoomDialog-link",ref:s,onPointerDown:function(e){e.target!==document.activeElement&&(e.preventDefault(),e.target.select())}})),i.a.createElement("div",{className:"RoomDialog-usernameContainer"},i.a.createElement("label",{className:"RoomDialog-usernameLabel",htmlFor:"username"},an("labels.yourName")),i.a.createElement("input",{id:"username",value:n||"",className:"RoomDialog-username TextInput",onChange:function(e){return a(e.target.value)},onKeyPress:function(e){return"Enter"===e.key&&c()}})),i.a.createElement("p",null,"\ud83d\udd12 ".concat(an("roomDialog.desc_privacy"))),i.a.createElement("p",null,i.a.createElement("span",{role:"img","aria-hidden":"true"},"\u26a0\ufe0f")," ",an("roomDialog.desc_persistenceWarning")),i.a.createElement("p",null,an("roomDialog.desc_exitSession")),i.a.createElement("div",{className:"RoomDialog-sessionStartButtonContainer"},i.a.createElement(sr,{className:"RoomDialog-stopSession",type:"button",icon:Dr,title:an("roomDialog.button_stopSession"),"aria-label":an("roomDialog.button_stopSession"),showAriaLabel:!0,onClick:l}))))}),Uo=function(e){var t=e.isCollaborating,n=e.collaboratorCount,a=e.username,r=e.onUsernameChange,l=e.onRoomCreate,c=e.onRoomDestroy,s=Object(o.useState)(!1),u=Object(m.a)(s,2),d=u[0],p=u[1],h=Object(o.useState)(""),f=Object(m.a)(h,2),g=f[0],v=f[1],b=Object(o.useRef)(null),y=i.a.useCallback((function(){var e;p(!1),null===(e=b.current)||void 0===e||e.focus()}),[]);return Object(o.useEffect)((function(){v(t?window.location.href:"")}),[t]),i.a.createElement(i.a.Fragment,null,i.a.createElement(sr,{className:"RoomDialog-modalButton ".concat(t?"is-collaborating":""),onClick:function(){return p(!0)},icon:Ar,type:"button",title:an("buttons.roomDialog"),"aria-label":an("buttons.roomDialog"),showAriaLabel:Gn(),ref:b},n>0&&i.a.createElement("div",{className:"RoomDialog-modalButton-collaborators"},n)),d&&i.a.createElement(Mo,{maxWidth:800,onCloseRequest:y,title:an("labels.createRoom")},i.a.createElement(Fo,{activeRoomLink:g,username:a,onUsernameChange:r,onRoomCreate:l,onRoomDestroy:c,onPressingEnter:y})))},Wo=function(e){var t=e.appState,n=e.elements,a=e.actionManager,r=e.exportButton,o=e.setAppState,l=e.onRoomCreate,c=e.onUsernameChange,s=e.onRoomDestroy,h=e.onLockToggle,f=e.canvas;return i.a.createElement(i.a.Fragment,null,t.isLoading&&i.a.createElement(Fn,null),i.a.createElement(So,{side:"top"},i.a.createElement(_o,{heading:"shapes"},(function(e){return i.a.createElement(xo,{gap:4,align:"center"},i.a.createElement(ko,{gap:1},i.a.createElement(wo,{padding:1},e,i.a.createElement(ko,{gap:1},i.a.createElement(Bo,{elementType:t.elementType,setAppState:o}))),i.a.createElement(Io,{checked:t.elementLocked,onChange:h,title:an("toolBar.lock")})))})),i.a.createElement(No,{appState:t,elements:n})),i.a.createElement("div",{className:"App-bottom-bar",style:{marginBottom:14,marginLeft:14,marginRight:14}},i.a.createElement(wo,{padding:3},"canvas"===t.openMenu?i.a.createElement(_o,{className:"App-mobile-menu",heading:"canvasActions"},i.a.createElement("div",{className:"panelColumn"},i.a.createElement(xo,{gap:4},a.renderAction("loadScene"),a.renderAction("saveScene"),a.renderAction("saveAsScene"),r,a.renderAction("clearCanvas"),i.a.createElement(Uo,{isCollaborating:t.isCollaborating,collaboratorCount:t.collaborators.size,username:t.username,onUsernameChange:c,onRoomCreate:l,onRoomDestroy:s}),a.renderAction("changeViewBackgroundColor"),i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.language")),i.a.createElement(Po,{onChange:function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qt(t);case 2:o({});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),i.a.createElement("fieldset",null,i.a.createElement("legend",null,an("labels.collaborators")),i.a.createElement(Co,{mobile:!0},Array.from(t.collaborators).filter((function(e){var t=Object(m.a)(e,2),n=(t[0],t[1]);return 0!==Object.keys(n).length})).map((function(e){var t=Object(m.a)(e,2),n=t[0];t[1];return i.a.createElement(i.a.Fragment,{key:n},a.renderAction("goToCollaborator",n))}))))))):"shape"===t.openMenu&&Ft(t,n)?i.a.createElement(_o,{className:"App-mobile-menu",heading:"selectedShapeActions"},i.a.createElement(Ro,{appState:t,elements:n,renderAction:a.renderAction,elementType:t.elementType})):null,i.a.createElement("footer",{className:"App-toolbar"},i.a.createElement("div",{className:"App-toolbar-content"},a.renderAction("toggleCanvasMenu"),a.renderAction("toggleEditMenu"),a.renderAction("undo"),a.renderAction("redo"),a.renderAction(t.multiElement?"finalize":"duplicateSelection"),a.renderAction("deleteSelectedElements")),t.scrolledOutside&&i.a.createElement("button",{className:"scroll-back-to-content",onClick:function(){o(Object(p.a)({},dn(n,t,f)))}},an("buttons.scrollBackToContent"))))))},Yo=function(e){var t=e.message,n=e.onClose,a=Object(o.useState)(!!t),r=Object(m.a)(a,2),l=r[0],c=r[1],s=i.a.useCallback((function(){c(!1),n&&n()}),[n]);return i.a.createElement(i.a.Fragment,null,l&&i.a.createElement(Mo,{maxWidth:500,onCloseRequest:s,title:an("errorDialog.title")},i.a.createElement("div",null,t)))},Go=function(e){return i.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between"}},e.children)},Xo=function(e){return i.a.createElement("div",{style:{width:"49%"}},e.children)},Vo=function(e){return i.a.createElement("div",{style:{border:"1px solid ".concat(Vn.gray[4]),marginBottom:"16px"}},i.a.createElement("h3",{style:{margin:"0",padding:"4px",backgroundColor:Vn.gray[2],textAlign:"center"}},e.caption),e.children)},Ko=function(e){var t="rtl"===document.documentElement.getAttribute("dir");return i.a.createElement("div",{style:{borderTop:"1px solid ".concat(Vn.gray[4])}},i.a.createElement("div",{style:{display:"flex",margin:"0",padding:"4px 8px",alignItems:"center"}},i.a.createElement("div",{style:{lineHeight:1.4}},e.label),i.a.createElement("div",{style:{display:"flex",flex:"0 0 auto",justifyContent:"flex-end",marginLeft:t?"0em":"auto",marginRight:t?"auto":"0em",minWidth:"30%"}},e.shortcuts.map((function(t,n){return i.a.createElement(i.a.Fragment,{key:n},i.a.createElement(Zo,null,t),e.isOr&&n!==e.shortcuts.length-1&&an("shortcutsDialog.or"))})))))};Ko.defaultProps={isOr:!0};var Zo=function(e){return i.a.createElement("span",Object.assign({style:{wordBreak:"keep-all",border:"1px solid ".concat(Vn.gray[4]),padding:"2px 8px",margin:"auto 4px",backgroundColor:Vn.gray[2],borderRadius:"2px",fontSize:"0.8em",minHeight:"26px",boxSizing:"border-box",display:"flex",alignItems:"center"}},e))},qo=function(){return i.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-evenly",borderTop:"1px solid ".concat(Vn.gray[4]),marginTop:8,paddingTop:16}},i.a.createElement("a",{href:"https://blog.excalidraw.com",target:"_blank",rel:"noopener noreferrer"},an("shortcutsDialog.blog")),i.a.createElement("a",{href:"https://howto.excalidraw.com",target:"_blank",rel:"noopener noreferrer"},an("shortcutsDialog.howto")),i.a.createElement("a",{href:"https://github.com/excalidraw/excalidraw/issues",target:"_blank",rel:"noopener noreferrer"},an("shortcutsDialog.github")))},Jo=function(e){var t=e.onClose,n=i.a.useCallback((function(){t&&t()}),[t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Mo,{maxWidth:900,onCloseRequest:n,title:an("shortcutsDialog.title")},i.a.createElement(Go,null,i.a.createElement(Xo,null,i.a.createElement(Vo,{caption:an("shortcutsDialog.shapes")},i.a.createElement(Ko,{label:an("toolBar.selection"),shortcuts:["S","1"]}),i.a.createElement(Ko,{label:an("toolBar.rectangle"),shortcuts:["R","2"]}),i.a.createElement(Ko,{label:an("toolBar.diamond"),shortcuts:["D","3"]}),i.a.createElement(Ko,{label:an("toolBar.ellipse"),shortcuts:["E","4"]}),i.a.createElement(Ko,{label:an("toolBar.arrow"),shortcuts:["A","5"]}),i.a.createElement(Ko,{label:an("toolBar.line"),shortcuts:["L","6"]}),i.a.createElement(Ko,{label:an("toolBar.draw"),shortcuts:["X","7"]}),i.a.createElement(Ko,{label:an("toolBar.text"),shortcuts:["T","8"]}),i.a.createElement(Ko,{label:an("shortcutsDialog.textNewLine"),shortcuts:[zn("Enter"),zn("Shift+Enter")]}),i.a.createElement(Ko,{label:an("shortcutsDialog.textFinish"),shortcuts:[zn("Esc"),zn("CtrlOrCmd+Enter")]}),i.a.createElement(Ko,{label:an("shortcutsDialog.curvedArrow"),shortcuts:["A",an("shortcutsDialog.click"),an("shortcutsDialog.click"),an("shortcutsDialog.click")],isOr:!1}),i.a.createElement(Ko,{label:an("shortcutsDialog.curvedLine"),shortcuts:["L",an("shortcutsDialog.click"),an("shortcutsDialog.click"),an("shortcutsDialog.click")],isOr:!1}),i.a.createElement(Ko,{label:an("toolBar.lock"),shortcuts:["Q"]})),i.a.createElement(Vo,{caption:an("shortcutsDialog.view")},i.a.createElement(Ko,{label:an("buttons.zoomIn"),shortcuts:[zn("CtrlOrCmd++")]}),i.a.createElement(Ko,{label:an("buttons.zoomOut"),shortcuts:[zn("CtrlOrCmd+-")]}),i.a.createElement(Ko,{label:an("buttons.resetZoom"),shortcuts:[zn("CtrlOrCmd+0")]}),i.a.createElement(Ko,{label:an("shortcutsDialog.zoomToFit"),shortcuts:["Shift+1"]}),i.a.createElement(Ko,{label:an("buttons.toggleFullScreen"),shortcuts:["F"]}),i.a.createElement(Ko,{label:an("buttons.toggleZenMode"),shortcuts:[zn("Alt+Z")]}),i.a.createElement(Ko,{label:an("labels.toggleGridMode"),shortcuts:[zn("CtrlOrCmd+'")]}))),i.a.createElement(Xo,null,i.a.createElement(Vo,{caption:an("shortcutsDialog.editor")},i.a.createElement(Ko,{label:an("labels.selectAll"),shortcuts:[zn("CtrlOrCmd+A")]}),i.a.createElement(Ko,{label:an("labels.moveCanvas"),shortcuts:[zn("Space+".concat(an("shortcutsDialog.drag"))),zn("Wheel+".concat(an("shortcutsDialog.drag")))],isOr:!0}),i.a.createElement(Ko,{label:an("labels.copy"),shortcuts:[zn("CtrlOrCmd+C")]}),i.a.createElement(Ko,{label:an("labels.paste"),shortcuts:[zn("CtrlOrCmd+V")]}),i.a.createElement(Ko,{label:an("labels.copyAsPng"),shortcuts:[zn("Shift+Alt+C")]}),i.a.createElement(Ko,{label:an("labels.copyStyles"),shortcuts:[zn("CtrlOrCmd+Shift+C")]}),i.a.createElement(Ko,{label:an("labels.pasteStyles"),shortcuts:[zn("CtrlOrCmd+Shift+V")]}),i.a.createElement(Ko,{label:an("labels.delete"),shortcuts:[zn("Del")]}),i.a.createElement(Ko,{label:an("labels.sendToBack"),shortcuts:[zn(gt?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")]}),i.a.createElement(Ko,{label:an("labels.bringToFront"),shortcuts:[zn(gt?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")]}),i.a.createElement(Ko,{label:an("labels.sendBackward"),shortcuts:[zn("CtrlOrCmd+[")]}),i.a.createElement(Ko,{label:an("labels.bringForward"),shortcuts:[zn("CtrlOrCmd+]")]}),i.a.createElement(Ko,{label:an("labels.duplicateSelection"),shortcuts:[zn("CtrlOrCmd+D"),zn("Alt+".concat(an("shortcutsDialog.drag")))]}),i.a.createElement(Ko,{label:an("buttons.undo"),shortcuts:[zn("CtrlOrCmd+Z")]}),i.a.createElement(Ko,{label:an("buttons.redo"),shortcuts:[zn("CtrlOrCmd+Shift+Z")]}),i.a.createElement(Ko,{label:an("labels.group"),shortcuts:[zn("CtrlOrCmd+G")]}),i.a.createElement(Ko,{label:an("labels.ungroup"),shortcuts:[zn("CtrlOrCmd+Shift+G")]})))),i.a.createElement(qo,null)))},$o=i.a.memo((function(){return i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 250 250",className:"github-corner rtl-mirror"},i.a.createElement("a",{href:"https://github.com/excalidraw/excalidraw",target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub repository"},i.a.createElement("path",{d:"M0 0l115 115h15l12 27 108 108V0z",fill:Vn.gray[6]}),i.a.createElement("path",{className:"octo-arm",d:"M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16",style:{transformOrigin:"130px 106px"},fill:Vn.white}),i.a.createElement("path",{className:"octo-body",d:"M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z",fill:Vn.white})))})),Qo=(n(93),function(e){var t=e.children,n=e.label;return i.a.createElement("div",{className:"Tooltip"},i.a.createElement("span",{className:"Tooltip__label"},n),t)}),ei=(n(94),i.a.memo((function(e){var t=e.actionManager,n=e.appState,a=e.setAppState,r=e.canvas,o=e.elements,l=e.onRoomCreate,c=e.onUsernameChange,s=e.onRoomDestroy,h=e.onLockToggle,f=e.zenModeEnabled,g=e.toggleZenMode,v=Gn(),b=function(){var e=function(e){return function(t,a){r&&Za(e,t,n,r,{exportBackground:n.exportBackground,name:n.name,viewBackgroundColor:n.viewBackgroundColor,scale:a,shouldAddWatermark:n.shouldAddWatermark})}};return i.a.createElement(zo,{elements:o,appState:n,actionManager:t,onExportToPng:e("png"),onExportToSvg:e("svg"),onExportToClipboard:e("clipboard"),onExportToBackend:function(e){r&&Za("backend",e,Object(p.a)({},n,{selectedElementIds:{}}),r,n)}})};return v?i.a.createElement(Wo,{appState:n,elements:o,actionManager:t,exportButton:b(),setAppState:a,onUsernameChange:c,onRoomCreate:l,onRoomDestroy:s,onLockToggle:h,canvas:r}):i.a.createElement("div",{className:"layer-ui__wrapper"},n.isLoading&&i.a.createElement(Fn,null),n.errorMessage&&i.a.createElement(Yo,{message:n.errorMessage,onClose:function(){return a({errorMessage:null})}}),n.showShortcutsDialog&&i.a.createElement(Jo,{onClose:function(){return a({showShortcutsDialog:null})}}),function(){var e=Ft(n,o);return i.a.createElement(So,{side:"top"},i.a.createElement(No,{appState:n,elements:o}),i.a.createElement("div",{className:"App-menu App-menu_top"},i.a.createElement(xo,{gap:4,className:f&&"disable-pointerEvents"},i.a.createElement(_o,{heading:"canvasActions",className:"zen-mode-transition ".concat(f&&"transition-left")},i.a.createElement(wo,{padding:4,style:{zIndex:1}},i.a.createElement(xo,{gap:4},i.a.createElement(ko,{gap:1,justifyContent:"space-between"},t.renderAction("loadScene"),t.renderAction("saveScene"),t.renderAction("saveAsScene"),b(),t.renderAction("clearCanvas"),i.a.createElement(Uo,{isCollaborating:n.isCollaborating,collaboratorCount:n.collaborators.size,username:n.username,onUsernameChange:c,onRoomCreate:l,onRoomDestroy:s})),t.renderAction("changeViewBackgroundColor")))),e&&i.a.createElement(_o,{heading:"selectedShapeActions",className:"zen-mode-transition ".concat(f&&"transition-left")},i.a.createElement(wo,{className:P,padding:4},i.a.createElement(Ro,{appState:n,elements:o,renderAction:t.renderAction,elementType:n.elementType})))),i.a.createElement(_o,{heading:"shapes"},(function(e){return i.a.createElement(xo,{gap:4,align:"start"},i.a.createElement(ko,{gap:1},i.a.createElement(wo,{padding:1,className:f&&"zen-mode"},e,i.a.createElement(ko,{gap:1},i.a.createElement(Bo,{elementType:n.elementType,setAppState:a}))),i.a.createElement(Io,{zenModeEnabled:f,checked:n.elementLocked,onChange:h,title:an("toolBar.lock")})))})),i.a.createElement(Co,{className:"zen-mode-transition ".concat(f&&"transition-right")},Array.from(n.collaborators).filter((function(e){var t=Object(m.a)(e,2),n=(t[0],t[1]);return 0!==Object.keys(n).length})).map((function(e){var n=Object(m.a)(e,2),a=n[0],r=n[1];return i.a.createElement(Qo,{label:r.username||"Unknown user",key:a},t.renderAction("goToCollaborator",a))})))))}(),i.a.createElement("div",{className:"App-menu App-menu_bottom zen-mode-transition ".concat(f&&"App-menu_bottom--transition-left")},i.a.createElement(xo,{gap:2},i.a.createElement(_o,{heading:"canvasActions"},i.a.createElement(wo,{padding:1},i.a.createElement(Ho,{renderAction:t.renderAction,zoom:n.zoom})),i.a.createElement("a",{className:"encrypted-icon tooltip zen-mode-visibility ".concat(f?"zen-mode-visibility--hidden":""),href:"https://blog.excalidraw.com/end-to-end-encryption/",target:"_blank",rel:"noopener noreferrer"},i.a.createElement("span",{className:"tooltip-text",dir:"auto"},an("encrypted.tooltip")),Rr)))),i.a.createElement("aside",{className:"layer-ui__wrapper__github-corner zen-mode-transition ".concat(f&&"transition-right")},i.a.createElement($o,null)),i.a.createElement("footer",{role:"contentinfo",className:"layer-ui__wrapper__footer"},i.a.createElement("div",{className:"zen-mode-transition ".concat(f&&"transition-right disable-pointerEvents")},i.a.createElement(Po,{onChange:function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qt(t);case 2:a({});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),languages:Zt,floating:!0}),t.renderAction("toggleShortcuts")),i.a.createElement("button",{className:"disable-zen-mode ".concat(f&&"disable-zen-mode--visible"),onClick:g},an("buttons.exitZenMode")),n.scrolledOutside&&i.a.createElement("button",{className:"scroll-back-to-content",onClick:function(){a(Object(p.a)({},dn(o,n,r)))}},an("buttons.scrollBackToContent"))))}),(function(e,t){var n=function(e){e.draggingElement,e.resizingElement,e.multiElement,e.editingElement,e.isResizing,e.cursorX,e.cursorY;return Object(Ie.a)(e,["draggingElement","resizingElement","multiElement","editingElement","isResizing","cursorX","cursorY"])},a=n(e.appState),r=n(t.appState),o=Object.keys(a);return e.lng===t.lng&&e.elements===t.elements&&o.every((function(e){return a[e]===r[e]}))}))),ti=n(36),ni=n.n(ti),ai=function(e){return function(t){Object(l.unstable_batchedUpdates)(e,t)}},ri={history:new tr}.history,oi=!1,ii=0,li=0,ci=0,si=!1,ui=!1,di=!1,mi={horizontal:null,vertical:null},pi=0,hi=!1,fi=null,gi={pointers:new Map,lastCenter:null,initialDistance:null,initialScale:null},vi=function(e){Object(v.a)(o,e);var t=Object(g.a)(o);function o(e){var l,c;return Object(h.a)(this,o),(l=t.call(this,e)).canvas=null,l.rc=null,l.portal=new Ja(Object(Xn.a)(l)),l.lastBroadcastedOrReceivedSceneVersion=-1,l.broadcastedElementVersions=new Map,l.removeSceneCallback=null,l.unmounted=!1,l.actionManager=void 0,l.state=Object(p.a)({},Kn(),{isLoading:!0}),l.syncActionResult=ai((function(e){if(!l.unmounted){var t=null;e.elements&&(e.elements.forEach((function(e){var n;(null===(n=l.state.editingElement)||void 0===n?void 0:n.id)===e.id&&l.state.editingElement!==e&&Gt(e)&&(t=e)})),bn.replaceAllElements(e.elements),e.commitToHistory&&ri.resumeRecording()),(e.appState||t)&&(e.commitToHistory&&ri.resumeRecording(),l.setState((function(n){var a;return Object(p.a)({},e.appState,{editingElement:t||(null===(a=e.appState)||void 0===a?void 0:a.editingElement)||null,isCollaborating:n.isCollaborating,collaborators:n.collaborators})}),(function(){e.syncHistory&&ri.setCurrentState(l.state,bn.getElementsIncludingDeleted())})))}})),l.onBlur=ai((function(){si=!1,l.saveDebounced(),l.saveDebounced.flush()})),l.onUnload=function(){l.destroySocketClient(),l.onBlur()},l.disableEvent=function(e){e.preventDefault()},l.onFontLoaded=function(){bn.getElementsIncludingDeleted().forEach((function(e){E(e)&&ue(e)})),l.onSceneUpdated()},l.initializeScene=Object(d.a)(u.a.mark((function e(){var t,n,a,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new URLSearchParams(window.location.search),n=t.get("id"),a=window.location.hash.match(/^#json=([0-9]+),([a-zA-Z0-9_-]+)$/),r=Ua(window.location.href)){e.next=21;break}if(!n){e.next=11;break}return e.next=8,qa(n);case 8:o=e.sent,e.next=20;break;case 11:if(!a){e.next=17;break}return e.next=14,qa(a[1],a[2]);case 14:o=e.sent,e.next=20;break;case 17:return e.next=19,qa(null);case 19:o=e.sent;case 20:o&&l.syncActionResult(o);case 21:l.state.isLoading&&l.setState({isLoading:!1}),r&&l.initializeSocketClient({showLoadingState:!0});case 23:case"end":return e.stop()}}),e)}))),l.onResize=ai((function(){bn.getElementsIncludingDeleted().forEach((function(e){return ue(e)})),l.setState({})})),l.beforeUnload=ai((function(e){l.state.isCollaborating&&bn.getElements().length>0&&(e.preventDefault(),e.returnValue="")})),l.queueBroadcastAllElements=ni()((function(){l.broadcastScene(a.UPDATE,!0)}),2e4),l.onCut=ai((function(e){xn(e.target)||(l.copyAll(),l.actionManager.executeAction(Fr),e.preventDefault())})),l.onCopy=ai((function(e){xn(e.target)||(l.copyAll(),e.preventDefault())})),l.copyAll=function(){wa(bn.getElements(),l.state)},l.copyToClipboardAsPng=function(){var e=bn.getElements(),t=sn(e,l.state);Za("clipboard",t.length?t:e,l.state,l.canvas,l.state)},l.copyToClipboardAsSvg=function(){var e=sn(bn.getElements(),l.state);Za("clipboard-svg",e.length?e:bn.getElements(),l.state,l.canvas,l.state)},l.onTapStart=function(e){if(!oi)return oi=!0,clearTimeout(ii),void(ii=window.setTimeout(o.resetTapTwice,300));if(oi&&1===e.touches.length){var t=Object(m.a)(e.touches,1)[0];l.handleCanvasDoubleClick({clientX:t.clientX,clientY:t.clientY}),oi=!1,clearTimeout(ii)}e.preventDefault(),2===e.touches.length&&l.setState({selectedElementIds:{}})},l.onTapEnd=function(e){if(e.preventDefault(),e.touches.length>0){var t=l.state.previousSelectedElementIds;l.setState({previousSelectedElementIds:{},selectedElementIds:t})}},l.pasteFromClipboard=ai(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.activeElement,a=document.elementFromPoint(li,ci),!t||a instanceof HTMLCanvasElement&&!xn(n)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,xa(l.state,li,ci,t);case 6:(r=e.sent).error?alert(r.error):r.elements?l.addElementsFromPaste(r.elements):r.text&&l.addTextFromPaste(r.text),l.selectShapeTool("selection"),null===t||void 0===t||t.preventDefault();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l.addElementsFromPaste=function(e){var t=te(e),n=Object(m.a)(t,4),a=n[0],r=n[1],o=n[2],i=n[3],c=Mn(a,o)/2,s=Mn(r,i)/2,u=Pn({clientX:li,clientY:ci},l.state,l.canvas,window.devicePixelRatio),d=u.x,p=u.y,h=d-c,f=p-s,g=new Map,v=e.map((function(e){return Ue(l.state.editingGroupId,g,e,{x:e.x+h-a,y:e.y+f-r})}));bn.replaceAllElements([].concat(Object(y.a)(bn.getElementsIncludingDeleted()),Object(y.a)(v))),ri.resumeRecording(),l.setState({selectedElementIds:v.reduce((function(e,t){return e[t.id]=!0,e}),{})})},l.setAppState=function(e){l.setState(e)},l.removePointer=function(e){"touch"===e.pointerType&&pi&&(clearTimeout(pi),hi=!1),gi.pointers.delete(e.pointerId)},l.openPortal=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=window.history,e.t1={},e.next=4,Wa();case 4:e.t2=e.sent,e.t0.pushState.call(e.t0,e.t1,"Excalidraw",e.t2),l.initializeSocketClient({showLoadingState:!1});case 7:case"end":return e.stop()}}),e)}))),l.closePortal=function(){window.history.pushState({},"Excalidraw",window.location.origin),l.destroySocketClient()},l.toggleLock=function(){l.setState((function(e){return{elementLocked:!e.elementLocked,elementType:e.elementLocked?"selection":e.elementType}}))},l.toggleZenMode=function(){l.setState({zenModeEnabled:!l.state.zenModeEnabled})},l.toggleGridMode=function(){l.setState({gridSize:l.state.gridSize?null:20})},l.destroySocketClient=function(){l.setState({isCollaborating:!1,collaborators:new Map}),l.portal.close()},l.initializeSocketClient=function(){var e=Object(d.a)(u.a.mark((function e(t){var r,o,i,c,s,m;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.portal.socket){e.next=2;break}return e.abrupt("return");case 2:if(!(r=Ua(window.location.href))){e.next=15;break}return o=function(){l.portal.socketInitialized=!0,clearTimeout(i),l.state.isLoading&&!l.unmounted&&l.setState({isLoading:!1})},i=setTimeout(o,5e3),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.scrollToContent,a=void 0!==n&&n,r=e.payload.elements;if(a&&l.setState(Object(p.a)({},l.state,{},dn(r.filter((function(e){return!e.isDeleted})),l.state,l.canvas))),null==bn.getElementsIncludingDeleted()||0===bn.getElementsIncludingDeleted().length)bn.replaceAllElements(r);else{var i,c=Ut(bn.getElementsIncludingDeleted()),s=(i=r.reduce((function(e,t){var n,a,r;return t.id===(null===(n=l.state.editingElement)||void 0===n?void 0:n.id)||t.id===(null===(a=l.state.resizingElement)||void 0===a?void 0:a.id)||t.id===(null===(r=l.state.draggingElement)||void 0===r?void 0:r.id)||(c.hasOwnProperty(t.id)&&c[t.id].version>t.version?(e.push(c[t.id]),delete c[t.id]):c.hasOwnProperty(t.id)&&c[t.id].version===t.version&&c[t.id].versionNonce!==t.versionNonce?(c[t.id].versionNonce<t.versionNonce?e.push(c[t.id]):e.push(t),delete c[t.id]):(e.push(t),delete c[t.id])),e}),[])).concat.apply(i,Object(y.a)(Object.values(c)));l.lastBroadcastedOrReceivedSceneVersion=Wt(s),bn.replaceAllElements(s)}ri.clear(),l.portal.socketInitialized||o()},e.next=9,Promise.all([n.e(30),n.e(29)]).then(n.t.bind(null,160,7));case 9:s=e.sent,m=s.default,l.portal.open(m("https://excalidraw-socket.herokuapp.com"),r[1],r[2]),l.portal.socket.on("client-broadcast",function(){var e=Object(d.a)(u.a.mark((function e(t,n){var r,o,i,s,d,m,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.portal.roomKey){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Xa(t,l.portal.roomKey,n);case 4:r=e.sent,e.t0=r.type,e.next="INVALID_RESPONSE"===e.t0?8:e.t0===a.INIT?9:e.t0===a.UPDATE?11:"MOUSE_LOCATION"===e.t0?13:16;break;case 8:return e.abrupt("return");case 9:return l.portal.socketInitialized||c(r,{scrollToContent:!0}),e.abrupt("break",16);case 11:return c(r),e.abrupt("break",16);case 13:return o=r.payload,i=o.socketID,s=o.pointerCoords,d=o.button,m=o.username,p=o.selectedElementIds,l.setState((function(e){e.collaborators.has(i)||e.collaborators.set(i,{});var t=e.collaborators.get(i);return t.pointer=s,t.button=d,t.selectedElementIds=p,t.username=m,e.collaborators.set(i,t),e})),e.abrupt("break",16);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),l.portal.socket.on("first-in-room",(function(){l.portal.socket&&l.portal.socket.off("first-in-room"),o()})),l.setState({isCollaborating:!0,isLoading:!!t.showLoadingState||l.state.isLoading});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l.broadcastMouseLocation=function(e){var t;if(null===(t=l.portal.socket)||void 0===t?void 0:t.id){var n={type:"MOUSE_LOCATION",payload:{socketID:l.portal.socket.id,pointerCoords:e.pointerCoords,button:e.button||"up",selectedElementIds:l.state.selectedElementIds,username:l.state.username}};return l.portal._broadcastSocketData(n,!0)}},l.broadcastScene=function(e,t){if(e===a.INIT&&!t)throw new Error("syncAll must be true when sending SCENE.INIT");var n=bn.getElementsIncludingDeleted().filter((function(e){return e.isDeleted||!Se(e)}));t||(n=n.filter((function(e){return!l.broadcastedElementVersions.has(e.id)||e.version>l.broadcastedElementVersions.get(e.id)})));var r={type:e,payload:{elements:n}};l.lastBroadcastedOrReceivedSceneVersion=Math.max(l.lastBroadcastedOrReceivedSceneVersion,Wt(bn.getElementsIncludingDeleted()));var o,i=Object(k.a)(n);try{for(i.s();!(o=i.n()).done;){var c=o.value;l.broadcastedElementVersions.set(c.id,c.version)}}catch(s){i.e(s)}finally{i.f()}return l.portal._broadcastSocketData(r)},l.onSceneUpdated=function(){l.setState({})},l.updateCurrentCursorPosition=ai((function(e){li=e.x,ci=e.y})),l.onKeyDown=ai((function(e){if((!e[Ct]||!e.shiftKey||"C"!==e.key)&&!(xn(e.target)&&e.key!==kt||zt(e.key)&&(t=e.target,t instanceof HTMLElement&&"wysiwyg"===t.dataset.type||t instanceof HTMLBRElement||t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement))){var t;if(e.key===jt&&l.setState({showShortcutsDialog:!0}),!e[Ct]&&e.altKey&&e.keyCode===At&&l.toggleZenMode(),e[Ct]&&e.keyCode===Lt&&l.toggleGridMode(),"KeyC"===e.code&&e.altKey&&e.shiftKey)return l.copyToClipboardAsPng(),void e.preventDefault();if(!l.actionManager.handleKeyDown(e)){var n=function(e){var t;return(null===(t=$a.find((function(t,n){return t.key===e.toLowerCase()||e===(n+1).toString()})))||void 0===t?void 0:t.value)||"selection"}(e.key);if(zt(e.key)){var a=l.state.gridSize&&(e.shiftKey?1:l.state.gridSize)||(e.shiftKey?5:1);bn.replaceAllElements(bn.getElementsIncludingDeleted().map((function(t){if(l.state.selectedElementIds[t.id]){var n={};return e.key===vt?n.x=t.x-a:e.key===bt?n.x=t.x+a:e.key===Et?n.y=t.y-a:e.key===yt&&(n.y=t.y+a),xe(t,n)}return t}))),e.preventDefault()}else if(e.key===wt){var r=sn(bn.getElements(),l.state);if(1===r.length&&w(r[0]))l.state.editingLinearElement&&l.state.editingLinearElement.elementId===r[0].id||(ri.resumeRecording(),l.setState({editingLinearElement:new ea(r[0])}));else if(1===r.length&&!w(r[0])){var o=r[0];return l.startTextEditing({sceneX:o.x+o.width/2,sceneY:o.y+o.height/2}),void e.preventDefault()}}else e.ctrlKey||e.altKey||e.metaKey||null!==l.state.draggingElement||(Qa.includes(e.key.toLowerCase())?l.selectShapeTool(n):"q"===e.key&&l.toggleLock());e.key===It&&0===gi.pointers.size&&(si=!0,document.documentElement.style.cursor=O)}}})),l.onKeyUp=ai((function(e){e.key===It&&("selection"===l.state.elementType?An():(Ln(l.state.elementType),l.setState({selectedElementIds:{},selectedGroupIds:{},editingGroupId:null})),si=!1)})),l.onGestureStart=ai((function(e){e.preventDefault(),l.setState({selectedElementIds:{}}),gi.initialScale=l.state.zoom})),l.onGestureChange=ai((function(e){e.preventDefault(),l.setState({zoom:vn(gi.initialScale*e.scale)})})),l.onGestureEnd=ai((function(e){e.preventDefault();var t=l.state.previousSelectedElementIds;l.setState({previousSelectedElementIds:{},selectedElementIds:t}),gi.initialScale=null})),l.setElements=function(e){bn.replaceAllElements(e)},l.startTextEditing=function(e){var t=e.sceneX,n=e.sceneY,a=e.insertAtParentCenter,r=void 0===a||a,o=l.getTextElementAtPosition(t,n),i=r&&l.getTextWysiwygSnappedToCenterPosition(t,n,l.state,l.canvas,window.devicePixelRatio),c=o||He({x:i?i.elementCenterX:t,y:i?i.elementCenterY:n,strokeColor:l.state.currentItemStrokeColor,backgroundColor:l.state.currentItemBackgroundColor,fillStyle:l.state.currentItemFillStyle,strokeWidth:l.state.currentItemStrokeWidth,strokeStyle:l.state.currentItemStrokeStyle,roughness:l.state.currentItemRoughness,opacity:l.state.currentItemOpacity,text:"",fontSize:l.state.currentItemFontSize,fontFamily:l.state.currentItemFontFamily,textAlign:i?"center":l.state.currentItemTextAlign,verticalAlign:i?"middle":"top"});l.setState({editingElement:c}),o?i&&"center"===c.textAlign||ke(c,{verticalAlign:"top"}):(bn.replaceAllElements([].concat(Object(y.a)(bn.getElementsIncludingDeleted()),[c])),i||ke(c,{y:c.y-c.baseline/2})),l.setState({editingElement:c}),l.handleTextWysiwyg(c,{isExistingElement:!!o})},l.handleCanvasDoubleClick=function(e){if(!l.state.multiElement){var t=sn(bn.getElements(),l.state);if(1===t.length&&w(t[0]))l.state.editingLinearElement&&l.state.editingLinearElement.elementId===t[0].id||(ri.resumeRecording(),l.setState({editingLinearElement:new ea(t[0])}));else{An();var n=Pn(e,l.state,l.canvas,window.devicePixelRatio),a=n.x,r=n.y;if(Ae(l.state).length>0){var o=bn.getElements(),i=fn(o,l.state,a,r,l.state.zoom),c=i&&function(e,t){return e.groupIds.find((function(e){return t[e]}))}(i,l.state.selectedGroupIds);if(c)return void l.setState((function(e){return Le(Object(p.a)({},e,{editingGroupId:c,selectedElementIds:Object(je.a)({},i.id,!0),selectedGroupIds:{}}),bn.getElements())}))}An(),l.startTextEditing({sceneX:a,sceneY:r,insertAtParentCenter:!e.altKey})}}},l.handleCanvasPointerMove=function(e){if(l.savePointer(e.clientX,e.clientY,l.state.cursorButton),gi.pointers.has(e.pointerId)&&gi.pointers.set(e.pointerId,{x:e.clientX,y:e.clientY}),2===gi.pointers.size){var t=go(gi.pointers),n=t.x-gi.lastCenter.x,a=t.y-gi.lastCenter.y;gi.lastCenter=t;var r=vo(Array.from(gi.pointers.values()))/gi.initialDistance;l.setState({scrollX:un(l.state.scrollX+n/l.state.zoom),scrollY:un(l.state.scrollY+a/l.state.zoom),zoom:vn(gi.initialScale*r),shouldCacheIgnoreZoom:!0}),l.resetShouldCacheIgnoreZoomDebounced()}else gi.lastCenter=gi.initialDistance=gi.initialScale=null;if(!(si||ui||di)){var o=ln(mi,e.clientX,e.clientY),i=o.isOverHorizontalScrollBar,c=o.isOverVerticalScrollBar||i;l.state.draggingElement||l.state.multiElement||(c?An():Ln(l.state.elementType));var s=Pn(e,l.state,l.canvas,window.devicePixelRatio),u=s.x,d=s.y;if(l.state.editingLinearElement&&null===l.state.editingLinearElement.draggingElementPointIndex){var m=ea.handlePointerMove(e,u,d,l.state.editingLinearElement);m!==l.state.editingLinearElement&&l.setState({editingLinearElement:m})}if(l.state.multiElement){var p=l.state.multiElement,h=p.x,f=p.y,g=p.points,v=p.lastCommittedPoint,b=g[g.length-1];return Ln(l.state.elementType),void(b===v?F(u-h,d-f,b[0],b[1])>=10?ke(p,{points:[].concat(Object(y.a)(g),[[u-h,d-f]])}):document.documentElement.style.cursor=I:g.length>2&&v&&F(u-h,d-f,v[0],v[1])<10?(document.documentElement.style.cursor=I,ke(p,{points:g.slice(0,-1)})):(U(g)&&(document.documentElement.style.cursor=I),ke(p,{points:[].concat(Object(y.a)(g.slice(0,-1)),[[u-h,d-f]])})))}if(!(Boolean(e.buttons)||"selection"!==l.state.elementType&&"text"!==l.state.elementType)){var w=bn.getElements(),k=sn(w,l.state);if(1!==k.length||c||l.state.editingLinearElement){if(k.length>1&&!c){var x=rt(te(k),u,d,l.state.zoom,e.pointerType);if(x)return void(document.documentElement.style.cursor=it({resizeHandle:x}))}}else{var O=at(w,l.state,u,d,l.state.zoom,e.pointerType);if(O&&O.resizeHandle)return void(document.documentElement.style.cursor=it(O))}var j=fn(w,l.state,u,d,l.state.zoom);"text"===l.state.elementType?document.documentElement.style.cursor=E(j)?S:C:document.documentElement.style.cursor=j&&!c?"move":""}}},l.handleTouchMove=function(e){hi=!0},l.handleCanvasPointerDown=function(e){if(e.persist(),"touch"===e.pointerType&&(hi=!1,pi=window.setTimeout((function(){hi||l.openContextMenu({clientX:e.clientX,clientY:e.clientY})}),500)),null!==fi&&fi(e),!ui){if(l.setState({lastPointerDownWith:e.pointerType,cursorButton:"down"}),l.savePointer(e.clientX,e.clientY,"down"),0===gi.pointers.size&&(e.button===T||e.button===j&&si)){ui=!0;var t=!1,n=/Linux/.test(window.navigator.platform);document.documentElement.style.cursor=O;var a=e.clientX,o=e.clientY,i=ai((function(e){var i=a-e.clientX,c=o-e.clientY;if(a=e.clientX,o=e.clientY,n&&!t&&(Math.abs(i)>1||Math.abs(c)>1)){t=!0;var s=function e(t){document.body.removeEventListener(r.PASTE,e),t.stopPropagation()};document.body.addEventListener(r.PASTE,s),window.addEventListener(r.POINTER_UP,(function e(){setTimeout((function(){document.body.removeEventListener(r.PASTE,s),window.removeEventListener(r.POINTER_UP,e)}),100)}))}l.setState({scrollX:un(l.state.scrollX-i/l.state.zoom),scrollY:un(l.state.scrollY-c/l.state.zoom)})})),c=ai(fi=function(){fi=null,ui=!1,si||Ln(l.state.elementType),l.setState({cursorButton:"up"}),l.savePointer(e.clientX,e.clientY,"up"),window.removeEventListener(r.POINTER_MOVE,i),window.removeEventListener(r.POINTER_UP,c),window.removeEventListener(r.BLUR,c)});return window.addEventListener(r.BLUR,c),window.addEventListener(r.POINTER_MOVE,i,{passive:!0}),void window.addEventListener(r.POINTER_UP,c)}if((e.button===j||e.button===M)&&(gi.pointers.set(e.pointerId,{x:e.clientX,y:e.clientY}),2===gi.pointers.size&&(gi.lastCenter=go(gi.pointers),gi.initialScale=l.state.zoom,gi.initialDistance=vo(Array.from(gi.pointers.values()))),e.preventDefault(),document.activeElement instanceof HTMLElement&&document.activeElement.blur(),!(gi.pointers.size>1))){var s=ln(mi,e.clientX,e.clientY),u=s.isOverHorizontalScrollBar,d=s.isOverVerticalScrollBar,h=Pn(e,l.state,l.canvas,window.devicePixelRatio),f=h.x,g=h.y,v=f,b=g;if((u||d)&&!l.state.multiElement){di=!0,v=e.clientX,b=e.clientY;var x=ai((function(e){if(e.target instanceof HTMLElement){if(u){var t=e.clientX,n=t-v;return l.setState({scrollX:un(l.state.scrollX-n/l.state.zoom)}),void(v=t)}if(d){var a=e.clientY,r=a-b;l.setState({scrollY:un(l.state.scrollY-r/l.state.zoom)}),b=a}}})),S=ai((function(){di=!1,Ln(l.state.elementType),fi=null,l.setState({cursorButton:"up"}),l.savePointer(e.clientX,e.clientY,"up"),window.removeEventListener(r.POINTER_MOVE,x),window.removeEventListener(r.POINTER_UP,S)}));return fi=S,window.addEventListener(r.POINTER_MOVE,x),void window.addEventListener(r.POINTER_UP,S)}var C,A=f,L=g,D=X(A,L,l.state.gridSize),z=Object(m.a)(D,2),P=z[0],N=z[1],R=!1,B=function(e){R=e},_=[0,0],W="origin",Y=!1,G=!1,V=null,K=null,q=!1;if("selection"===l.state.elementType){var J=bn.getElements(),$=sn(J,l.state);if(1!==$.length||l.state.editingLinearElement)$.length>1&&(R=rt(te($),f,g,l.state.zoom,e.pointerType))&&(document.documentElement.style.cursor=it({resizeHandle:R}),Y=!0);else{var Q=at(J,l.state,f,g,l.state.zoom,e.pointerType);Q&&(l.setState({resizingElement:Q?Q.element:null}),R=Q.resizeHandle,document.documentElement.style.cursor=it(Q),Y=!0)}if(Y&&(_=function(e,t,n,a){var r=1===t.length?Z(t[0]):te(t),o=Object(m.a)(r,4),i=o[0],l=o[1],c=o[2],s=o[3],u=(i+c)/2,d=(l+s)/2,p=1===t.length?t[0].angle:0,h=H(n,a,u,d,-p),f=Object(m.a)(h,2);switch(n=f[0],a=f[1],e){case"n":return H(n-(i+c)/2,a-l,0,0,p);case"s":return H(n-(i+c)/2,a-s,0,0,p);case"w":return H(n-i,a-(l+s)/2,0,0,p);case"e":return H(n-c,a-(l+s)/2,0,0,p);case"nw":return H(n-i,a-l,0,0,p);case"ne":return H(n-c,a-l,0,0,p);case"sw":return H(n-i,a-s,0,0,p);case"se":return H(n-c,a-s,0,0,p);default:return[0,0]}}(R,$,f,g),1===$.length&&w($[0])&&2===$[0].points.length&&(W=function(e,t){var n=Object(m.a)(t.points,2),a=Object(m.a)(n[1],2),r=a[0],o=a[1];return"nw"===e&&(r<0||o<0)||"ne"===e&&r>=0||"sw"===e&&r<=0||"se"===e&&(r>0||o>0)?"end":"origin"}(R,$[0]))),!Y){if(l.state.editingLinearElement){var ne=ea.handlePointerDown(e,l.state,(function(e){return l.setState(e)}),ri,f,g);if(ne.hitElement&&(K=ne.hitElement),ne.didAddPoint)return}if((!(K=K||fn(J,l.state,f,g,l.state.zoom))||!l.state.selectedElementIds[K.id])&&!e.shiftKey){l.setState((function(e){return{selectedElementIds:{},selectedGroupIds:{},editingGroupId:e.editingGroupId&&K&&De(K,e.editingGroupId)?e.editingGroupId:null}}));var ae=l.state.selectedElementIds;l.setState({selectedElementIds:{},previousSelectedElementIds:ae})}if(K&&!l.state.selectedElementIds[K.id]){if(l.state.editingGroupId&&!De(K,l.state.editingGroupId))return void l.setState({selectedElementIds:{},selectedGroupIds:{},editingGroupId:null});l.setState((function(e){return Le(Object(p.a)({},e,{selectedElementIds:Object(p.a)({},e.selectedElementIds,Object(je.a)({},K.id,!0))}),bn.getElements())})),bn.replaceAllElements(bn.getElementsIncludingDeleted()),q=!0}var re=l.state.selectedElementIds;l.setState({previousSelectedElementIds:re})}}else l.setState({selectedElementIds:{},selectedGroupIds:{},editingGroupId:null});if("text"===l.state.elementType){var oe;if("text"===(null===(oe=l.state.editingElement)||void 0===oe?void 0:oe.type))return;return l.startTextEditing({sceneX:f,sceneY:g,insertAtParentCenter:!e.altKey}),An(),void(l.state.elementLocked||l.setState({elementType:"selection"}))}if("arrow"===l.state.elementType||"draw"===l.state.elementType||"line"===l.state.elementType)if(l.state.multiElement){var ie=l.state.multiElement;if("line"===ie.type&&U(ie.points))return ke(ie,{lastCommittedPoint:ie.points[ie.points.length-1]}),void l.actionManager.executeAction(so);var le=ie.x,ce=ie.y,se=ie.lastCommittedPoint;if(ie.points.length>1&&se&&F(f-le,g-ce,se[0],se[1])<10)return void l.actionManager.executeAction(so);l.setState((function(e){return{selectedElementIds:Object(p.a)({},e.selectedElementIds,Object(je.a)({},ie.id,!0))}})),ke(ie,{lastCommittedPoint:ie.points[ie.points.length-1]}),document.documentElement.style.cursor=I}else{var ue=X(f,g,"draw"===l.state.elementType?null:l.state.gridSize),de=Object(m.a)(ue,2),me=de[0],pe=de[1],he=(C={type:l.state.elementType,x:me,y:pe,strokeColor:l.state.currentItemStrokeColor,backgroundColor:l.state.currentItemBackgroundColor,fillStyle:l.state.currentItemFillStyle,strokeWidth:l.state.currentItemStrokeWidth,strokeStyle:l.state.currentItemStrokeStyle,roughness:l.state.currentItemRoughness,opacity:l.state.currentItemOpacity},Object(p.a)({},Ne(C.type,C),{points:[],lastCommittedPoint:C.lastCommittedPoint||null}));l.setState((function(e){return{selectedElementIds:Object(p.a)({},e.selectedElementIds,Object(je.a)({},he.id,!1))}})),ke(he,{points:[].concat(Object(y.a)(he.points),[[0,0]])}),bn.replaceAllElements([].concat(Object(y.a)(bn.getElementsIncludingDeleted()),[he])),l.setState({draggingElement:he,editingElement:he})}else{var fe=X(f,g,l.state.gridSize),ge=Object(m.a)(fe,2),ve=ge[0],be=ge[1],ye=Re({type:l.state.elementType,x:ve,y:be,strokeColor:l.state.currentItemStrokeColor,backgroundColor:l.state.currentItemBackgroundColor,fillStyle:l.state.currentItemFillStyle,strokeWidth:l.state.currentItemStrokeWidth,strokeStyle:l.state.currentItemStrokeStyle,roughness:l.state.currentItemRoughness,opacity:l.state.currentItemOpacity});"selection"===ye.type?l.setState({selectionElement:ye,draggingElement:ye}):(bn.replaceAllElements([].concat(Object(y.a)(bn.getElementsIncludingDeleted()),[ye])),l.setState({multiElement:null,draggingElement:ye,editingElement:ye}))}var Ee=!1,we=ai((function(e){if(null===V&&(V=function(e,t,n){var a=te(e),r=Object(m.a)(a,2);return[t-r[0],n-r[1]]}(sn(bn.getElements(),l.state),A,L)),e.target instanceof HTMLElement){if(u){var t=e.clientX,n=t-v;return l.setState({scrollX:un(l.state.scrollX-n/l.state.zoom)}),void(v=t)}if(d){var a=e.clientY,r=a-b;return l.setState({scrollY:un(l.state.scrollY-r/l.state.zoom)}),void(b=a)}var o=Pn(e,l.state,l.canvas,window.devicePixelRatio),i=o.x,c=o.y,s=X(i,c,l.state.gridSize),h=Object(m.a)(s,2),f=h[0],g=h[1];if(G||"arrow"!==l.state.elementType&&"line"!==l.state.elementType||!(F(i,c,A,L)<10)){if(Y){var E=sn(bn.getElements(),l.state);l.setState({isResizing:R&&"rotation"!==R,isRotating:"rotation"===R});var x=X(i-_[0],c-_[1],l.state.gridSize),S=Object(m.a)(x,2),C=S[0],O=S[1];if(function(e,t,n,a,r,o,i,l,c){if(1===n.length){var s=Object(m.a)(n,1)[0];return"rotation"===e?lt(s,l,c,r):!w(s)||2!==s.points.length||"nw"!==e&&"ne"!==e&&"sw"!==e&&"se"!==e?"text"!==s.type||"nw"!==e&&"ne"!==e&&"sw"!==e&&"se"!==e?e&&(pt(s,e,o,i,l,c),t(function(e,t){if(e.width>=0&&e.height>=0)return t;if(e.width<0&&e.height<0)switch(t){case"nw":return"se";case"ne":return"sw";case"se":return"nw";case"sw":return"ne"}else if(e.width<0)switch(t){case"nw":return"ne";case"ne":return"nw";case"se":return"sw";case"sw":return"se";case"e":return"w";case"w":return"e"}else switch(t){case"nw":return"sw";case"ne":return"se";case"se":return"ne";case"sw":return"nw";case"n":return"s";case"s":return"n"}return t}(s,e)),s.width<0&&ke(s,{width:-s.width}),s.height<0&&ke(s,{height:-s.height})):mt(s,e,i,l,c):ct(s,a,r,l,c),document.documentElement.style.cursor=it({element:s,resizeHandle:e}),!0}return n.length>1&&("nw"===e||"ne"===e||"sw"===e||"se"===e)&&(ht(n,e,l,c),!0)}(R,B,E,W,Rt(e),Nt(e),Pt(e),C,O))return}if(l.state.editingLinearElement)if(ea.handlePointDragging(l.state,(function(e){return l.setState(e)}),i,c,v,b))return v=i,void(b=c);if(K&&l.state.selectedElementIds[K.id]){G=!0;var I=sn(bn.getElements(),l.state);if(I.length>0){var j=X(i-V[0],c-V[1],l.state.gridSize),T=Object(m.a)(j,2),M=T[0],D=T[1];if(function(e,t,n){var a=te(e),r=Object(m.a)(a,2),o=r[0],i=r[1];e.forEach((function(e){ke(e,{x:t+e.x-o,y:n+e.y-i})}))}(I,M,D),e.altKey&&!Ee){Ee=!0;var z,H=[],U=[],J=new Map,$=Object(k.a)(bn.getElementsIncludingDeleted());try{for($.s();!(z=$.n()).done;){var Q=z.value;if(l.state.selectedElementIds[Q.id]||Q.id===K.id&&q){var ne=Ue(l.state.editingGroupId,J,Q),ae=X(A-V[0],L-V[1],l.state.gridSize),re=Object(m.a)(ae,2),oe=re[0],ie=re[1];ke(ne,{x:ne.x+(oe-M),y:ne.y+(ie-D)}),H.push(ne),U.push(Q)}else H.push(Q)}}catch(he){$.e(he)}finally{$.f()}bn.replaceAllElements([].concat(H,U))}return}}var le=l.state.draggingElement;if(le){if(w(le)){G=!0;var ce,se,ue=le.points;if("draw"===le.type?(ce=i-le.x,se=c-le.y):(ce=f-le.x,se=g-le.y),Rt(e)&&2===ue.length){var de=Ce(l.state.elementType,ce,se);ce=de.width,se=de.height}1===ue.length?ke(le,{points:[].concat(Object(y.a)(ue),[[ce,se]])}):ue.length>1&&("draw"===le.type?ke(le,{points:Object(Je.b)([].concat(Object(y.a)(ue),[[ce,se]]),.7)}):ke(le,{points:[].concat(Object(y.a)(ue.slice(0,-1)),[[ce,se]])}))}else"selection"===le.type?ft(le,l.state.elementType,A,L,i,c,Mn(A,i),Mn(L,c),Nt(e),Pt(e)):ft(le,l.state.elementType,P,N,f,g,Mn(P,f),Mn(N,g),Nt(e),Pt(e));if("selection"===l.state.elementType){var me=bn.getElements();!e.shiftKey&&cn(me,l.state)&&l.setState({selectedElementIds:{},selectedGroupIds:{},editingGroupId:null});var pe=function(e,t){var n=Z(t),a=Object(m.a)(n,4),r=a[0],o=a[1],i=a[2],l=a[3];return e.filter((function(e){var t=ee(e),n=Object(m.a)(t,4),a=n[0],c=n[1],s=n[2],u=n[3];return"selection"!==e.type&&r<=a&&o<=c&&i>=s&&l>=u}))}(me,le);l.setState((function(e){return Le(Object(p.a)({},e,{selectedElementIds:Object(p.a)({},e.selectedElementIds,{},pe.reduce((function(e,t){return e[t.id]=!0,e}),{}))}),bn.getElements())}))}}}}})),xe=ai((function(e){var t=l.state,n=t.draggingElement,a=t.resizingElement,o=t.multiElement,i=t.elementType,c=t.elementLocked;if(l.setState({isResizing:!1,isRotating:!1,resizingElement:null,selectionElement:null,cursorButton:"up",editingElement:o||E(l.state.editingElement)?l.state.editingElement:null}),l.savePointer(e.clientX,e.clientY,"up"),l.state.editingLinearElement){var s=ea.handlePointerUp(l.state.editingLinearElement);s!==l.state.editingLinearElement&&l.setState({editingLinearElement:s})}if(fi=null,window.removeEventListener(r.POINTER_MOVE,we),window.removeEventListener(r.POINTER_UP,xe),"draw"!==(null===n||void 0===n?void 0:n.type))if(w(n))if(n.points.length>1&&ri.resumeRecording(),G||!n||o)G&&!o&&(c?l.setState((function(e){return{draggingElement:null,selectedElementIds:Object(p.a)({},e.selectedElementIds,Object(je.a)({},l.state.draggingElement.id,!0))}})):(An(),l.setState((function(e){return{draggingElement:null,elementType:"selection",selectedElementIds:Object(p.a)({},e.selectedElementIds,Object(je.a)({},l.state.draggingElement.id,!0))}}))));else{var u=Pn(e,l.state,l.canvas,window.devicePixelRatio),d=u.x,m=u.y;ke(n,{points:[].concat(Object(y.a)(n.points),[[d-n.x,m-n.y]])}),l.setState({multiElement:n,editingElement:l.state.draggingElement})}else{if("selection"!==i&&n&&Se(n))return bn.replaceAllElements(bn.getElementsIncludingDeleted().slice(0,-1)),void l.setState({draggingElement:null});n&&ke(n,Oe(n)),a&&ri.resumeRecording(),a&&Se(a)&&bn.replaceAllElements(bn.getElementsIncludingDeleted().filter((function(e){return e.id!==a.id}))),0!==Ae(l.state).length||!K||G||q||(e.shiftKey?l.setState((function(e){return{selectedElementIds:Object(p.a)({},e.selectedElementIds,Object(je.a)({},K.id,!1))}})):l.setState((function(e){return{selectedElementIds:Object(je.a)({},K.id,!0)}}))),null!==n?(c||l.setState((function(e){return{selectedElementIds:Object(p.a)({},e.selectedElementIds,Object(je.a)({},n.id,!0))}})),("selection"!==i||cn(bn.getElements(),l.state))&&ri.resumeRecording(),c?l.setState({draggingElement:null}):(An(),l.setState({draggingElement:null,elementType:"selection"}))):l.setState({selectedElementIds:{},selectedGroupIds:{},editingGroupId:null})}else l.actionManager.executeAction(so)}));fi=xe,window.addEventListener(r.POINTER_MOVE,we),window.addEventListener(r.POINTER_UP,xe)}}},l.handleCanvasRef=function(e){var t,n,a;null!==e?(l.canvas=e,l.rc=V.a.canvas(l.canvas),l.canvas.addEventListener(r.WHEEL,l.handleWheel,{passive:!1}),l.canvas.addEventListener(r.TOUCH_START,l.onTapStart),l.canvas.addEventListener(r.TOUCH_END,l.onTapEnd)):(null===(t=l.canvas)||void 0===t||t.removeEventListener(r.WHEEL,l.handleWheel),null===(n=l.canvas)||void 0===n||n.removeEventListener(r.TOUCH_START,l.onTapStart),null===(a=l.canvas)||void 0===a||a.removeEventListener(r.TOUCH_END,l.onTapEnd))},l.handleCanvasOnDrop=function(e){var t,n=null===(t=e.dataTransfer)||void 0===t?void 0:t.files[0];"application/json"===(null===n||void 0===n?void 0:n.type)||(null===n||void 0===n?void 0:n.name.endsWith(".excalidraw"))?(l.setState({isLoading:!0}),Aa(n).then((function(e){var t=e.elements,n=e.appState;return l.syncActionResult({elements:t,appState:Object(p.a)({},n||l.state,{isLoading:!1}),commitToHistory:!1})})).catch((function(e){l.setState({isLoading:!1,errorMessage:e.message})}))):l.setState({isLoading:!1,errorMessage:an("alerts.couldNotLoadInvalidFile")})},l.handleCanvasContextMenu=function(e){e.preventDefault(),l.openContextMenu(e)},l.openContextMenu=function(e){var t=e.clientX,n=e.clientY,a=Pn({clientX:t,clientY:n},l.state,l.canvas,window.devicePixelRatio),r=a.x,o=a.y,i=bn.getElements(),c=fn(i,l.state,r,o,l.state.zoom);c?(l.state.selectedElementIds[c.id]||l.setState({selectedElementIds:Object(je.a)({},c.id,!0)}),lr({options:[navigator.clipboard&&{label:an("labels.copy"),action:l.copyAll},navigator.clipboard&&{label:an("labels.paste"),action:function(){return l.pasteFromClipboard(null)}},Ea&&{label:an("labels.copyAsPng"),action:l.copyToClipboardAsPng},ya&&{label:an("labels.copyAsSvg"),action:l.copyToClipboardAsSvg}].concat(Object(y.a)(l.actionManager.getContextMenuItems((function(e){return!R.includes(e.name)})))),top:n,left:t})):lr({options:[navigator.clipboard&&{label:an("labels.paste"),action:function(){return l.pasteFromClipboard(null)}},Ea&&i.length>0&&{label:an("labels.copyAsPng"),action:l.copyToClipboardAsPng},ya&&i.length>0&&{label:an("labels.copyAsSvg"),action:l.copyToClipboardAsSvg}].concat(Object(y.a)(l.actionManager.getContextMenuItems((function(e){return R.includes(e.name)}))),[{label:an("labels.toggleGridMode"),action:l.toggleGridMode}]),top:n,left:t})},l.handleWheel=ai((function(e){e.preventDefault();var t=e.deltaX,n=e.deltaY,a=l.state,r=a.selectedElementIds,o=a.previousSelectedElementIds;if(e.metaKey||e.ctrlKey){var i=Math.sign(n),c=Math.abs(n);return c>10&&(c=10),c*=i,0!==Object.keys(o).length&&setTimeout((function(){l.setState({selectedElementIds:o,previousSelectedElementIds:{}})}),1e3),void l.setState((function(e){var t=e.zoom;return{zoom:vn(t-c/100),selectedElementIds:{},previousSelectedElementIds:0!==Object.keys(r).length?r:o}}))}e.shiftKey?l.setState((function(e){var a=e.zoom,r=e.scrollX;return{scrollX:un(r-(n||t)/a)}})):l.setState((function(e){var a=e.zoom,r=e.scrollX,o=e.scrollY;return{scrollX:un(r-t/a),scrollY:un(o-n/a)}}))})),l.savePointer=function(e,t,n){if(e&&t){var a=Pn({clientX:e,clientY:t},l.state,l.canvas,window.devicePixelRatio);isNaN(a.x)||isNaN(a.y)||l.portal.socket&&gi.pointers.size<2&&l.broadcastMouseLocation({pointerCoords:a,button:n})}},l.resetShouldCacheIgnoreZoomDebounced=In((function(){l.setState({shouldCacheIgnoreZoom:!1})}),300),l.saveDebounced=In((function(){Pa(bn.getElementsIncludingDeleted(),l.state)}),300),l.actionManager=new cr(l.syncActionResult,(function(){return l.state}),(function(){return bn.getElementsIncludingDeleted()})),l.actionManager.registerAll(Br),l.actionManager.registerAction((c=ri,{name:"undo",perform:function(e,t){return yo(e,t,(function(){return c.undoOnce()}))},keyTest:Eo(!1),PanelComponent:function(e){var t=e.updateData;return i.a.createElement(sr,{type:"button",icon:Sr,"aria-label":an("buttons.undo"),onClick:t})},commitToHistory:function(){return!1}})),l.actionManager.registerAction(function(e){return{name:"redo",perform:function(t,n){return yo(t,n,(function(){return e.redoOnce()}))},keyTest:Eo(!0),PanelComponent:function(e){var t=e.updateData;return i.a.createElement(sr,{type:"button",icon:Cr,"aria-label":an("buttons.redo"),onClick:t})},commitToHistory:function(){return!1}}}(ri)),l}return Object(f.a)(o,[{key:"render",value:function(){var e=this,t=this.state.zenModeEnabled,n=window.innerWidth,a=window.innerHeight,r=window.devicePixelRatio,o=n*r,l=a*r;return i.a.createElement("div",{className:"excalidraw"},i.a.createElement(ei,{canvas:this.canvas,appState:this.state,setAppState:this.setAppState,actionManager:this.actionManager,elements:bn.getElements(),onRoomCreate:this.openPortal,onRoomDestroy:this.closePortal,onUsernameChange:function(t){!function(e){try{localStorage.setItem("excalidraw-collab",JSON.stringify({username:e}))}catch(t){console.error(t)}}(t),e.setState({username:t})},onLockToggle:this.toggleLock,zenModeEnabled:t,toggleZenMode:this.toggleZenMode,lng:tn().lng}),i.a.createElement("main",null,i.a.createElement("canvas",{id:"canvas",style:{width:n,height:a},width:o,height:l,ref:this.handleCanvasRef,onContextMenu:this.handleCanvasContextMenu,onPointerDown:this.handleCanvasPointerDown,onDoubleClick:this.handleCanvasDoubleClick,onPointerMove:this.handleCanvasPointerMove,onPointerUp:this.removePointer,onPointerCancel:this.removePointer,onTouchMove:this.handleTouchMove,onDrop:this.handleCanvasOnDrop},an("labels.drawingCanvas"))))}},{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"production"!==A&&"production"!==L||(this.setState.bind(this),Object.defineProperties(window.h,{state:{configurable:!0,get:function(){return t.state}},setState:{configurable:!0,value:function(){return t.setState.apply(t,arguments)}},app:{configurable:!0,value:this}})),this.removeSceneCallback=bn.addCallback(this.onSceneUpdated),this.addEventListeners(),this.initializeScene();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.unmounted=!0,this.removeSceneCallback(),this.removeEventListeners(),clearTimeout(pi)}},{key:"removeEventListeners",value:function(){document.removeEventListener(r.COPY,this.onCopy),document.removeEventListener(r.PASTE,this.pasteFromClipboard),document.removeEventListener(r.CUT,this.onCut),document.removeEventListener(r.KEYDOWN,this.onKeyDown,!1),document.removeEventListener(r.MOUSE_MOVE,this.updateCurrentCursorPosition,!1),document.removeEventListener(r.KEYUP,this.onKeyUp),window.removeEventListener(r.RESIZE,this.onResize,!1),window.removeEventListener(r.UNLOAD,this.onUnload,!1),window.removeEventListener(r.BLUR,this.onBlur,!1),window.removeEventListener(r.DRAG_OVER,this.disableEvent,!1),window.removeEventListener(r.DROP,this.disableEvent,!1),document.removeEventListener(r.GESTURE_START,this.onGestureStart,!1),document.removeEventListener(r.GESTURE_CHANGE,this.onGestureChange,!1),document.removeEventListener(r.GESTURE_END,this.onGestureEnd,!1),window.removeEventListener(r.BEFORE_UNLOAD,this.beforeUnload)}},{key:"addEventListeners",value:function(){var e,t;document.addEventListener(r.COPY,this.onCopy),document.addEventListener(r.PASTE,this.pasteFromClipboard),document.addEventListener(r.CUT,this.onCut),document.addEventListener(r.KEYDOWN,this.onKeyDown,!1),document.addEventListener(r.KEYUP,this.onKeyUp,{passive:!0}),document.addEventListener(r.MOUSE_MOVE,this.updateCurrentCursorPosition),window.addEventListener(r.RESIZE,this.onResize,!1),window.addEventListener(r.UNLOAD,this.onUnload,!1),window.addEventListener(r.BLUR,this.onBlur,!1),window.addEventListener(r.DRAG_OVER,this.disableEvent,!1),window.addEventListener(r.DROP,this.disableEvent,!1),null===(e=document.fonts)||void 0===e||null===(t=e.addEventListener)||void 0===t||t.call(e,"loadingdone",this.onFontLoaded),document.addEventListener(r.GESTURE_START,this.onGestureStart,!1),document.addEventListener(r.GESTURE_CHANGE,this.onGestureChange,!1),document.addEventListener(r.GESTURE_END,this.onGestureEnd,!1),window.addEventListener(r.BEFORE_UNLOAD,this.beforeUnload)}},{key:"componentDidUpdate",value:function(){var e,t=this;this.state.isCollaborating&&!this.portal.socket&&this.initializeSocketClient({showLoadingState:!0}),this.state.editingLinearElement&&!this.state.selectedElementIds[this.state.editingLinearElement.elementId]&&setTimeout((function(){t.actionManager.executeAction(so)}));var n={},r={},o={},i={};this.state.collaborators.forEach((function(e,a){if(e.selectedElementIds)for(var l=0,c=Object.keys(e.selectedElementIds);l<c.length;l++){var s=c[l];s in o||(o[s]=[]),o[s].push(a)}e.pointer&&(e.username&&(i[a]=e.username),r[a]=Nn({sceneX:e.pointer.x,sceneY:e.pointer.y},t.state,t.canvas,window.devicePixelRatio),n[a]=e.button)}));var l=bn.getElements(),c=oa(l.filter((function(e){return!t.state.editingElement||"text"!==t.state.editingElement.type||e.id!==t.state.editingElement.id})),this.state,this.state.selectionElement,window.devicePixelRatio,this.rc,this.canvas,{scrollX:this.state.scrollX,scrollY:this.state.scrollY,viewBackgroundColor:this.state.viewBackgroundColor,zoom:this.state.zoom,remotePointerViewportCoords:r,remotePointerButton:n,remoteSelectedElementIds:o,remotePointerUsernames:i,shouldCacheIgnoreZoom:this.state.shouldCacheIgnoreZoom},{renderOptimizations:!0}),s=c.atLeastOneVisibleElement,u=c.scrollBars;u&&(mi=u);var d="text"!==(null===(e=this.state.editingElement)||void 0===e?void 0:e.type)&&(!s&&l.length>0);this.state.scrolledOutside!==d&&this.setState({scrolledOutside:d}),this.saveDebounced(),Wt(bn.getElementsIncludingDeleted())>this.lastBroadcastedOrReceivedSceneVersion&&(this.broadcastScene(a.UPDATE,!1),this.queueBroadcastAllElements()),ri.record(this.state,bn.getElementsIncludingDeleted())}},{key:"addTextFromPaste",value:function(e){var t=Pn({clientX:li,clientY:ci},this.state,this.canvas,window.devicePixelRatio),n=t.x,a=t.y,r=He({x:n,y:a,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:e,fontSize:this.state.currentItemFontSize,fontFamily:this.state.currentItemFontFamily,textAlign:this.state.currentItemTextAlign,verticalAlign:"top"});bn.replaceAllElements([].concat(Object(y.a)(bn.getElementsIncludingDeleted()),[r])),this.setState({selectedElementIds:Object(je.a)({},r.id,!0)}),ri.resumeRecording()}},{key:"setCollaborators",value:function(e){this.setState((function(t){var n,a=new Map,r=Object(k.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;t.collaborators.has(o)?a.set(o,t.collaborators.get(o)):a.set(o,{})}}catch(i){r.e(i)}finally{r.f()}return Object(p.a)({},t,{collaborators:a})}))}},{key:"restoreUserName",value:function(){var e=function(){try{var e=localStorage.getItem("excalidraw-collab");if(e)return JSON.parse(e).username}catch(t){console.error(t)}return null}();null!==e&&this.setState({username:e})}},{key:"selectShapeTool",value:function(e){var t;si||Ln(e),(t=document.activeElement)instanceof HTMLElement&&t.className.includes("ToolIcon")&&document.activeElement.blur(),"selection"!==e?this.setState({elementType:e,selectedElementIds:{},selectedGroupIds:{},editingGroupId:null}):this.setState({elementType:e})}},{key:"handleTextWysiwyg",value:function(e,t){var n=this,a=t.isExistingElement,r=void 0!==a&&a,o=function(){n.setState({draggingElement:null,editingElement:null})},i=function(t){bn.replaceAllElements(Object(y.a)(bn.getElementsIncludingDeleted().map((function(n){return n.id===e.id&&E(n)?_e(n,{text:t,isDeleted:!t.trim()}):n}))))};!function(e){var t=e.id,n=e.zoom,a=e.onChange,r=e.onSubmit,o=e.onCancel,i=e.getViewportCoords;function l(){var e=bn.getElement(t);if(E(e)){var a=i(e.x,e.y),r=Object(m.a)(a,2),o=r[0],l=r[1],s=e.textAlign,u=e.angle;c.value=e.text;var d=e.text.replace(/\r\n?/g,"\n").split("\n"),p=e.height/d.length;Object.assign(c.style,{font:Cn(e),lineHeight:"".concat(p,"px"),width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),left:"".concat(o,"px"),top:"".concat(l,"px"),transform:Ht(e.width,e.height,u,n),textAlign:s,color:e.strokeColor,opacity:e.opacity/100})}}var c=document.createElement("textarea");c.dir="auto",c.tabIndex=0,c.dataset.type="wysiwyg",c.wrap="off",Object.assign(c.style,{position:"fixed",display:"inline-block",minHeight:"1em",backfaceVisibility:"hidden",margin:0,padding:0,border:0,outline:0,resize:"none",background:"transparent",overflow:"hidden",whiteSpace:"pre"}),l(),a&&(c.oninput=function(){a(Bt(c.value))}),c.onkeydown=function(e){if(e.key===kt)e.preventDefault(),u();else if(e.key===wt&&e[Ct]){if(e.preventDefault(),e.isComposing||229===e.keyCode)return;u()}else e.key!==wt||e.altKey||e.stopPropagation()};var s=function(e){e.stopPropagation()},u=function(){c.value?r(Bt(c.value)):o(),d()},d=function(){g||(g=!0,c.onblur=null,c.oninput=null,c.onkeydown=null,window.removeEventListener("resize",l),window.removeEventListener("wheel",s,!0),window.removeEventListener("pointerdown",h),window.removeEventListener("pointerup",p),window.removeEventListener("blur",u),f(),document.body.removeChild(c))},p=function e(){window.removeEventListener("pointerup",e),setTimeout((function(){c.onblur=u,c.focus()}))},h=function(e){e.target instanceof HTMLElement&&e.target.closest(".".concat(P))&&!xn(e.target)&&(c.onblur=null,window.addEventListener("pointerup",p),window.addEventListener("blur",u))},f=bn.addCallback((function(){l(),c.focus()})),g=!1;c.onblur=u,window.addEventListener("resize",l),window.addEventListener("pointerdown",h),window.addEventListener("wheel",s,!0),document.body.appendChild(c),c.focus(),c.select()}({id:e.id,zoom:this.state.zoom,getViewportCoords:function(e,t){var a=Nn({sceneX:e,sceneY:t},n.state,n.canvas,window.devicePixelRatio);return[a.x,a.y]},onChange:ai((function(e){i(e)})),onSubmit:ai((function(t){i(t),n.setState((function(t){return{selectedElementIds:Object(p.a)({},t.selectedElementIds,Object(je.a)({},e.id,!0))}})),n.state.elementLocked&&Ln(n.state.elementType),ri.resumeRecording(),o()})),onCancel:ai((function(){i(""),r&&ri.resumeRecording(),o()}))}),this.setState({selectedElementIds:{},selectedGroupIds:{},editingGroupId:null}),i(e.text)}},{key:"getTextElementAtPosition",value:function(e,t){var n=fn(bn.getElements(),this.state,e,t,this.state.zoom);return n&&E(n)&&!n.isDeleted?n:null}},{key:"getTextWysiwygSnappedToCenterPosition",value:function(e,t,n,a,r){var o=function(e,t,n){for(var a=null,r=e.length-1;r>=0;--r)if(!e[r].isDeleted){var o=Z(e[r]),i=Object(m.a)(o,4),l=i[0],c=i[1],s=i[2],u=i[3];if(l<t&&t<s&&c<n&&n<u){a=e[r];break}}return a}(bn.getElementsIncludingDeleted().filter((function(e){return!E(e)})),e,t);if(o){var i=o.x+o.width/2,l=o.y+o.height/2;if(Math.hypot(e-i,t-l)<30){var c=Nn({sceneX:i,sceneY:l},n,a,r);return{viewportX:c.x,viewportY:c.y,elementCenterX:i,elementCenterY:l}}}}}],[{key:"resetTapTwice",value:function(){oi=!1}}]),o}(i.a.Component);"production"!==A&&"production"!==L||(window.h={},Object.defineProperties(window.h,{elements:{get:function(){return bn.getElementsIncludingDeleted()},set:function(e){return bn.replaceAllElements(e)}},history:{get:function(){return ri}}}));var bi=vi,yi=n(37),Ei=n.n(yi),wi=(n(95),function(e){var t=e.snapshot,n=Object(o.useRef)(null);return Object(o.useEffect)((function(){if(n.current){var e=n.current.getContext("2d");e&&e.putImageData(t.imageData,0,0)}}),[t]),i.a.createElement("canvas",{ref:n,width:t.width,height:t.height})}),ki=function(){var e=Object(o.useState)([]),t=Object(m.a)(e,2),n=t[0],a=t[1];return i.a.createElement(wo,{className:"Claymate"},i.a.createElement("div",{className:"Claymate-buttons"},i.a.createElement("button",{type:"button",onClick:function(){var e=function(e){var t=bn.getElements(),n=la(t,{},{exportBackground:!0,exportPadding:10,viewBackgroundColor:"#fff",scale:window.devicePixelRatio,shouldAddWatermark:!1}),a=e?e.width:n.width,r=e?e.height:n.height,o=n.getContext("2d");return{id:be()(),width:a,height:r,imageData:o.getImageData(0,0,a,r)}}(n[0]&&{width:n[0].width,height:n[0].height});a((function(t){return[].concat(Object(y.a)(t),[e])}))}},"Add snapshot"),i.a.createElement("button",{type:"button",onClick:function(){var e=new Ei.a;n.forEach((function(t){e.addFrame(t.imageData)})),e.on("finished",function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ua.b)(t,{fileName:"excalidraw-claymate.gif"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.render()},disabled:0===n.length},"Export GIF")),i.a.createElement("div",{className:"Claymate-snapshots"},n.map((function(e,t){return i.a.createElement("div",{key:e.id,className:"Claymate-snapshot"},i.a.createElement(wi,{snapshot:e}),i.a.createElement("button",{type:"button",className:"Claymate-delete","aria-label":"Delete",onClick:function(){return t=e.id,void a((function(e){return e.filter((function(e){return e.id!==t}))}));var t}},"\u2716"),i.a.createElement("button",{type:"button",className:"Claymate-left","aria-label":"Move Left",disabled:0===t,onClick:function(){return t=e.id,void a((function(e){var n=e.findIndex((function(e){return e.id===t})),a=Object(y.a)(e);return a[n-1]=e[n],a[n]=e[n-1],a}));var t}},"\u2b05"),i.a.createElement("button",{type:"button",className:"Claymate-right","aria-label":"Move Right",disabled:t===n.length-1,onClick:function(){return t=e.id,void a((function(e){var n=e.findIndex((function(e){return e.id===t})),a=Object(y.a)(e);return a[n+1]=e[n],a[n]=e[n+1],a}));var t}},"\u27a1"))}))))},xi=function(){return i.a.createElement("div",{className:"ClaymateApp"},i.a.createElement(_n,null,i.a.createElement(Yn,null,i.a.createElement(Un,null,i.a.createElement(bi,null),i.a.createElement(ki,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(xi,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[68,28,31]]]);
//# sourceMappingURL=main.f2af84fa.chunk.js.map